***

# **Part ä¸€ã€OpenAI Agents SDK ç®€ä»‹**

OpenAI Agents SDKåœ°å€ï¼šhttps://github.com/openai/openai-agents-python

![](images/9599f6fe-3961-4dcd-a987-8cc062752f68.png)

OpenAI Agents SDK æ˜¯ä¸€ä¸ªè½»é‡çº§ä½†åŠŸèƒ½å¼ºå¤§çš„æ¡†æ¶ï¼Œç”¨äºæ„å»ºå¤šæ™ºèƒ½ä½“ï¼ˆmulti-agentï¼‰å·¥ä½œæµã€‚

***

## **æ ¸å¿ƒæ¦‚å¿µ**

* **Agentsï¼ˆä»£ç†ï¼‰**ï¼šé…ç½®äº†**æŒ‡ä»¤**ã€**å·¥å…·**ã€\*\*é˜²æŠ¤æªæ–½ï¼ˆguardrailsï¼‰**å’Œ**äº¤æ¥ï¼ˆhandoffsï¼‰\*\*çš„ LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰ã€‚

* **Handoffsï¼ˆäº¤æ¥ï¼‰**ï¼šå…è®¸ä»£ç†åœ¨ç‰¹å®šä»»åŠ¡ä¸­**å°†æ§åˆ¶æƒè½¬äº¤ç»™å…¶ä»–ä»£ç†**ã€‚

* **Guardrailsï¼ˆé˜²æŠ¤æªæ–½ï¼‰**ï¼šç”¨äº**è¾“å…¥å’Œè¾“å‡ºéªŒè¯**çš„å¯é…ç½®å®‰å…¨æ£€æŸ¥æœºåˆ¶ã€‚

* **Tracingï¼ˆè¿½è¸ªï¼‰**ï¼šå†…ç½®**ä»£ç†æ‰§è¡Œçš„è¿½è¸ªåŠŸèƒ½**ï¼Œå¯ä»¥ç”¨æ¥æŸ¥çœ‹ã€è°ƒè¯•å’Œä¼˜åŒ–ä½ çš„å·¥ä½œæµã€‚

ğŸ“Œ **è¦äº†è§£ SDK çš„å®é™…ä½¿ç”¨æ–¹å¼ï¼Œå¯æŸ¥çœ‹ `examples` ç›®å½•ä¸­çš„ç¤ºä¾‹ä»£ç ã€‚**

***

## **å¿«é€Ÿå¼€å§‹**

### **1. è®¾ç½® Python ç¯å¢ƒ**

```bash
python -m venv env
source env/bin/activate  # åœ¨ Linux/macOS ä¸Šæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# å¦‚æœæ˜¯ Windowsï¼Œåˆ™è¿è¡Œï¼š
# env\Scripts\activate
```

### **2. å®‰è£… Agents SDK**

```bash
pip install openai-agents
```

***

## **Hello World ç¤ºä¾‹**

```python
from agents import Agent, Runner

agent = Agent(name="Assistant", instructions="You are a helpful assistant")

result = Runner.run_sync(agent, "Write a haiku about recursion in programming.")
print(result.final_output)
```

**è¾“å‡ºç¤ºä¾‹ï¼š**

```plaintext
# Code within the code,
# Functions calling themselves,
# Infinite loop's dance.
```

âš  **æ³¨æ„**ï¼šè¿è¡Œæ­¤ä»£ç å‰ï¼Œè¯·ç¡®ä¿å·²è®¾ç½® `OPENAI_API_KEY` ç¯å¢ƒå˜é‡ã€‚

***

## **Handoffsï¼ˆäº¤æ¥ï¼‰ç¤ºä¾‹**

```python
from agents import Agent, Runner
import asyncio

# å®šä¹‰ä¸¤ä¸ªè¯­è¨€ä»£ç†
spanish_agent = Agent(name="Spanish agent", instructions="You only speak Spanish.")
english_agent = Agent(name="English agent", instructions="You only speak English")

# å®šä¹‰ä¸€ä¸ªä»»åŠ¡åˆ†é…ä»£ç†
triage_agent = Agent(
    name="Triage agent",
    instructions="Handoff to the appropriate agent based on the language of the request.",
    handoffs=[spanish_agent, english_agent],
)

async def main():
    result = await Runner.run(triage_agent, input="Hola, Â¿cÃ³mo estÃ¡s?")
    print(result.final_output)

if __name__ == "__main__":
    asyncio.run(main())
```

**è¾“å‡ºç¤ºä¾‹ï¼š**

```plaintext
Â¡Hola! Estoy bien, gracias por preguntar. Â¿Y tÃº, cÃ³mo estÃ¡s?
```

ğŸ“Œ è¿™é‡Œï¼Œ`triage_agent` å……å½“**ä»»åŠ¡åˆ†é…ä»£ç†**ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„è¯­è¨€ï¼Œå°†ä»»åŠ¡**è½¬äº¤**ç»™ç›¸åº”çš„ä»£ç†ï¼ˆè¥¿ç­ç‰™è¯­æˆ–è‹±è¯­ï¼‰ã€‚

***

## **Functionsï¼ˆå·¥å…·å‡½æ•°ï¼‰ç¤ºä¾‹**

```python
import asyncio
from agents import Agent, Runner, function_tool

# å®šä¹‰ä¸€ä¸ªå¤©æ°”æŸ¥è¯¢å·¥å…·
@function_tool
def get_weather(city: str) -> str:
    return f"The weather in {city} is sunny."

# åˆ›å»ºä¸€ä¸ªä»£ç†ï¼Œå¹¶æ·»åŠ  `get_weather` å·¥å…·
agent = Agent(
    name="Hello world",
    instructions="You are a helpful agent.",
    tools=[get_weather],
)

async def main():
    result = await Runner.run(agent, input="What's the weather in Tokyo?")
    print(result.final_output)

if __name__ == "__main__":
    asyncio.run(main())
```

**è¾“å‡ºç¤ºä¾‹ï¼š**

```plaintext
The weather in Tokyo is sunny.
```

ğŸ“Œ ä»£ç†å¯ä»¥ä½¿ç”¨ `function_tool` æ–¹å¼æ³¨å†Œ**å¤–éƒ¨å·¥å…·**ï¼Œå¦‚æŸ¥è¯¢å¤©æ°”ã€æ•°æ®åº“æ“ä½œç­‰ã€‚

***

## **ä»£ç†å¾ªç¯æœºåˆ¶**

è°ƒç”¨ `Runner.run()` åï¼ŒSDK ä¼šæ‰§è¡Œä¸€ä¸ª**å¾ªç¯**ï¼Œç›´åˆ°è·å¾—æœ€ç»ˆè¾“å‡ºï¼š

1. **è°ƒç”¨ LLM**ï¼Œä½¿ç”¨ä»£ç†çš„**æ¨¡å‹ã€è®¾å®šå’Œæ¶ˆæ¯å†å²**ã€‚

2. **LLM è¿”å›å“åº”**ï¼Œå¯èƒ½åŒ…å«**å·¥å…·è°ƒç”¨**ã€‚

3. **å¦‚æœ LLM ç›´æ¥è¿”å›æœ€ç»ˆè¾“å‡º**ï¼ˆæ— å·¥å…·è°ƒç”¨/äº¤æ¥ï¼‰ï¼Œåˆ™è¿”å›ç»“æœå¹¶ç»“æŸå¾ªç¯ã€‚

4. **å¦‚æœ LLM äº¤æ¥ç»™å¦ä¸€ä¸ªä»£ç†**ï¼Œåˆ™å°†å½“å‰ä»£ç†åˆ‡æ¢ä¸ºæ–°çš„ä»£ç†ï¼Œå¹¶å›åˆ°æ­¥éª¤ 1ã€‚

5. **å¦‚æœ LLM è°ƒç”¨äº†å·¥å…·**ï¼Œåˆ™æ‰§è¡Œå·¥å…·è°ƒç”¨ï¼Œå°†ç»“æœæ·»åŠ åˆ°æ¶ˆæ¯å†å²ï¼Œç„¶åå›åˆ°æ­¥éª¤ 1ã€‚

6. **å¯ä»¥ä½¿ç”¨ `max_turns` å‚æ•°** é™åˆ¶å¾ªç¯çš„æœ€å¤§æ‰§è¡Œæ¬¡æ•°ã€‚

***

## **Final Outputï¼ˆæœ€ç»ˆè¾“å‡ºï¼‰**

æœ€ç»ˆè¾“å‡ºæ˜¯**ä»£ç†å¾ªç¯ä¸­çš„æœ€åä¸€ä¸ªç»“æœ**ï¼š

* å¦‚æœä»£ç†**è®¾ç½®äº† `output_type`**ï¼Œåˆ™å¾ªç¯ä¼š**è¿è¡Œåˆ° LLM ç”Ÿæˆç¬¦åˆè¯¥ç±»å‹çš„ç»“æ„åŒ–è¾“å‡º**ã€‚

* å¦‚æœä»£ç†**æ²¡æœ‰ `output_type`**ï¼Œåˆ™å¾ªç¯ä¼š**è¿è¡Œåˆ° LLM ç”Ÿæˆ** **æ²¡æœ‰å·¥å…·è°ƒç”¨/äº¤æ¥çš„æ™®é€šæ–‡æœ¬**ã€‚

**æ€»ç»“ï¼š**

* **å¦‚æœæœ‰ `output_type`** â†’ è¿è¡Œåˆ°ç”Ÿæˆç¬¦åˆç±»å‹çš„è¾“å‡ºã€‚

* **å¦‚æœæ²¡æœ‰ `output_type`** â†’ è¿è¡Œåˆ°ç”Ÿæˆæ™®é€šæ–‡æœ¬ã€‚

***

## **å¸¸è§çš„ä»£ç†æ¨¡å¼**

Agents SDK è®¾è®¡ä¸º**é«˜åº¦çµæ´»**ï¼Œå¯ä»¥ç”¨äºï¼š

* **ç¡®å®šæ€§æµç¨‹ï¼ˆdeterministic flowsï¼‰**

* **è¿­ä»£å¾ªç¯ï¼ˆiterative loopsï¼‰**

* **å¤šæ™ºèƒ½ä½“åä½œ**ï¼ˆmulti-agent collaborationï¼‰

å¯ä»¥æŸ¥çœ‹ `examples/agent_patterns` ç›®å½•ä¸‹çš„ç¤ºä¾‹ä»£ç ã€‚

***

## **Tracingï¼ˆè¿½è¸ªä¸è°ƒè¯•ï¼‰**

* Agents SDK **å†…ç½®è¿½è¸ªåŠŸèƒ½**ï¼Œä¾¿äº**è·Ÿè¸ªå’Œè°ƒè¯•**ä»£ç†çš„è¡Œä¸ºã€‚

* æ”¯æŒæ‰©å±•

* ï¼Œå¯ä»¥å¯¹æ¥å¤–éƒ¨æ—¥å¿—ç³»ç»Ÿï¼Œå¦‚ï¼š

  * **Logfire**

  * **AgentOps**

  * **Braintrust**

ğŸ“Œ å…·ä½“å®ç°å¯å‚è€ƒ `Tracing` æ–‡æ¡£ã€‚

***

## **å¼€å‘ï¼ˆä»…å½“éœ€è¦ä¿®æ”¹ SDK æ—¶ï¼‰**

1. ç¡®ä¿å·²å®‰è£…

2. uvï¼š

```bash
uv --version
```

1. å®‰è£…ä¾èµ–ï¼š

```bash
make sync
```

1. ä»£ç æ£€æŸ¥ & æµ‹è¯•ï¼š

```bash
make tests  # è¿è¡Œæµ‹è¯•
make mypy   # è¿è¡Œç±»å‹æ£€æŸ¥
make lint   # è¿è¡Œä»£ç æ ¼å¼æ£€æŸ¥
```

***

## **è‡´è°¢**

OpenAI ç‰¹åˆ«æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

* **Pydantic**ï¼ˆæ•°æ®éªŒè¯ï¼‰

* **PydanticAI**ï¼ˆé«˜çº§ä»£ç†æ¡†æ¶ï¼‰

* **MkDocs**ï¼ˆæ–‡æ¡£ç”Ÿæˆï¼‰

* **Griffe**ï¼ˆPython ä»£ç è§£æå·¥å…·ï¼‰

* **uv å’Œ ruff**ï¼ˆPython ä¾èµ–ç®¡ç† & ä»£ç æ£€æŸ¥ï¼‰

ğŸ“Œ **OpenAI æ‰¿è¯ºç»§ç»­å¼€æº Agents SDK**ï¼Œè®©ç¤¾åŒºå…±åŒæ‰©å±•å…¶èƒ½åŠ›ã€‚

# Part äºŒã€**Responses API**

* åœ°å€ï¼šhttps://platform.openai.com/docs/guides/text?api-mode=responses

**Responses API** æ˜¯ OpenAI ä¸ºæ™ºèƒ½ä»£ç†ï¼ˆAgentsï¼‰æä¾›çš„**å…¨æ–° API åŸºç¡€æ„ä»¶**ï¼Œå®ƒç»“åˆäº† **Chat Completions API çš„ç®€æ´æ€§** ä¸ **Assistants API çš„å†…ç½®å·¥å…·èƒ½åŠ›**ï¼Œä½¿å¾—ä»£ç†èƒ½å¤Ÿæ›´æ™ºèƒ½åœ°æ‰§è¡Œä»»åŠ¡ã€‚

ğŸ“Œ **æ ¸å¿ƒç‰¹ç‚¹**

* âœ… **ç®€æ´æ˜“ç”¨**ï¼šç»§æ‰¿äº† Chat Completions API çš„æ˜“ç”¨æ€§ã€‚

* âœ… **å¢å¼ºåŠŸèƒ½**ï¼šæ”¯æŒ**å†…ç½®å·¥å…·ï¼ˆToolsï¼‰**ï¼Œå¦‚å‡½æ•°è°ƒç”¨ï¼ˆFunction Callingï¼‰ã€Web æœç´¢ã€æ–‡ä»¶æœç´¢ã€è®¡ç®—æœºæ§åˆ¶ç­‰ã€‚

* âœ… **é€‚ç”¨äºä»£ç†ï¼ˆAgentsï¼‰**ï¼šå¯ç”¨äºæ„å»º**æ™ºèƒ½åŒ–ä»»åŠ¡æ‰§è¡Œç³»ç»Ÿ**ã€‚

ğŸ”— **æœªæ¥å‘å±•**ï¼šResponses API æ—¨åœ¨æˆä¸º OpenAI ä»£ç†ç³»ç»Ÿçš„**æ ¸å¿ƒ API**ï¼Œç»“åˆ Agents SDKï¼Œæä¾›æ›´çµæ´»çš„ä»»åŠ¡ç¼–æ’èƒ½åŠ›ã€‚

![](images/c5cb414c-ee83-448c-ba58-5ce2ad59d634.png)

### **æ–‡æœ¬ç”Ÿæˆä¸æç¤ºè¯å·¥ç¨‹ï¼ˆPromptingï¼‰**

æœ¬èŠ‚ä»‹ç»å¦‚ä½•ä½¿ç”¨ OpenAI API **æç¤ºï¼ˆpromptï¼‰æ¨¡å‹** ä»¥ç”Ÿæˆæ–‡æœ¬ã€‚ä½ å¯ä»¥å°†å…¶ç”¨äº **ä»£ç ç”Ÿæˆã€æ•°å­¦è¡¨è¾¾å¼ã€ç»“æ„åŒ– JSON æ•°æ®ã€äººç±»é£æ ¼çš„æ–‡æœ¬** ç­‰ã€‚

***

## **1. ç”Ÿæˆæ–‡æœ¬**

ä½¿ç”¨ OpenAI APIï¼Œä½ å¯ä»¥é€šè¿‡ä¸€ä¸ª **ç®€å•çš„æç¤ºï¼ˆpromptï¼‰** è®©æ¨¡å‹ç”Ÿæˆæ–‡æœ¬ï¼Œç±»ä¼¼äº ChatGPT çš„å·¥ä½œæ–¹å¼ã€‚

### **ğŸŒŸ ç¤ºä¾‹ï¼šä½¿ç”¨ Responses API ç”Ÿæˆæ–‡æœ¬**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    input="Write a one-sentence bedtime story about a unicorn."
)

print(response.output_text)
```

**ç¤ºä¾‹è¾“å‡ºï¼š**

```plaintext
Under the soft glow of the moon, Luna the unicorn danced through fields of twinkling stardust, leaving trails of dreams for every child asleep.
```

**ğŸ“Œ å…³é”®ç‚¹ï¼š**

* `response.output_text` åŒ…å«**æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬**ã€‚

* `model="gpt-4o"` æŒ‡å®šä½¿ç”¨ `GPT-4o` æ¨¡å‹ã€‚

***

## **2. å“åº”ç»“æ„**

OpenAI çš„ API å“åº”åŒ…å«**ä¸€ä¸ªå†…å®¹æ•°ç»„**ï¼ˆ`output`ï¼‰ï¼Œæ¯ä¸ªå†…å®¹é¡¹å…·æœ‰ä»¥ä¸‹ç»“æ„ï¼š

```json
[
    {
        "id": "msg_67b73f697ba4819183a15cc17d011509",
        "type": "message",
        "role": "assistant",
        "content": [
            {
                "type": "output_text",
                "text": "Under the soft glow of the moon, Luna the unicorn danced through fields of twinkling stardust, leaving trails of dreams for every child asleep.",
                "annotations": []
            }
        ]
    }
]
```

**ğŸ“Œ é‡è¦è¯´æ˜ï¼š**

* `output` **å¯èƒ½åŒ…å«å¤šä¸ªç»“æœ**ï¼Œåœ¨å¤šè½®å¯¹è¯æˆ–æ‰¹é‡ç”Ÿæˆæ—¶å°¤å…¶æ˜æ˜¾ã€‚

* ä¸€äº› SDK æä¾› `output_text` **å±æ€§**ï¼Œå¯ä»¥**ç›´æ¥è·å–æ‰€æœ‰æ–‡æœ¬è¾“å‡º**ï¼Œæ–¹ä¾¿è®¿é—®æ–‡æœ¬æ•°æ®ã€‚

* **é™¤äº†çº¯æ–‡æœ¬ï¼Œæ¨¡å‹è¿˜å¯ä»¥è¿”å› JSON ç»“æ„åŒ–æ•°æ®**ï¼ˆç§°ä¸º **Structured Outputs**ï¼‰ã€‚

***

## **3. æ¶ˆæ¯è§’è‰²ä¸æŒ‡ä»¤æ§åˆ¶**

ä½ å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ–¹å¼**ç»™æ¨¡å‹æä¾›æŒ‡ä»¤**ï¼š

1. **ä½¿ç”¨ `instructions` å‚æ•°** æä¾›å…¨å±€è¡Œä¸ºæŒ‡ä»¤ï¼Œå¦‚è¯­æ°”ã€ç›®æ ‡ç­‰ã€‚ï¼ˆæƒé‡æœ€é«˜ï¼‰

2. **ä½¿ç”¨ `input` æ•°ç»„ï¼ŒæŒ‡å®šä¸åŒè§’è‰²çš„æ¶ˆæ¯**ã€‚

### **ğŸŒŸ ç¤ºä¾‹ 1ï¼šä½¿ç”¨ `instructions` å‚æ•°**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    instructions="Talk like a pirate.",
    input="Are semicolons optional in JavaScript?",
)

print(response.output_text)
```

**ç¤ºä¾‹è¾“å‡ºï¼š**

```plaintext
Arrr, matey! In JavaScript, semicolons be often optional, but beware, for they help avoid nasty parse errors!
```

ğŸ“Œ **åœ¨ `instructions` ä¸­å®šä¹‰â€œè¯´è¯åƒæµ·ç›—â€åï¼Œæ¨¡å‹ä¼šä»¥æµ·ç›—é£æ ¼å›ç­”ã€‚**

***

### **ğŸŒŸ ç¤ºä¾‹ 2ï¼šä½¿ç”¨ `input` æ•°ç»„æŒ‡å®šä¸åŒè§’è‰²**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    input=[
        {
            "role": "developer",
            "content": "Talk like a pirate."
        },
        {
            "role": "user",
            "content": "Are semicolons optional in JavaScript?"
        }
    ]
)

print(response.output_text)
```

ğŸ“Œ è¿™é‡Œï¼Œ`developer` è§’è‰²ç±»ä¼¼äº **ç³»ç»Ÿè®¾å®š**ï¼Œç”¨æˆ·è¾“å…¥ `user` è§’è‰²çš„å†…å®¹ï¼Œæœ€ç»ˆ **æ¨¡å‹æŒ‰ `developer` è®¾å®šé£æ ¼å›ç­”**ã€‚

***

## **4. æ¶ˆæ¯è§’è‰²çš„ä¼˜å…ˆçº§**

OpenAI è§„å®šä¸åŒè§’è‰²çš„ä¼˜å…ˆçº§ï¼š

| **è§’è‰²**      | **ä¼˜å…ˆçº§** | **è¯´æ˜**                       |
| ----------- | ------- | ---------------------------- |
| `developer` | **æœ€é«˜**  | ç”±å¼€å‘è€…æä¾›çš„æŒ‡ä»¤ï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼Œç±»ä¼¼ `system`ã€‚ |
| `user`      | **æ¬¡é«˜**  | ç”±æœ€ç»ˆç”¨æˆ·æä¾›çš„è¾“å…¥ï¼Œæ¬¡äº `developer`ã€‚   |
| `assistant` | **æœ€ä½**  | ç”±æ¨¡å‹ç”Ÿæˆçš„å“åº”ã€‚                    |

**ğŸ“Œ å¤šè½®å¯¹è¯ä¼šåŒ…å«ä¸åŒç±»å‹çš„æ¶ˆæ¯ã€‚ç®¡ç†å¯¹è¯çŠ¶æ€æ˜¯å…³é”®ï¼**

***

## **5. é€‰æ‹©åˆé€‚çš„æ¨¡å‹**

åœ¨ä½¿ç”¨ API ç”Ÿæˆæ–‡æœ¬æ—¶ï¼Œä½ éœ€è¦**é€‰æ‹©åˆé€‚çš„æ¨¡å‹**ï¼ˆ`model` å‚æ•°ï¼‰ã€‚å¯é€‰æ¨¡å‹åŠå…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š

### **ğŸ§  1. æ¨ç†ï¼ˆReasoningï¼‰æ¨¡å‹**

* **ç‰¹ç‚¹**ï¼šå†…éƒ¨ä¼šè¿›è¡Œ**å¤æ‚çš„æ€ç»´é“¾åˆ†æ**ï¼Œé€‚ç”¨äº**é€»è¾‘æ¨ç†ã€åˆ†æ­¥è®¡åˆ’**ç­‰ä»»åŠ¡ã€‚

* ä¼˜ç¼ºç‚¹

* ï¼š

  * âœ… **ç†è§£å¤æ‚ä»»åŠ¡ã€é€»è¾‘æ¸…æ™°**

  * âŒ **é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆæœ¬æ›´é«˜**

* **é€‚ç”¨åœºæ™¯**ï¼šå¤æ‚åˆ†æã€å¤šæ­¥æ¨ç†ã€ç ”ç©¶ç±»ä»»åŠ¡

### **âš¡ 2. GPTï¼ˆé€šç”¨ï¼‰æ¨¡å‹**

* **ç‰¹ç‚¹**ï¼šå¿«é€Ÿã€ç»æµã€é«˜æ•ˆï¼Œä½†**éœ€è¦æ›´æ˜ç¡®çš„æŒ‡ä»¤**æ¥å¼•å¯¼å®ƒå®Œæˆä»»åŠ¡ã€‚

* ä¼˜ç¼ºç‚¹

* ï¼š

  * âœ… **ç”Ÿæˆé€Ÿåº¦å¿«ã€æ€§ä»·æ¯”é«˜**

  * âŒ **å¯èƒ½ä¸æ“…é•¿å¤æ‚çš„æ¨ç†ä»»åŠ¡**

* **é€‚ç”¨åœºæ™¯**ï¼šå¿«é€Ÿæ–‡æœ¬ç”Ÿæˆã€èŠå¤©æœºå™¨äººã€å¸¸è§„ä»»åŠ¡

### **ğŸ” 3. è§„æ¨¡å¤§å°é€‰æ‹©**

| **æ¨¡å‹**                | **ç‰¹ç‚¹**                     |
| --------------------- | -------------------------- |
| **å¤§å‹æ¨¡å‹ï¼ˆGPT-4oï¼‰**      | **ç†è§£èƒ½åŠ›å¼ºï¼Œæ³›åŒ–èƒ½åŠ›å¥½**ï¼Œé€‚ç”¨äºå¤æ‚é—®é¢˜ã€‚   |
| **å°å‹æ¨¡å‹ï¼ˆGPT-4o Miniï¼‰** | **æ›´å¿«ã€æ›´ä¾¿å®œ**ï¼Œé€‚åˆç‰¹å®šä»»åŠ¡ï¼Œå¯é€šè¿‡å¾®è°ƒä¼˜åŒ–ã€‚ |

**ğŸ“Œ ç»“è®º**ï¼š å¦‚æœä¸ç¡®å®šè¯¥é€‰å“ªä¸ªï¼Œ`gpt-4o` **æ˜¯æ™ºèƒ½æ€§ã€é€Ÿåº¦å’Œæˆæœ¬çš„æœ€ä½³å¹³è¡¡ç‚¹**ã€‚

***

## **6. æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰**

æ„é€ **é«˜æ•ˆçš„æç¤ºè¯ï¼ˆpromptï¼‰\*\*æ˜¯\*\*ä¼˜åŒ–æ¨¡å‹è¾“å‡º**çš„å…³é”®ã€‚ç”±äº LLM ç”Ÿæˆå†…å®¹å…·æœ‰**éç¡®å®šæ€§**ï¼Œä½ éœ€è¦**è‰ºæœ¯+ç§‘å­¦ç»“åˆ**æ¥è°ƒæ•´æç¤ºè¯ã€‚

### **æç¤ºè¯ä¼˜åŒ–çš„åŸºæœ¬åŸåˆ™**

1. **æä¾›è¯¦ç»†è¯´æ˜**ï¼Œå‡å°‘æ­§ä¹‰ï¼Œç¡®ä¿æ¨¡å‹ç†è§£ä½ çš„éœ€æ±‚ã€‚

2. **ç¤ºä¾‹é©±åŠ¨ï¼ˆFew-shot Learningï¼‰**ï¼Œæä¾›è¾“å…¥-è¾“å‡ºç¤ºä¾‹ï¼Œæé«˜æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚

3. **ç›®æ ‡å¯¼å‘æè¿°**ï¼Œå°¤å…¶æ˜¯æ¨ç†æ¨¡å‹ï¼Œä¸è¦å†™æ­»æ­¥éª¤ï¼Œè€Œè¦æè¿°**ç›®æ ‡**å’Œ**æœŸæœ›ç»“æœ**ã€‚

4. **æµ‹è¯•ä¸è¯„ä¼°ï¼ˆEvalsï¼‰**ï¼Œä½¿ç”¨ç”Ÿäº§ç¯å¢ƒæ•°æ®æ¥æµ‹è¯•æç¤ºè¯æ•ˆæœã€‚

5. **ä¸æ–­è¿­ä»£**ï¼Œè°ƒæ•´æç¤ºè¯ï¼Œä¼˜åŒ–æ¨¡å‹è¾“å‡ºã€‚

***

## **7. å¾®è°ƒ vs æç¤ºè¯ä¼˜åŒ–**

å¦‚æœé€šè¿‡**æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰** **ä»ç„¶æ— æ³•è·å¾—æ»¡æ„çš„ç»“æœ**ï¼Œä½ å¯ä»¥è€ƒè™‘ï¼š

* **å¾®è°ƒï¼ˆFine-tuningï¼‰**ï¼šé’ˆå¯¹ç‰¹å®šä»»åŠ¡**è°ƒæ•´æƒé‡**ï¼Œæå‡å‡†ç¡®æ€§ã€‚

* **è’¸é¦ï¼ˆDistillationï¼‰**ï¼šç”¨å¤§æ¨¡å‹ç”Ÿæˆçš„æ•°æ®æ¥ä¼˜åŒ–å°æ¨¡å‹çš„è¡¨ç°ã€‚

**ğŸ“Œ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè°ƒæ•´æç¤ºè¯å°±èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå¾®è°ƒé€‚ç”¨äºéœ€è¦**å®šåˆ¶åŒ–æ¨¡å‹\*\*çš„åœºæ™¯ã€‚

# ä¸‰ã€Web Searchï¼ˆç½‘é¡µæœç´¢ï¼‰

* åœ°å€ï¼šhttps://platform.openai.com/docs/guides/tools-web-search?api-mode=responses

![](images/7eb568a6-b1b6-49a5-83ad-56fae462bed6.png)

OpenAI Agents SDK æ”¯æŒ**ç½‘é¡µæœç´¢**ï¼Œå…è®¸æ¨¡å‹åœ¨ç”Ÿæˆå›ç­”ä¹‹å‰**æŸ¥è¯¢æœ€æ–°çš„ä¿¡æ¯**ï¼Œç±»ä¼¼äº ChatGPT çš„æœç´¢åŠŸèƒ½ï¼Œå¹¶æä¾›**æ¸…æ™°çš„å¼•ç”¨**æ¥æºã€‚

***

## **1. å¯ç”¨ Web æœç´¢**

ä½ å¯ä»¥åœ¨ API è¯·æ±‚ä¸­ï¼Œå°† `web_search_preview` **æ·»åŠ åˆ° `tools` æ•°ç»„** ä»¥å¯ç”¨ Web æœç´¢ã€‚æ¨¡å‹åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œå¯ä»¥**é€‰æ‹©**æ˜¯å¦ä½¿ç”¨æœç´¢å·¥å…·ã€‚

### **ğŸŒŸ ç¤ºä¾‹ï¼šå¯ç”¨ Web æœç´¢**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    tools=[{"type": "web_search_preview"}],  # å¯ç”¨ Web æœç´¢å·¥å…·
    input="What was a positive news story from today?"
)

print(response.output_text)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥ API è¯·æ±‚ä¼šè°ƒç”¨ `web_search_preview`ï¼Œå…è®¸æ¨¡å‹åœ¨å›ç­”å‰**æœç´¢æœ€æ–°çš„æ–°é—»**ã€‚

* ä½†**æ¨¡å‹å¯ä»¥è‡ªè¡Œå†³å®š**æ˜¯å¦ä½¿ç”¨è¯¥å·¥å…·ã€‚

***

## **2. å¼ºåˆ¶ä½¿ç”¨ Web æœç´¢**

å¦‚æœå¸Œæœ›**ç¡®ä¿æ¨¡å‹ä¸€å®šä½¿ç”¨ Web æœç´¢**ï¼ˆé¿å…å®ƒä»…ä½¿ç”¨å†…éƒ¨çŸ¥è¯†å›ç­”ï¼‰ï¼Œå¯ä»¥**è®¾ç½® `tool_choice` å‚æ•°**ï¼š

```python
tool_choice={"type": "web_search_preview"}
```

ğŸ“Œ **ä½œç”¨**ï¼š

* è®© Web æœç´¢**å§‹ç»ˆ**æ‰§è¡Œï¼Œè€Œä¸æ˜¯è®©æ¨¡å‹å†³å®šæ˜¯å¦ä½¿ç”¨æœç´¢å·¥å…·ã€‚

* **æå‡ä¸€è‡´æ€§**ï¼Œä½†å¯èƒ½ä¼šå¢åŠ **æŸ¥è¯¢æ—¶é—´**ã€‚

***

## **3. è¾“å‡ºæ ¼å¼ä¸å¼•ç”¨**

å¦‚æœæ¨¡å‹è°ƒç”¨äº† Web æœç´¢ï¼ŒAPI å“åº”å°†åŒ…å«**ä¸¤éƒ¨åˆ†**ï¼š

1. **Web æœç´¢è°ƒç”¨çš„ ID**

2. **æ¨¡å‹çš„å›ç­”**ï¼Œå¹¶å¸¦æœ‰ç½‘é¡µæ¥æºçš„**å¼•ç”¨ä¿¡æ¯**

### **ğŸ“Œ ç¤ºä¾‹è¾“å‡º**

```json
[
  {
    "type": "web_search_call",
    "id": "ws_67c9fa0502748190b7dd390736892e100be649c1a5ff9609",
    "status": "completed"
  },
  {
    "id": "msg_67c9fa077e288190af08fdffda2e34f20be649c1a5ff9609",
    "type": "message",
    "status": "completed",
    "role": "assistant",
    "content": [
      {
        "type": "output_text",
        "text": "On March 6, 2025, several news...",
        "annotations": [
          {
            "type": "url_citation",
            "start_index": 2606,
            "end_index": 2758,
            "url": "https://...",
            "title": "Title..."
          }
        ]
      }
    ]
  }
]
```

ğŸ“Œ **è§£æ**ï¼š

* `web_search_call`ï¼šå­˜å‚¨æœç´¢è¯·æ±‚çš„ ID å’ŒçŠ¶æ€ï¼ˆå·²å®Œæˆï¼‰ã€‚

```plaintext
message
```

* ï¼š

  * `output_text`ï¼šæ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬ã€‚

  ```plaintext
  annotations
  ```

  * ï¼š

    * `url_citation`ï¼šæä¾›**å¼•ç”¨æ¥æº**ï¼ŒåŒ…æ‹¬ URLã€æ ‡é¢˜ã€æ–‡æœ¬åœ¨å›ç­”ä¸­çš„ä½ç½®ã€‚

ğŸ“Œ **å‰ç«¯è¦æ±‚**ï¼š

* å½“å‘ç”¨æˆ·å±•ç¤ºæœç´¢ç»“æœæ—¶ï¼Œ**å¿…é¡»æä¾›æ¸…æ™°çš„å¼•ç”¨**ï¼Œå¹¶ç¡®ä¿**å¯ç‚¹å‡»**ã€‚

***

## **4. å®šåˆ¶ç”¨æˆ·ä½ç½®**

Web æœç´¢**å¯ä»¥æ ¹æ®ç”¨æˆ·çš„ä½ç½®**ä¼˜åŒ–æœç´¢ç»“æœã€‚ä½ å¯ä»¥æŒ‡å®šï¼š

* `country`ï¼ˆå›½å®¶ï¼‰ï¼š**ä¸¤å­—æ¯ ISO ä»£ç **ï¼Œå¦‚ `"US"`ï¼ˆç¾å›½ï¼‰ã€`"GB"`ï¼ˆè‹±å›½ï¼‰ã€‚

* `city`ï¼ˆåŸå¸‚ï¼‰ï¼šå¦‚ `"London"`ï¼ˆä¼¦æ•¦ï¼‰ã€‚

* `region`ï¼ˆåœ°åŒºï¼‰ï¼šå¦‚ `"California"`ï¼ˆåŠ å·ï¼‰ã€‚

* `timezone`ï¼ˆæ—¶åŒºï¼‰ï¼šå¦‚ `"America/Chicago"`ï¼ˆèŠåŠ å“¥æ—¶é—´ï¼‰ã€‚

### **ğŸŒŸ ç¤ºä¾‹ï¼šæŒ‡å®šæœç´¢ä½ç½®**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    tools=[{
        "type": "web_search_preview",
        "user_location": {
            "type": "approximate",
            "country": "GB",
            "city": "London",
            "region": "London",
        }
    }],
    input="What are the best restaurants around Granary Square?",
)

print(response.output_text)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥æŸ¥è¯¢ä¼šè¿”å›**ä¼¦æ•¦ Granary Square é™„è¿‘çš„æœ€ä½³é¤å…**ã€‚

***

## **5. æœç´¢ä¸Šä¸‹æ–‡å¤§å°ï¼ˆContext Sizeï¼‰**

`search_context_size` **æ§åˆ¶ä» Web è·å–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯é‡**ï¼Œå½±å“**æˆæœ¬ã€è´¨é‡å’Œå»¶è¿Ÿ**ã€‚

### **å¯é€‰å€¼**

| **å€¼**           | **æè¿°**               | **æˆæœ¬** | **è´¨é‡** | **å“åº”é€Ÿåº¦** |
| --------------- | -------------------- | ------ | ------ | -------- |
| **high**        | **æœ€ä¸°å¯Œçš„ä¸Šä¸‹æ–‡**ï¼Œé€‚ç”¨äºæ·±åº¦æŸ¥è¯¢  | é«˜      | é«˜      | æ…¢        |
| **medium** (é»˜è®¤) | **å¹³è¡¡ä¸Šä¸‹æ–‡ã€æˆæœ¬å’Œé€Ÿåº¦**      | ä¸­      | ä¸­      | ä¸­        |
| **low**         | **æœ€å°‘çš„ä¸Šä¸‹æ–‡ï¼Œæˆæœ¬æœ€ä½ï¼Œé€Ÿåº¦æœ€å¿«** | ä½      | ä½      | å¿«        |

### **ğŸŒŸ ç¤ºä¾‹ï¼šä½¿ç”¨ä½ä¸Šä¸‹æ–‡**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    tools=[{
        "type": "web_search_preview",
        "search_context_size": "low",
    }],
    input="What movie won best picture in 2025?",
)

print(response.output_text)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥æŸ¥è¯¢**ä»¥æœ€ä½æˆæœ¬å’Œæœ€å¿«é€Ÿåº¦**è·å–**æœ€ä½³å½±ç‰‡å¥–**çš„æœ€æ–°ä¿¡æ¯ã€‚

ğŸ“Œ **æ³¨æ„**ï¼š

* **æœç´¢å·¥å…·çš„ token æ¶ˆè€—** **ä¸ä¼šå½±å“æ¨¡å‹çš„ token é¢„ç®—**ï¼Œä¸”ä¸ä¼šè·¨å›åˆä¿å­˜ã€‚

***

## **6. é™åˆ¶ä¸æ³¨æ„äº‹é¡¹**

åœ¨ä½¿ç”¨ Web æœç´¢æ—¶ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹**é™åˆ¶**ï¼š

1. **æ•°æ®ä¿ç•™ï¼ˆData Retentionï¼‰**

   * è¯¥å·¥å…·**ä¸æ”¯æŒ 0 æ•°æ®ä¿ç•™**æˆ–**æ•°æ®é©»ç•™ç­–ç•¥**ï¼ˆå³ API å¯èƒ½ä¼šçŸ­æœŸå­˜å‚¨æŸ¥è¯¢æ•°æ®ï¼‰ã€‚

2. **éƒ¨åˆ†æ¨¡å‹æ”¯æŒ**

   * `gpt-4o-search-preview` å’Œ `gpt-4o-mini-search-preview` **ä»…æ”¯æŒ API çš„ä¸€éƒ¨åˆ†å‚æ•°**ï¼Œè¯·æŸ¥çœ‹**æ¨¡å‹æ–‡æ¡£**è·å–å…·ä½“çš„é€Ÿç‡é™åˆ¶å’ŒåŠŸèƒ½æ”¯æŒã€‚

3. **é€Ÿç‡é™åˆ¶**

   * Web æœç´¢å·¥å…·çš„è°ƒç”¨**éµå¾ªä¸æ¨¡å‹ç›¸åŒçš„é€Ÿç‡é™åˆ¶**ï¼ˆtiered rate limitsï¼‰ã€‚

# Part ä¸‰ã€**æ–‡ä»¶æœç´¢ï¼ˆFile Searchï¼‰**

* åœ°å€ï¼šhttps://platform.openai.com/docs/guides/tools-file-search

![](images/6c388604-f33e-4bb2-b307-ee82f72c1ef7.png)

OpenAI Agents SDK æ”¯æŒ**æ–‡ä»¶æœç´¢åŠŸèƒ½**ï¼Œå…è®¸æ¨¡å‹åœ¨ç”Ÿæˆå›ç­”ä¹‹å‰**æ£€ç´¢ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶**ä¸­çš„ç›¸å…³ä¿¡æ¯ã€‚

***

## **1. æ–‡ä»¶æœç´¢æ¦‚è¿°**

`file_search` å·¥å…·å¯ä»¥è®©æ¨¡å‹åœ¨**å·²ä¸Šä¼ çš„æ–‡ä»¶çŸ¥è¯†åº“**ï¼ˆvector storesï¼‰ä¸­è¿›è¡Œ**è¯­ä¹‰æœç´¢**å’Œ**å…³é”®è¯æœç´¢**ï¼Œä»è€Œæ‰©å±•æ¨¡å‹çš„å†…åœ¨çŸ¥è¯†ã€‚

ğŸ“Œ **ç‰¹ç‚¹**ï¼š

* **æ‰˜ç®¡å·¥å…·**ï¼ˆç”± OpenAI è´Ÿè´£ç®¡ç†ï¼Œæ— éœ€ç”¨æˆ·è‡ªè¡Œå®ç°æœç´¢é€»è¾‘ï¼‰ã€‚

* **è‡ªåŠ¨è°ƒç”¨**ï¼šæ¨¡å‹**å†³å®š**ä½•æ—¶ä½¿ç”¨è¯¥å·¥å…·è¿›è¡Œæ£€ç´¢ã€‚

* **å‘é‡å­˜å‚¨æ”¯æŒ**ï¼šé€šè¿‡**åˆ›å»ºå‘é‡å­˜å‚¨**å¹¶ä¸Šä¼ æ–‡ä»¶æ¥å¢å¼ºæ¨¡å‹çš„çŸ¥è¯†ã€‚

ğŸ“Œ **ç›¸å…³æ¦‚å¿µ**ï¼š

* **Vector Storeï¼ˆå‘é‡å­˜å‚¨ï¼‰**ï¼šä¸€ä¸ªå¯å­˜å‚¨**æ–‡æœ¬å‘é‡åŒ–æ•°æ®**çš„æ•°æ®åº“ï¼Œæ”¯æŒ**è¯­ä¹‰æ£€ç´¢**ã€‚

* **Semantic Searchï¼ˆè¯­ä¹‰æœç´¢ï¼‰**ï¼šåˆ©ç”¨**å‘é‡è¡¨ç¤º**è¿›è¡Œç›¸ä¼¼æ€§åŒ¹é…ï¼Œè€Œä¸ä»…ä»…æ˜¯å…³é”®å­—åŒ¹é…ã€‚

ğŸ“Œ **å­¦ä¹ æ›´å¤š**ï¼šå¯å‚è€ƒ **OpenAI Retrieval Guideï¼ˆæ£€ç´¢æŒ‡å—ï¼‰**ã€‚

***

## **2. ä½¿ç”¨æ–‡ä»¶æœç´¢**

åœ¨ä½¿ç”¨æ–‡ä»¶æœç´¢å‰ï¼Œç”¨æˆ·éœ€è¦ï¼š

1. **åˆ›å»ºå‘é‡å­˜å‚¨ï¼ˆVector Storeï¼‰**ã€‚

2. **ä¸Šä¼ æ–‡ä»¶åˆ°å‘é‡å­˜å‚¨**ã€‚

3. **åœ¨ API è°ƒç”¨ä¸­å¯ç”¨ `file_search`**ï¼Œå¹¶**æŒ‡å®šå‘é‡å­˜å‚¨ ID**ã€‚

ğŸ“Œ **âš ï¸ é™åˆ¶**ï¼š

* ç›®å‰ **ä¸€æ¬¡æœç´¢ä»…æ”¯æŒä¸€ä¸ªå‘é‡å­˜å‚¨**ï¼ˆ`vector_store_ids` åªèƒ½åŒ…å«ä¸€ä¸ª IDï¼‰ã€‚

***

## **3. å¯ç”¨æ–‡ä»¶æœç´¢**

### **ğŸŒŸ ç¤ºä¾‹ï¼šä½¿ç”¨ `file_search` è¿›è¡Œæ–‡ä»¶æ£€ç´¢**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="gpt-4o-mini",
    input="What is deep research by OpenAI?",
    tools=[{
        "type": "file_search",
        "vector_store_ids": ["<vector_store_id>"]  # æŒ‡å®šè¦æœç´¢çš„å‘é‡å­˜å‚¨
    }]
)

print(response)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥æŸ¥è¯¢ä¼šåœ¨**æŒ‡å®šçš„ `vector_store_id` çŸ¥è¯†åº“**ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿”å›æ¨¡å‹çš„å›ç­”ã€‚

* **æ¨¡å‹è‡ªåŠ¨å†³å®šæ˜¯å¦è°ƒç”¨æ–‡ä»¶æœç´¢**ã€‚

***

## **4. API å“åº”ç»“æ„**

å½“ `file_search` å·¥å…·è¢«è°ƒç”¨åï¼ŒAPI å“åº”å°†åŒ…å«**ä¸¤éƒ¨åˆ†**ï¼š

1. **`file_search_call`**ï¼šå­˜å‚¨æœç´¢è¯·æ±‚çš„ ID å’ŒæŸ¥è¯¢å†…å®¹ã€‚

2. **`message`**ï¼šå­˜å‚¨æ¨¡å‹çš„å›ç­”ï¼Œå¹¶åŒ…å«**æ–‡ä»¶å¼•ç”¨ä¿¡æ¯ï¼ˆfile citationsï¼‰**ã€‚

### **ğŸ“Œ ç¤ºä¾‹è¾“å‡º**

```json
{
  "output": [
    {
      "type": "file_search_call",
      "id": "fs_67c09ccea8c48191ade9367e3ba71515",
      "status": "completed",
      "queries": ["What is deep research?"],
      "search_results": null
    },
    {
      "id": "msg_67c09cd3091c819185af2be5d13d87de",
      "type": "message",
      "role": "assistant",
      "content": [
        {
          "type": "output_text",
          "text": "Deep research is a sophisticated capability that allows for extensive inquiry and synthesis of information across various domains...",
          "annotations": [
            {
              "type": "file_citation",
              "index": 992,
              "file_id": "file-2dtbBZdjtDKS8eqWxqbgDi",
              "filename": "deep_research_blog.pdf"
            },
            {
              "type": "file_citation",
              "index": 1176,
              "file_id": "file-2dtbBZdjtDKS8eqWxqbgDi",
              "filename": "deep_research_blog.pdf"
            }
          ]
        }
      ]
    }
  ]
}
```

ğŸ“Œ **è§£æ**ï¼š

* **`file_search_call`**ï¼šå­˜å‚¨æœç´¢è¯·æ±‚çš„ IDã€çŠ¶æ€å’ŒæŸ¥è¯¢å†…å®¹ã€‚

* `message`

* ï¼š

  * `output_text`ï¼šæ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬ã€‚

  * **`annotations`**ï¼šæä¾›**å¼•ç”¨æ–‡ä»¶ä¿¡æ¯**ï¼ŒåŒ…æ‹¬ `file_id` å’Œ `filename`ï¼Œæ ‡æ˜ä¿¡æ¯çš„æ¥æºã€‚

***

## **5. æ£€ç´¢ç»“æœå®šåˆ¶**

ä½ å¯ä»¥è‡ªå®šä¹‰æœç´¢è¡Œä¸ºï¼Œä»¥ä¼˜åŒ–**ç»“æœè´¨é‡ã€æˆæœ¬å’Œå“åº”é€Ÿåº¦**ã€‚

### **ğŸŒŸ é™åˆ¶æœç´¢ç»“æœæ•°é‡**

**å‡å°‘æœç´¢ç»“æœæ•°é‡**å¯ä»¥ï¼š

* **é™ä½ token ä½¿ç”¨é‡**

* **æé«˜æŸ¥è¯¢é€Ÿåº¦**

* **ä½†å¯èƒ½å½±å“ç­”æ¡ˆè´¨é‡**

ğŸ“Œ **ç¤ºä¾‹ï¼šé™åˆ¶æœç´¢ç»“æœä¸º 2 æ¡**

```python
response = client.responses.create(
    model="gpt-4o-mini",
    input="What is deep research by OpenAI?",
    tools=[{
        "type": "file_search",
        "vector_store_ids": ["<vector_store_id>"],
        "max_num_results": 2  # é™åˆ¶æœç´¢è¿”å›çš„æ–‡ä»¶æ•°é‡
    }]
)
print(response)
```

***

### **ğŸŒŸ åŒ…å«æœç´¢ç»“æœ**

é»˜è®¤æƒ…å†µä¸‹ï¼Œæœç´¢ç»“æœ**ä¸ä¼šç›´æ¥åŒ…å«**åœ¨ API å“åº”ä¸­ï¼Œä»…è¿”å›**å¼•ç”¨ä¿¡æ¯**ï¼ˆannotationsï¼‰ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šè®© API å“åº”åŒ…å«æœç´¢ç»“æœ**

```python
response = client.responses.create(
    model="gpt-4o-mini",
    input="What is deep research by OpenAI?",
    tools=[{
        "type": "file_search",
        "vector_store_ids": ["<vector_store_id>"]
    }],
    include=["output[*].file_search_call.search_results"]
)
print(response)
```

ğŸ“Œ **ä½œç”¨**ï¼š

* `include` å‚æ•°æŒ‡å®šè¦åŒ…å« `search_results`ï¼Œä»¥ä¾¿ç›´æ¥è·å–æœç´¢çš„åŸå§‹æ•°æ®ã€‚

***

### **ğŸŒŸ è¿‡æ»¤æ–‡ä»¶å…ƒæ•°æ®**

å¦‚æœçŸ¥è¯†åº“ä¸­åŒ…å«ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼ˆåšå®¢ã€è®ºæ–‡ã€ä»£ç ç­‰ï¼‰ï¼Œå¯ä»¥**æŒ‰æ–‡ä»¶ç±»å‹ç­›é€‰**æœç´¢ç»“æœã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šåªæœç´¢åšå®¢æ–‡ç« **

```python
response = client.responses.create(
    model="gpt-4o-mini",
    input="What is deep research by OpenAI?",
    tools=[{
        "type": "file_search",
        "vector_store_ids": ["<vector_store_id>"],
        "filters": {
            "type": "eq",   # ç­‰äº
            "key": "type",  # è¿‡æ»¤å­—æ®µ
            "value": "blog" # åªæœç´¢åšå®¢
        }
    }]
)
print(response)
```

ğŸ“Œ **ä½œç”¨**ï¼š

* è¯¥æŸ¥è¯¢**ä»…æœç´¢æ ‡è®°ä¸ºâ€œåšå®¢â€ç±»å‹**çš„æ–‡ä»¶ï¼Œè¿‡æ»¤æ‰å…¶ä»–æ–‡ä»¶ï¼ˆå¦‚è®ºæ–‡ã€ä»£ç ç­‰ï¼‰ã€‚

***

## **6. æ”¯æŒçš„æ–‡ä»¶æ ¼å¼**

ğŸ“Œ **æ–‡ä»¶æ ¼å¼æ”¯æŒ**ï¼š

* **æ–‡æœ¬æ–‡ä»¶**ï¼ˆ`.txt`, `.md`, `.html`ï¼‰

* **ä»£ç æ–‡ä»¶**ï¼ˆ`.py`, `.js`, `.java`, `.cpp`ï¼‰

* **æ–‡æ¡£**ï¼ˆ`.pdf`, `.docx`, `.pptx`ï¼‰

* **JSON / XML æ•°æ®**ï¼ˆ`.json`ï¼‰

| **æ–‡ä»¶æ ¼å¼** | **MIME ç±»å‹**                                                               |
| -------- | ------------------------------------------------------------------------- |
| `.pdf`   | `application/pdf`                                                         |
| `.docx`  | `application/vnd.openxmlformats-officedocument.wordprocessingml.document` |
| `.json`  | `application/json`                                                        |
| `.py`    | `text/x-python`                                                           |
| `.txt`   | `text/plain`                                                              |

ğŸ“Œ **å­—ç¬¦ç¼–ç **ï¼šæ–‡ä»¶å¿…é¡»ä½¿ç”¨ `utf-8`ã€`utf-16` æˆ– `ascii` ç¼–ç ã€‚

***

## **7. é™åˆ¶**

ä½¿ç”¨ `file_search` æ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹é™åˆ¶ï¼š

* **é¡¹ç›®çº§åˆ«**ï¼šæœ€å¤šå¯å­˜å‚¨ **100GB** æ–‡ä»¶ã€‚

* **å‘é‡å­˜å‚¨**ï¼šæœ€å¤šæ”¯æŒ **10,000** ä¸ªæ–‡ä»¶ã€‚

* **å•ä¸ªæ–‡ä»¶å¤§å°**ï¼šæœ€å¤§ **512MB**ï¼ˆçº¦ 500 ä¸‡ tokensï¼‰ã€‚

# Part å››ã€**è®¡ç®—æœºä½¿ç”¨ï¼ˆComputer Useï¼‰**

* åœ°å€ï¼šhttps://platform.openai.com/docs/guides/tools-computer-use

![](images/606d17b4-68ae-41d3-88bf-4879061dfd04.png)

OpenAI çš„ **è®¡ç®—æœºä½¿ç”¨ä»£ç†ï¼ˆComputer-Using Agent, CUAï¼‰** å…è®¸æ¨¡å‹**æ¨¡æ‹Ÿ**äººåœ¨è®¡ç®—æœºä¸Šæ“ä½œï¼Œä¾‹å¦‚ç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ç­‰ï¼Œä»è€Œæ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚

***

## **1. æ¦‚è¿°**

**Computer Useï¼ˆè®¡ç®—æœºä½¿ç”¨ï¼‰** æ˜¯ OpenAI æä¾›çš„ä¸€ç§**å¢å¼ºç‰ˆ CUAï¼ˆè®¡ç®—æœºä½¿ç”¨ä»£ç†ï¼‰**ï¼ŒåŸºäº **`computer-use-preview`** æ¨¡å‹ï¼Œç»“åˆï¼š

* **GPT-4o çš„è§†è§‰èƒ½åŠ›**ï¼ˆè¯†åˆ«å±å¹•æˆªå›¾ï¼‰

* **é«˜çº§æ¨ç†èƒ½åŠ›**ï¼ˆæ¨¡æ‹Ÿè®¡ç®—æœºç•Œé¢äº¤äº’ï¼‰

ğŸ“Œ **ç‰¹ç‚¹**ï¼š

* **å…è®¸æ¨¡å‹æ‰§è¡Œè®¡ç®—æœºæ“ä½œ**ï¼ˆå¦‚ç‚¹å‡»ã€è¾“å…¥æ–‡æœ¬ã€æ»šåŠ¨é¡µé¢ï¼‰ã€‚

* **é€šè¿‡æˆªå›¾æ„ŸçŸ¥ç•Œé¢å˜åŒ–**ï¼Œå¹¶å†³å®šä¸‹ä¸€æ­¥æ“ä½œã€‚

* **å¯ç”¨äºç½‘é¡µæµè§ˆã€æ•°æ®è¾“å…¥ã€åœ¨çº¿è´­ç‰©ã€è¡¨å•å¡«å†™ç­‰ä»»åŠ¡**ã€‚

ğŸ“Œ **å½“å‰çŠ¶æ€**ï¼š

* **Beta ç‰ˆ**ï¼Œå¯èƒ½å­˜åœ¨æ¼æ´æˆ–é”™è¯¯ã€‚

* **ä¸é€‚ç”¨äºé«˜å®‰å…¨æ€§ä»»åŠ¡**ï¼ˆå¦‚é“¶è¡Œäº¤æ˜“ã€ä¸ªäººè´¦æˆ·ç®¡ç†ï¼‰ã€‚

* **å¿…é¡»ç¬¦åˆ OpenAI çš„**[ä½¿ç”¨æ”¿ç­–](https://openai.com/usage-policy)ã€‚

ğŸ“Œ **é€‚ç”¨ API**ï¼š

* âœ… **Responses API**

* âŒ **ä¸é€‚ç”¨äº Chat Completions**

***

## **2. å·¥ä½œåŸç†**

è®¡ç®—æœºä½¿ç”¨å·¥å…·çš„æ‰§è¡Œæµç¨‹æ˜¯ä¸€ä¸ª**å¾ªç¯ï¼ˆloopï¼‰**ï¼š

1. **å‘é€è¯·æ±‚**ï¼šç”¨æˆ·æä¾›ç›®æ ‡ä»»åŠ¡ï¼ˆå¦‚â€œåœ¨ Bing æœç´¢ OpenAI æœ€æ–°æ–°é—»â€ï¼‰ã€‚

2. æ¥æ”¶å“åº”

3. ï¼š

   * æ¨¡å‹å¯èƒ½è¿”å›**è®¡ç®—æœºæ“ä½œï¼ˆcomputer\_callï¼‰**ï¼ˆå¦‚ç‚¹å‡»ã€è¾“å…¥ï¼‰ã€‚

   * ä¹Ÿå¯èƒ½è¿”å›**æ¨ç†ç»“æœï¼ˆreasoningï¼‰** æˆ–**å®‰å…¨æ£€æŸ¥ï¼ˆsafety\_checkï¼‰**ã€‚

4. **æ‰§è¡Œæ“ä½œ**ï¼šåº”ç”¨ä»£ç **æ¨¡æ‹Ÿæ“ä½œ**ï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥æ–‡æœ¬ã€‚

5. **è·å–æ›´æ–°çŠ¶æ€**ï¼šæ‰§è¡Œæ“ä½œåï¼Œæˆªå›¾å½“å‰ç•Œé¢å¹¶ä¼ å›æ¨¡å‹ã€‚

6. **é‡å¤ä»¥ä¸Šæ­¥éª¤**ï¼Œç›´åˆ°æ¨¡å‹å®Œæˆä»»åŠ¡æˆ–ç”¨æˆ·åœæ­¢ã€‚

ğŸ“Œ **è¯¥æµç¨‹é€‚ç”¨äº**ï¼š

* **æµè§ˆå™¨æ“ä½œ**ï¼ˆ`browser`ï¼‰

* **æœ¬åœ°æ“ä½œ**ï¼ˆ`mac`ã€`windows`ã€`ubuntu`ï¼‰

***

## **3. ç¯å¢ƒè®¾ç½®**

ä¸ºäº†å®‰å…¨åœ°è¿è¡Œ **CUAï¼ˆè®¡ç®—æœºä½¿ç”¨ä»£ç†ï¼‰**ï¼Œå»ºè®®ï¼š

* **ä½¿ç”¨éš”ç¦»ç¯å¢ƒï¼ˆsandboxï¼‰**ï¼Œé¿å…å½±å“çœŸå®ç³»ç»Ÿã€‚

* **åˆ›å»ºæœ¬åœ°è™šæ‹Ÿæœº** ä»¥æ¨¡æ‹Ÿè®¡ç®—æœºç¯å¢ƒã€‚

ğŸ“Œ **ç¤ºä¾‹ç¯å¢ƒ**ï¼š

| ç¯å¢ƒç±»å‹        | é€‚ç”¨åœºæ™¯          |
| ----------- | ------------- |
| **æœ¬åœ°æµè§ˆå™¨**   | ç½‘é¡µè‡ªåŠ¨åŒ–ï¼ˆå¦‚æœç´¢ã€å¡«è¡¨ï¼‰ |
| **è™šæ‹Ÿæœºï¼ˆVMï¼‰** | å®‰å…¨æµ‹è¯•ï¼Œé¿å…ç ´åä¸»ç³»ç»Ÿ  |
| **äº‘ç«¯å®ä¾‹**    | è¿œç¨‹æ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡     |

***

## **4. CUA é›†æˆæµç¨‹**

è¦åœ¨åº”ç”¨ä¸­é›†æˆ **è®¡ç®—æœºä½¿ç”¨ä»£ç†ï¼ˆCUAï¼‰**ï¼Œéœ€éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

### **ğŸŒŸ 1. å‘é€è¯·æ±‚**

ä½ éœ€è¦**è°ƒç”¨ `computer-use-preview` æ¨¡å‹**ï¼Œå¹¶**å¯ç”¨ `computer_use_preview` å·¥å…·**ï¼ŒæŒ‡å®šï¼š

* **å±å¹•å°ºå¯¸**ï¼ˆ`display_width`, `display_height`ï¼‰

* **æ“ä½œç¯å¢ƒ**ï¼ˆ`environment`ï¼šå¦‚ `browser`ã€`windows`ã€`ubuntu`ï¼‰

* **ç›®æ ‡ä»»åŠ¡**ï¼ˆè¾“å…¥ `input` æŒ‡ä»¤ï¼‰

ğŸ“Œ **ç¤ºä¾‹ï¼šè®© CUA åœ¨ Bing æœç´¢ OpenAI æ–°é—»**

```python
from openai import OpenAI

client = OpenAI()

response = client.responses.create(
    model="computer-use-preview",
    tools=[{
        "type": "computer_use_preview",
        "display_width": 1024,
        "display_height": 768,
        "environment": "browser"  # å…¶ä»–é€‰é¡¹ï¼š"mac", "windows", "ubuntu"
    }],
    input=[
        {
            "role": "user",
            "content": "Check the latest OpenAI news on bing.com."
        }
        # å¯é€‰ï¼šåŒ…å«åˆå§‹ç•Œé¢çš„æˆªå›¾
        # {
        #     "type": "input_image",
        #     "image_url": f"data:image/png;base64,{screenshot_base64}"
        # }
    ],
    truncation="auto"  # å…è®¸æˆªæ–­
)

print(response.output)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥ API è¯·æ±‚ä¼šå¯åŠ¨è®¡ç®—æœºä»£ç†ï¼Œè®©å®ƒ**åœ¨ Bing ä¸Šæœç´¢ OpenAI æ–°é—»**ã€‚

* **å¯é€‰**ï¼šä¼ å…¥ç•Œé¢æˆªå›¾ï¼ˆBase64 ç¼–ç ï¼‰ä»¥å¸®åŠ©æ¨¡å‹ç†è§£å½“å‰ç¯å¢ƒã€‚

***

### **ğŸŒŸ 2. æ¥æ”¶å»ºè®®æ“ä½œ**

æ¨¡å‹çš„ API å“åº”å¯èƒ½åŒ…å«ï¼š

* **æ–‡æœ¬è¾“å‡º**

* **è®¡ç®—æœºæ“ä½œï¼ˆcomputer\_callï¼‰**

* **å…¶ä»–å·¥å…·è°ƒç”¨**

ğŸ“Œ **ç¤ºä¾‹ï¼šæ¨¡å‹è¿”å›ç‚¹å‡»æ“ä½œ**

```json
"output": [
    {
        "type": "reasoning",
        "id": "rs_67cc...",
        "content": []
    },
    {
        "type": "computer_call",
        "id": "cu_67cc...",
        "call_id": "call_zw3...",
        "action": {
            "type": "click",
            "button": "left",
            "x": 156,
            "y": 50
        },
        "pending_safety_checks": [],
        "status": "completed"
    }
]
```

ğŸ“Œ **è§£æ**ï¼š

* **`computer_call`**ï¼šå‘Šè¯‰åº”ç”¨ç¨‹åº**æ‰§è¡Œç‚¹å‡»æ“ä½œ**ï¼ˆåœ¨ `x=156, y=50`ï¼‰ã€‚

* **`reasoning`**ï¼šæä¾›æ¨ç†è¿‡ç¨‹ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚

* **`pending_safety_checks`**ï¼šå¦‚æœå­˜åœ¨å®‰å…¨æ£€æŸ¥ï¼Œåº”ç”¨ç¨‹åºéœ€è¦å¤„ç†ã€‚

***

### **ğŸŒŸ 3. æ‰§è¡Œæ“ä½œ**

ä½ çš„åº”ç”¨ç¨‹åº**éœ€è¦è§£æ API å“åº”**ï¼Œå¹¶**æ‰§è¡Œæ¨¡å‹å»ºè®®çš„æ“ä½œ**ï¼š

* **é¼ æ ‡ç‚¹å‡»**ï¼ˆ`click(x, y)`ï¼‰

* **è¾“å…¥æ–‡æœ¬**ï¼ˆ`type(text)`ï¼‰

* **æ»šåŠ¨é¡µé¢**ï¼ˆ`scroll(direction, amount)`ï¼‰

ğŸ“Œ **ç¤ºä¾‹ï¼šPython ä»£ç æ‰§è¡Œç‚¹å‡»**

```python
import pyautogui  # ä½¿ç”¨ PyAutoGUI è¿›è¡Œ GUI æ“ä½œ

# è§£æ API è¿”å›çš„ x, y åæ ‡
x, y = 156, 50
pyautogui.click(x, y)  # æ‰§è¡Œç‚¹å‡»æ“ä½œ
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* Python ä»£ç ä¼š**åœ¨å±å¹•ä¸Šçš„ `x=156, y=50` ä½ç½®æ‰§è¡Œç‚¹å‡»**ã€‚

***

### **ğŸŒŸ 4. è·å–æ›´æ–°åçš„ç•Œé¢çŠ¶æ€**

å®Œæˆæ“ä½œåï¼Œåº”ç”¨ç¨‹åºåº”**æˆªå›¾å½“å‰ç•Œé¢**å¹¶**ä¼ å›æ¨¡å‹**ï¼Œä»¥ä¾¿ CUA ç»§ç»­ä¸‹ä¸€æ­¥ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šæˆªå–å±å¹•æˆªå›¾å¹¶è½¬ä¸º Base64**

```python
import pyautogui
import base64
from io import BytesIO
from PIL import Image

# æˆªå›¾
screenshot = pyautogui.screenshot()
buffer = BytesIO()
screenshot.save(buffer, format="PNG")
screenshot_base64 = base64.b64encode(buffer.getvalue()).decode()

# å‘é€æˆªå›¾åˆ° API
response = client.responses.create(
    model="computer-use-preview",
    tools=[{"type": "computer_use_preview"}],
    input=[{
        "type": "input_image",
        "image_url": f"data:image/png;base64,{screenshot_base64}"
    }]
)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* ä»£ç ä¼š**æˆªå›¾å½“å‰å±å¹•**ï¼Œå¹¶**å°†å…¶ä½œä¸º `input_image` ä¼ ç»™æ¨¡å‹**ï¼Œç»§ç»­æ‰§è¡Œä»»åŠ¡ã€‚

***

## **5. å®‰å…¨æ£€æŸ¥**

CUA å¯èƒ½ä¼šè¿”å›**å®‰å…¨æ£€æŸ¥ï¼ˆsafety\_checkï¼‰**ï¼Œä»¥é¿å…æ‰§è¡Œé£é™©æ“ä½œï¼š

* **å¦‚æœ API å“åº”åŒ…å« `pending_safety_check`**ï¼Œä½ éœ€è¦**ç¡®è®¤å¹¶æ‰‹åŠ¨æ‰§è¡Œæ£€æŸ¥**ã€‚

* **é¿å…åœ¨** **å®Œå…¨è®¤è¯ç¯å¢ƒï¼ˆå¦‚é“¶è¡Œè´¦æˆ·ã€ç§äººæ•°æ®ï¼‰** **ä½¿ç”¨ CUA**ã€‚

### **è®¡ç®—æœºä½¿ç”¨ï¼ˆCUAï¼‰â€”â€”æ‰§è¡Œæ“ä½œã€å¾ªç¯å¤„ç†ä¸å®‰å…¨æœºåˆ¶**

æœ¬èŠ‚ä»‹ç»å¦‚ä½•**æ‰§è¡Œè®¡ç®—æœºæ“ä½œ**ï¼Œå¤„ç†å¾ªç¯ä»»åŠ¡ï¼Œå¹¶**ç®¡ç†å®‰å…¨æ€§**ä»¥é¿å…æ»¥ç”¨æˆ–é”™è¯¯æ‰§è¡Œä»»åŠ¡ã€‚

***

## **1. æ‰§è¡Œè®¡ç®—æœºæ“ä½œ**

æ¨¡å‹è¿”å›çš„ `computer_call` åŒ…å«**å…·ä½“çš„æ“ä½œæŒ‡ä»¤**ï¼ˆå¦‚ç‚¹å‡»ã€æ»šåŠ¨ã€é”®ç›˜è¾“å…¥ç­‰ï¼‰ã€‚ä½ çš„åº”ç”¨ç¨‹åºéœ€è¦**è§£æè¿™äº›æŒ‡ä»¤**ï¼Œç„¶ååœ¨è®¡ç®—æœºæˆ–æµè§ˆå™¨ç¯å¢ƒä¸­æ‰§è¡Œç›¸åº”æ“ä½œã€‚

ğŸ“Œ **æ”¯æŒçš„æ“ä½œç±»å‹**ï¼š

* `click(x, y, button="left")` â†’ é¼ æ ‡ç‚¹å‡»

* `scroll(x, y, scroll_x, scroll_y)` â†’ æ»šåŠ¨é¡µé¢

* `keypress(keys)` â†’ æŒ‰é”®è¾“å…¥

* `type(text)` â†’ è¾“å…¥æ–‡æœ¬

* `wait()` â†’ ç­‰å¾…ä¸€æ®µæ—¶é—´

* `screenshot()` â†’ æˆªå›¾ï¼ˆç”¨äºåé¦ˆç»™æ¨¡å‹ï¼‰

***

### **ğŸŒŸ ç¤ºä¾‹ï¼šä½¿ç”¨ Playwright å¤„ç†è®¡ç®—æœºæ“ä½œ**

ğŸ“Œ **é€‚ç”¨äº** Web è‡ªåŠ¨åŒ–ï¼ˆæµè§ˆå™¨ç¯å¢ƒï¼‰

```python
def handle_model_action(page, action):
    """
    æ ¹æ®æ¨¡å‹æä¾›çš„è®¡ç®—æœºæ“ä½œï¼ˆclickã€scrollã€typeç­‰ï¼‰ï¼Œæ‰§è¡Œç›¸åº”æ“ä½œã€‚
    """
    action_type = action.type

    try:
        match action_type:
            case "click":
                x, y = action.x, action.y
                button = action.button
                print(f"ç‚¹å‡»åæ ‡: ({x}, {y})ï¼ŒæŒ‰é’®: '{button}'")
                if button not in ["left", "right"]:
                    button = "left"
                page.mouse.click(x, y, button=button)

            case "scroll":
                x, y = action.x, action.y
                scroll_x, scroll_y = action.scroll_x, action.scroll_y
                print(f"æ»šåŠ¨è‡³: ({x}, {y})ï¼Œåç§»é‡: (scroll_x={scroll_x}, scroll_y={scroll_y})")
                page.mouse.move(x, y)
                page.evaluate(f"window.scrollBy({scroll_x}, {scroll_y})")

            case "keypress":
                keys = action.keys
                for k in keys:
                    print(f"æŒ‰é”®è¾“å…¥: '{k}'")
                    if k.lower() == "enter":
                        page.keyboard.press("Enter")
                    elif k.lower() == "space":
                        page.keyboard.press(" ")
                    else:
                        page.keyboard.press(k)

            case "type":
                text = action.text
                print(f"è¾“å…¥æ–‡æœ¬: {text}")
                page.keyboard.type(text)

            case "wait":
                print(f"ç­‰å¾… 2 ç§’")
                time.sleep(2)

            case "screenshot":
                print(f"æˆªå›¾è¯·æ±‚")

            case _:
                print(f"æœªè¯†åˆ«çš„æ“ä½œ: {action}")

    except Exception as e:
        print(f"æ‰§è¡Œæ“ä½œæ—¶å‡ºé”™ {action}: {e}")
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* **è§£æ API è¿”å›çš„ `computer_call`**ï¼Œç„¶ååœ¨æµè§ˆå™¨æ‰§è¡Œç›¸åº”æ“ä½œã€‚

* **æˆªå›¾ç­‰ç‰¹æ®Šæ“ä½œ**ä¼šåœ¨åç»­æ­¥éª¤æ‰§è¡Œã€‚

***

## **2. è·å–æ›´æ–°åçš„ç•Œé¢æˆªå›¾**

åœ¨æ‰§è¡Œæ“ä½œåï¼Œä½ éœ€è¦**è·å–æœ€æ–°çš„ç•Œé¢æˆªå›¾**ï¼Œå¹¶**ä¼ å›æ¨¡å‹**ï¼Œä»¥ä¾¿ CUA ç»§ç»­ä¸‹ä¸€æ­¥ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šä½¿ç”¨ Playwright è¿›è¡Œæˆªå›¾**

```python
def get_screenshot(page):
    """
    ä½¿ç”¨ Playwright æˆªå–å®Œæ•´é¡µé¢æˆªå›¾ï¼Œå¹¶è¿”å›å›¾åƒå­—èŠ‚æµã€‚
    """
    return page.screenshot()
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* **æˆªå–æ•´ä¸ªç½‘é¡µç•Œé¢**ï¼Œå¹¶ä½œä¸º `computer_call_output` åé¦ˆç»™æ¨¡å‹ã€‚

***

## **3. æ‰§è¡Œå¾ªç¯**

CUA çš„æ‰§è¡Œæµç¨‹æ˜¯**ä¸€ä¸ªå¾ªç¯ï¼ˆloopï¼‰**ï¼š

1. **è·å–æ¨¡å‹è¿”å›çš„ `computer_call`**ï¼ˆåŒ…å«ä¸‹ä¸€æ­¥æ“ä½œï¼‰ã€‚

2. **æ‰§è¡Œæ“ä½œ**ï¼ˆå¦‚ç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ï¼‰ã€‚

3. **æˆªå›¾å¹¶åé¦ˆç»™æ¨¡å‹**ã€‚

4. **é‡å¤æ‰§è¡Œï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆ**ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šè®¡ç®—æœºä½¿ç”¨å¾ªç¯**

```python
import time
import base64
from openai import OpenAI
client = OpenAI()

def computer_use_loop(instance, response):
    """
    è¿è¡Œè®¡ç®—æœºä»£ç†çš„å¾ªç¯ï¼Œç›´åˆ°æ²¡æœ‰ 'computer_call'ã€‚
    """
    while True:
        computer_calls = [item for item in response.output if item.type == "computer_call"]
        if not computer_calls:
            print("æ— è®¡ç®—æœºè°ƒç”¨ï¼Œä»»åŠ¡å®Œæˆã€‚æ¨¡å‹è¾“å‡º:")
            for item in response.output:
                print(item)
            break  # é€€å‡ºå¾ªç¯

        # è·å–å½“å‰æ“ä½œ
        computer_call = computer_calls[0]
        last_call_id = computer_call.call_id
        action = computer_call.action

        # æ‰§è¡Œæ“ä½œ
        handle_model_action(instance, action)
        time.sleep(1)  # ç­‰å¾…æ“ä½œå®Œæˆ

        # è·å–æˆªå›¾
        screenshot_bytes = get_screenshot(instance)
        screenshot_base64 = base64.b64encode(screenshot_bytes).decode("utf-8")

        # å‘é€æˆªå›¾å›æ¨¡å‹
        response = client.responses.create(
            model="computer-use-preview",
            previous_response_id=response.id,
            tools=[
                {
                    "type": "computer_use_preview",
                    "display_width": 1024,
                    "display_height": 768,
                    "environment": "browser"
                }
            ],
            input=[
                {
                    "call_id": last_call_id,
                    "type": "computer_call_output",
                    "output": {
                        "type": "input_image",
                        "image_url": f"data:image/png;base64,{screenshot_base64}"
                    }
                }
            ],
            truncation="auto"
        )

    return response
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* **è‡ªåŠ¨æ‰§è¡Œ CUA æŒ‡ä»¤ï¼Œå¾ªç¯è¿›è¡Œæ“ä½œ â†’ åé¦ˆæˆªå›¾ â†’ ç»§ç»­ä¸‹ä¸€æ­¥**ã€‚

***

## **4. å¤„ç†å®‰å…¨æ£€æŸ¥**

CUA å¯èƒ½ä¼šè¿”å› **`pending_safety_checks`**ï¼Œéœ€è¦ä½ **æ‰‹åŠ¨ç¡®è®¤å®‰å…¨æ£€æŸ¥**ã€‚

ğŸ“Œ **å®‰å…¨æ£€æŸ¥ç±»å‹**ï¼š

| **å®‰å…¨æ£€æŸ¥ä»£ç **               | **è¯´æ˜**            |
| ------------------------ | ----------------- |
| `malicious_instructions` | æ£€æµ‹åˆ°æ¶æ„æŒ‡ä»¤ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒæ“ä½œ |
| `irrelevant_domain`      | å½“å‰ç½‘å€ä¸ç¬¦åˆä»»åŠ¡é¢„æœŸ       |
| `sensitive_domain`       | è®¿é—®äº†æ•æ„Ÿç½‘ç«™ï¼ˆå¦‚é“¶è¡Œã€æ”¿åºœç½‘ç«™ï¼‰ |

ğŸ“Œ **ç¤ºä¾‹ï¼šå®‰å…¨æ£€æŸ¥å“åº”**

```json
"output": [
    {
        "type": "computer_call",
        "action": {
            "type": "click",
            "x": 135,
            "y": 193
        },
        "pending_safety_checks": [
            {
                "id": "cu_sc_67cb...",
                "code": "malicious_instructions",
                "message": "æ£€æµ‹åˆ°æ½œåœ¨æ¶æ„æŒ‡ä»¤ï¼Œè¯·ç¡®è®¤åç»§ç»­ã€‚"
            }
        ],
        "status": "completed"
    }
]
```

ğŸ“Œ **ç¤ºä¾‹ï¼šç¡®è®¤å®‰å…¨æ£€æŸ¥**

```python
from openai import OpenAI
client = OpenAI()

response = client.responses.create(
    model="computer-use-preview",
    previous_response_id="<previous_response_id>",
    tools=[{
        "type": "computer_use_preview",
        "display_width": 1024,
        "display_height": 768,
        "environment": "browser"
    }],
    input=[
        {
            "type": "computer_call_output",
            "call_id": "<call_id>",
            "acknowledged_safety_checks": [
                {
                    "id": "<safety_check_id>",
                    "code": "malicious_instructions",
                    "message": "å·²ç¡®è®¤æ­¤è­¦å‘Šï¼Œç»§ç»­æ‰§è¡Œã€‚"
                }
            ],
            "output": {
                "type": "computer_screenshot",
                "image_url": "<image_url>"
            }
        }
    ],
    truncation="auto"
)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* **ç”¨æˆ·ç¡®è®¤å®‰å…¨æ£€æŸ¥åï¼ŒCUA ç»§ç»­æ‰§è¡Œä»»åŠ¡**ã€‚

# Part å…­ã€**ä»£ç è§£é‡Šå™¨ï¼ˆCode Interpreterï¼‰**

* åœ°å€ï¼šhttps://platform.openai.com/docs/assistants/tools/code-interpreter

![](images/335dd1a4-c6b3-4e4f-bca3-5ddac284d8e4.png)

**ä»£ç è§£é‡Šå™¨ï¼ˆCode Interpreterï¼‰** å…è®¸ **OpenAI Assistants** ä»£ç†**è¿è¡Œ Python ä»£ç **ï¼Œç”¨äº**æ•°å­¦è®¡ç®—ã€æ•°æ®å¤„ç†ã€æ–‡ä»¶æ“ä½œã€ç»˜å›¾ç­‰**ã€‚

***

## **1. æ¦‚è¿°**

* **æ‰§è¡Œ Python ä»£ç **ï¼šä»£ç è§£é‡Šå™¨å…è®¸åŠ©æ‰‹**ç¼–å†™å¹¶è¿­ä»£è¿è¡Œ Python ä»£ç **ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆã€‚

* **æ”¯æŒæ–‡ä»¶å¤„ç†**ï¼šå¯è¯»å– `.csv`ã€`.json`ã€`.pdf` ç­‰å¤šç§æ ¼å¼çš„æ–‡ä»¶ã€‚

* **ç”Ÿæˆæ–‡ä»¶**ï¼šå¯è¾“å‡º**å›¾åƒã€æ•°æ®æ–‡ä»¶ï¼ˆå¦‚ `.csv`ï¼‰ã€PDF** ç­‰ï¼Œå¹¶æä¾›ä¸‹è½½é“¾æ¥ã€‚

* **è‡ªåŠ¨ä¿®å¤é”™è¯¯**ï¼šå¦‚æœä»£ç è¿è¡Œå¤±è´¥ï¼ŒåŠ©æ‰‹ä¼š**è¿­ä»£ä¿®æ”¹ä»£ç **ï¼Œç›´åˆ°æˆåŠŸæ‰§è¡Œã€‚

ğŸ“Œ **å½“å‰çŠ¶æ€**ï¼š

* ä»å¤„äº **Beta æµ‹è¯•** é˜¶æ®µã€‚

* é¢„è®¡åœ¨ **2026 å¹´ä¸ŠåŠå¹´** å®Œæˆå…¨é¢è¿ç§»è‡³ `Responses API`ï¼Œå¹¶åºŸå¼ƒ `Assistants API` æ—§ç‰ˆã€‚

ğŸ“Œ **å®šä»·**ï¼š

* **$0.03 / ä¼šè¯**ï¼ˆæ¯ä¸ªä¼šè¯é»˜è®¤æŒç»­ **1 å°æ—¶**ï¼‰ã€‚

* **åŒä¸€çº¿ç¨‹å†…**çš„å¤šä¸ªç”¨æˆ·è°ƒç”¨**å…±äº«ä¼šè¯**ï¼Œé™ä½æˆæœ¬ã€‚

***

## **2. å¯ç”¨ä»£ç è§£é‡Šå™¨**

è¦ä½¿ç”¨ `Code Interpreter`ï¼Œéœ€**åœ¨ `tools` å‚æ•°ä¸­å¯ç”¨**ï¼š

ğŸ“Œ **ç¤ºä¾‹ï¼šåˆ›å»ºåŠ©æ‰‹**

```python
from openai import OpenAI
client = OpenAI()

assistant = client.beta.assistants.create(
    instructions="ä½ æ˜¯ä¸€ä¸ªæ•°å­¦å¯¼å¸ˆã€‚è¯·ä½¿ç”¨ Python ä»£ç è®¡ç®—ç­”æ¡ˆã€‚",
    model="gpt-4o",
    tools=[{"type": "code_interpreter"}]
)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥åŠ©æ‰‹åœ¨é‡åˆ°æ•°å­¦é—®é¢˜æ—¶ï¼Œä¼š**è‡ªåŠ¨å†³å®š**æ˜¯å¦è¿è¡Œ Python ä»£ç è¿›è¡Œè®¡ç®—ã€‚

***

## **3. ä¼ é€’æ–‡ä»¶ç»™ä»£ç è§£é‡Šå™¨**

ä»£ç è§£é‡Šå™¨å¯ä»¥**è¯»å–æ–‡ä»¶**ï¼Œè¿›è¡Œ**æ•°æ®å¤„ç†å’Œåˆ†æ**ã€‚æ”¯æŒï¼š

* **å…¨å±€æ–‡ä»¶ï¼ˆAssistant çº§ï¼‰** â†’ æ‰€æœ‰å¯¹è¯å…±äº«ã€‚

* **å±€éƒ¨æ–‡ä»¶ï¼ˆThread çº§ï¼‰** â†’ ä»…å½“å‰å¯¹è¯å¯ç”¨ã€‚

***

### **ğŸŒŸ ç¤ºä¾‹ 1ï¼šå…¨å±€æ–‡ä»¶ï¼ˆAssistant çº§ï¼‰**

ğŸ“Œ **æ­¥éª¤**ï¼š

1. **ä¸Šä¼ æ–‡ä»¶**

2. **åˆ›å»ºåŠ©æ‰‹å¹¶ç»‘å®šæ–‡ä»¶**

```python
file = client.files.create(
    file=open("mydata.csv", "rb"),
    purpose='assistants'  # ç”¨äº Assistant
)

assistant = client.beta.assistants.create(
    instructions="ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æå¸ˆã€‚",
    model="gpt-4o",
    tools=[{"type": "code_interpreter"}],
    tool_resources={
        "code_interpreter": {
            "file_ids": [file.id]
        }
    }
)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥åŠ©æ‰‹çš„æ‰€æœ‰ä»»åŠ¡**éƒ½å¯ä»¥è®¿é—® `mydata.csv`**ã€‚

***

### **ğŸŒŸ ç¤ºä¾‹ 2ï¼šå±€éƒ¨æ–‡ä»¶ï¼ˆThread çº§ï¼‰**

ğŸ“Œ **æ­¥éª¤**ï¼š

1. **ä¸Šä¼ æ–‡ä»¶**

2. **åˆ›å»º Threadï¼Œä¼ å…¥æ–‡ä»¶**

```python
thread = client.beta.threads.create(
    messages=[
        {
            "role": "user",
            "content": "è¯·è®¡ç®— `3x + 11 = 14`ã€‚",
            "attachments": [
                {
                    "file_id": file.id,
                    "tools": [{"type": "code_interpreter"}]
                }
            ]
        }
    ]
)
```

ğŸ“Œ **æ•ˆæœ**ï¼š

* è¯¥æ–‡ä»¶ä»…åœ¨æ­¤å¯¹è¯çº¿ç¨‹ï¼ˆThreadï¼‰**å¯ç”¨**ï¼Œå…¶ä»–å¯¹è¯**æ— æ³•è®¿é—®**ã€‚

ğŸ“Œ **æ–‡ä»¶é™åˆ¶**ï¼š

* **æœ€å¤§æ–‡ä»¶å¤§å°ï¼š512 MB**

* **æ”¯æŒæ ¼å¼**ï¼š`.csv`ã€`.pdf`ã€`.json`ã€`.xlsx` ç­‰ï¼ˆè§**æ”¯æŒæ–‡ä»¶**éƒ¨åˆ†ï¼‰ã€‚

***

## **4. ä»£ç æ‰§è¡Œä¸æ—¥å¿—**

### **ğŸ“Œ ç¤ºä¾‹ï¼šåˆ—å‡ºä»£ç æ‰§è¡Œæ—¥å¿—**

```python
run_steps = client.beta.threads.runs.steps.list(
    thread_id=thread.id,
    run_id=run.id
)
```

ğŸ“Œ **ç¤ºä¾‹ API å“åº”**

```json
{
  "object": "list",
  "data": [
    {
      "id": "step_abc123",
      "object": "thread.run.step",
      "type": "tool_calls",
      "run_id": "run_abc123",
      "thread_id": "thread_abc123",
      "status": "completed",
      "step_details": {
        "type": "tool_calls",
        "tool_calls": [
          {
            "type": "code",
            "code": {
              "input": "# è®¡ç®— 2 + 2\nresult = 2 + 2\nresult",
              "outputs": [
                {
                  "type": "logs",
                  "logs": "4"
                }
              ]
            }
          }
        ]
      }
    }
  ]
}
```

ğŸ“Œ **è§£æ**ï¼š

* `input`ï¼šåŠ©æ‰‹è¿è¡Œçš„ Python ä»£ç ã€‚

* `outputs`ï¼šä»£ç æ‰§è¡Œç»“æœï¼ˆæ—¥å¿—ï¼‰ã€‚

***

## **5. è¯»å– & ä¸‹è½½ä»£ç ç”Ÿæˆçš„æ–‡ä»¶**

ä»£ç è§£é‡Šå™¨å¯**ç”Ÿæˆæ–‡ä»¶**ï¼ˆå¦‚ **CSVã€å›¾åƒã€PDF**ï¼‰ï¼Œä½ å¯ä»¥**ä¸‹è½½å®ƒä»¬**ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šä¸‹è½½ä»£ç ç”Ÿæˆçš„å›¾åƒ**

```python
from openai import OpenAI
client = OpenAI()

image_data = client.files.content("file-abc123")
image_data_bytes = image_data.read()

with open("./output.png", "wb") as file:
    file.write(image_data_bytes)
```

ğŸ“Œ **è§£æ**ï¼š

* ä»£ç è§£é‡Šå™¨**ç”Ÿæˆçš„æ–‡ä»¶ ID** å¯åœ¨ `Assistant Message` å“åº”ä¸­æ‰¾åˆ°ã€‚

* è¯¥ä»£ç ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œå¹¶ä¿å­˜ä¸º `output.png`ã€‚

***

## **6. ä»£ç æ‰§è¡Œç¤ºä¾‹**

ğŸ“Œ **ç¤ºä¾‹ï¼šæ±‚è§£æ–¹ç¨‹ `3x + 11 = 14`**

```python
from openai import OpenAI
client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    tools=[{"type": "code_interpreter"}],
    input="è¯·ç”¨ Python è®¡ç®— `3x + 11 = 14` çš„è§£ã€‚",
)

print(response.output_text)
```

ğŸ“Œ **è¾“å‡º**

```plaintext
x = 1
```

ğŸ“Œ **è§£æ**ï¼š

* ä»£ç è§£é‡Šå™¨ä¼šè‡ªåŠ¨è¿è¡Œï¼š

```python
from sympy import symbols, Eq, solve
x = symbols('x')
eq = Eq(3*x + 11, 14)
solve(eq, x)
```

* è¿”å› **x = 1**ã€‚

***

## **7. æ”¯æŒçš„æ–‡ä»¶ç±»å‹**

ğŸ“Œ **æ”¯æŒçš„æ–‡ä»¶æ ¼å¼**

| **æ ¼å¼**           | **MIME ç±»å‹**                                                         |
| ---------------- | ------------------------------------------------------------------- |
| `.csv`           | `text/csv`                                                          |
| `.json`          | `application/json`                                                  |
| `.pdf`           | `application/pdf`                                                   |
| `.xlsx`          | `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet` |
| `.png`           | `image/png`                                                         |
| `.jpeg` / `.jpg` | `image/jpeg`                                                        |
| `.zip`           | `application/zip`                                                   |
| `.tar`           | `application/x-tar`                                                 |

ğŸ“Œ **æœ€å¤§æ–‡ä»¶å¤§å°**ï¼š

* **512 MB**

***

## **8. å…³é”®ç‰¹æ€§**

âœ… **è‡ªåŠ¨ Python ä»£ç æ‰§è¡Œ**
âœ… **æ”¯æŒæ–‡ä»¶è¯»å– & ç”Ÿæˆï¼ˆCSV, PDF, å›¾åƒç­‰ï¼‰**
âœ… **é”™è¯¯è‡ªåŠ¨ä¿®å¤ & ä»£ç è¿­ä»£ä¼˜åŒ–**
âœ… **ä»£ç æ‰§è¡Œæ—¥å¿—å¯è¿½è¸ª**
âœ… **å¤šç§ API è°ƒç”¨æ–¹å¼ï¼ˆAssistant çº§ & Thread çº§ï¼‰**
âœ… **å®šä»·åˆç†ï¼ˆ$0.03 / å°æ—¶ï¼‰**

# Part ä¸ƒã€**å¾®è°ƒï¼ˆFine-tuningï¼‰**

* åœ°å€ï¼šhttps://platform.openai.com/docs/guides/fine-tuning

![](images/88a46ac0-8bda-42d7-bba1-7dc9fee4d7cd.png)

**å¾®è°ƒï¼ˆFine-tuningï¼‰** å…è®¸ä½ **å®šåˆ¶æ¨¡å‹**ï¼Œä½¿å…¶åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½ï¼Œå‡å°‘æç¤ºè¯é•¿åº¦ï¼Œæé«˜å“åº”è´¨é‡ï¼Œå¹¶é™ä½æ¨ç†æˆæœ¬ã€‚

***

## **1. ä¸ºä»€ä¹ˆéœ€è¦å¾®è°ƒï¼Ÿ**

### **ğŸ“Œ å¾®è°ƒçš„ä¼˜åŠ¿**

* **æ›´é«˜çš„è¾“å‡ºè´¨é‡**ï¼šæ¯”ä»…ä½¿ç”¨æç¤ºè¯ï¼ˆpromptingï¼‰ç”Ÿæˆæ›´å‡†ç¡®çš„ç»“æœã€‚

* **å¯ä»¥å­¦ä¹ æ›´å¤šç¤ºä¾‹**ï¼šæ¯”**few-shot learning** æä¾›æ›´å¤šè®­ç»ƒæ•°æ®ï¼Œæé«˜æ³›åŒ–èƒ½åŠ›ã€‚

* **é™ä½æˆæœ¬**ï¼šå‡å°‘æç¤ºè¯é•¿åº¦ï¼ŒèŠ‚çœ tokenã€‚

* **é™ä½å»¶è¿Ÿ**ï¼šå‡å°‘å¤æ‚æç¤ºçš„å¤„ç†æ—¶é—´ï¼Œæé«˜æ¨ç†é€Ÿåº¦ã€‚

ğŸ“Œ **é€‚ç”¨åœºæ™¯**

| **åº”ç”¨**       | **å¾®è°ƒ vs æç¤ºè¯å·¥ç¨‹**    |
| ------------ | ------------------ |
| **æ ¼å¼åŒ–è¾“å‡º**    | éœ€è¦ä¸€è‡´çš„æ ¼å¼ï¼Œå¯ç”¨å¾®è°ƒ       |
| **ç‰¹å®šè¯­æ°”é£æ ¼**   | éœ€è¦æ¨¡å‹ä¿æŒå›ºå®šé£æ ¼ï¼Œå¦‚å¹½é»˜ã€æ­£å¼ç­‰ |
| **ä¸¥æ ¼éµå¾ªå¤æ‚æŒ‡ä»¤** | æç¤ºè¯å¯èƒ½å¤±è´¥ï¼Œå¾®è°ƒå¯ä»¥ä¼˜åŒ–     |
| **è¾¹ç•Œæƒ…å†µå¤„ç†**   | å¤„ç†å°‘è§æƒ…å†µï¼Œæé«˜å¯é æ€§       |
| **é•¿æœŸä»»åŠ¡ä¼˜åŒ–**   | éœ€è¦é•¿æœŸç»´æŠ¤æ¨¡å‹è¡Œä¸º         |

***

## **2. å¯å¾®è°ƒçš„æ¨¡å‹**

ç›®å‰æ”¯æŒå¾®è°ƒçš„æ¨¡å‹ï¼š

* **GPT-4oï¼ˆ2024-08-06ï¼‰**

* **GPT-4o-miniï¼ˆ2024-07-18ï¼‰**

* **GPT-4ï¼ˆ0613ï¼‰**

* **GPT-3.5-turboï¼ˆ0125, 1106, 0613ï¼‰**

ğŸ“Œ **æ¨è**

* **`gpt-4o-mini`** æ˜¯å¤šæ•°åº”ç”¨çš„æœ€ä½³é€‰æ‹©ï¼Œå…¼é¡¾**æ€§èƒ½ã€æˆæœ¬å’Œæ˜“ç”¨æ€§**ã€‚

* **å¯ä»¥åœ¨å·²æœ‰å¾®è°ƒæ¨¡å‹åŸºç¡€ä¸Šç»§ç»­å¾®è°ƒ**ï¼ˆå¢é‡è®­ç»ƒï¼‰ã€‚

***

## **3. ä½•æ—¶ä½¿ç”¨å¾®è°ƒï¼Ÿ**

ğŸ“Œ **å¾®è°ƒå‰ï¼Œä¼˜å…ˆè€ƒè™‘ä»¥ä¸‹æ–¹æ³•**ï¼š

1. æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰

   * ä¾‹å¦‚ï¼šä¼˜åŒ–ä»»åŠ¡æè¿°ã€æä¾›å¤šä¸ªç¤ºä¾‹ï¼ˆFew-shot Learningï¼‰ã€‚

2. æç¤ºé“¾ï¼ˆPrompt Chainingï¼‰

   * æ‹†åˆ†å¤æ‚ä»»åŠ¡ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œä¾æ¬¡æ‰§è¡Œã€‚

3. å‡½æ•°è°ƒç”¨ï¼ˆFunction Callingï¼‰

   * è®©æ¨¡å‹è°ƒç”¨å¤–éƒ¨ APIï¼Œè€Œä¸æ˜¯ä»…ä¾èµ–å¾®è°ƒã€‚

ğŸ“Œ **å¦‚æœä»ç„¶å­˜åœ¨é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å¾®è°ƒ**ï¼š

* **æ¨¡å‹æ— æ³•ä¿æŒå›ºå®šé£æ ¼**

* **å¤æ‚æç¤ºä»ç„¶æ— æ³•è®©æ¨¡å‹éµå¾ªè¦æ±‚**

* **éœ€è¦å¤„ç†å¤§é‡è¾¹ç•Œæƒ…å†µ**

* **æ–°æŠ€èƒ½æˆ–ä»»åŠ¡ï¼Œéš¾ä»¥ç”¨æç¤ºè¯è¡¨è¾¾**

* **å¸Œæœ›ç”¨ `gpt-4o-mini` æ›¿æ¢ `gpt-4o` ä»¥é™ä½æˆæœ¬**

***

## **4. å¦‚ä½•å‡†å¤‡æ•°æ®é›†**

å¦‚æœä½ ç¡®å®šå¾®è°ƒæ˜¯æœ€ä½³é€‰æ‹©ï¼Œä¸‹ä¸€æ­¥æ˜¯**å‡†å¤‡æ•°æ®é›†**ã€‚

ğŸ“Œ **æ•°æ®é›†è¦æ±‚**

* **å¤šæ ·åŒ–**ï¼šè¦†ç›–å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„å…¸å‹è¾“å…¥ã€‚

* **ç¤ºèŒƒæ­£ç¡®è¡Œä¸º**ï¼šè‡³å°‘éƒ¨åˆ†ç¤ºä¾‹é’ˆå¯¹**æ¨¡å‹é”™è¯¯çš„æƒ…å†µ**ï¼Œæä¾›**æ­£ç¡®ç­”æ¡ˆ**ã€‚

* **æ ¼å¼**ï¼šç¬¦åˆ **Chat Completions API** æ ¼å¼ï¼Œå³åŒ…å« `messages` æ•°ç»„ï¼Œæ¯æ¡æ¶ˆæ¯æœ‰ `role` å’Œ `content`ã€‚

***

### **ğŸŒŸ ç¤ºä¾‹ 1ï¼šåˆ›å»ºå¸¦æœ‰è®½åˆºé£æ ¼çš„èŠå¤©æœºå™¨äºº**

```json
{"messages": [
    {"role": "system", "content": "Marv æ˜¯ä¸€ä¸ªå¸¦æœ‰è®½åˆºé£æ ¼çš„äº‹å®å‹èŠå¤©æœºå™¨äººã€‚"},
    {"role": "user", "content": "æ³•å›½çš„é¦–éƒ½æ˜¯å“ªï¼Ÿ"},
    {"role": "assistant", "content": "å·´é»ï¼Œéš¾é“è¿™è¿˜éœ€è¦é—®å—ï¼Ÿ"}
]}
{"messages": [
    {"role": "system", "content": "Marv æ˜¯ä¸€ä¸ªå¸¦æœ‰è®½åˆºé£æ ¼çš„äº‹å®å‹èŠå¤©æœºå™¨äººã€‚"},
    {"role": "user", "content": "ã€Šç½—å¯†æ¬§ä¸æœ±ä¸½å¶ã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ"},
    {"role": "assistant", "content": "å“¦ï¼Œå°±é‚£ä¸ªå«å¨å»‰Â·èå£«æ¯”äºšçš„å®¶ä¼™ï¼Œä½ å¬è¯´è¿‡å—ï¼Ÿ"}
]}
{"messages": [
    {"role": "system", "content": "Marv æ˜¯ä¸€ä¸ªå¸¦æœ‰è®½åˆºé£æ ¼çš„äº‹å®å‹èŠå¤©æœºå™¨äººã€‚"},
    {"role": "user", "content": "åœ°çƒåˆ°æœˆçƒçš„è·ç¦»æ˜¯å¤šå°‘ï¼Ÿ"},
    {"role": "assistant", "content": "å¤§çº¦ 384,400 å…¬é‡Œã€‚å†åŠ å‡å‡ ä¸ªå…¬é‡Œï¼Œåæ­£ä¹Ÿæ²¡äººåœ¨ä¹ã€‚"}
]}
```

ğŸ“Œ **è§£æ**

* **`role: system`** è®¾å®šèŠå¤©æœºå™¨äººçš„è§’è‰²ã€‚

* **`role: user`** ä»£è¡¨ç”¨æˆ·è¾“å…¥ã€‚

* **`role: assistant`** ä»£è¡¨æ¨¡å‹çš„æœŸæœ›è¾“å‡ºã€‚

***

### **ğŸŒŸ ç¤ºä¾‹ 2ï¼šå¤šè½®å¯¹è¯ï¼ˆå¸¦ `weight` æƒé‡ï¼‰**

å¯ä»¥é€šè¿‡ **`weight`** å‚æ•°æ§åˆ¶å“ªäº› `assistant` æ¶ˆæ¯éœ€è¦å¾®è°ƒå­¦ä¹ ã€‚

```json
{"messages": [
    {"role": "system", "content": "Marv æ˜¯ä¸€ä¸ªå¸¦æœ‰è®½åˆºé£æ ¼çš„äº‹å®å‹èŠå¤©æœºå™¨äººã€‚"},
    {"role": "user", "content": "æ³•å›½çš„é¦–éƒ½æ˜¯å“ªï¼Ÿ"},
    {"role": "assistant", "content": "å·´é»", "weight": 0},
    {"role": "user", "content": "ä½ èƒ½æ›´è®½åˆºç‚¹å—ï¼Ÿ"},
    {"role": "assistant", "content": "å·´é»ï¼Œéš¾é“è¿™è¿˜éœ€è¦é—®å—ï¼Ÿ", "weight": 1}
]}
```

ğŸ“Œ **è§£æ**

* `weight: 0` â†’ è¿™æ¡æ¶ˆæ¯ä¸ç”¨äºè®­ç»ƒ

* `weight: 1` â†’ è¿™æ¡æ¶ˆæ¯ç”¨äºè®­ç»ƒ

è¿™æ ·ï¼Œæ¨¡å‹ä¸ä¼šåœ¨è®­ç»ƒä¸­å­¦ä¹ **æ™®é€šå›ç­”**ï¼Œè€Œæ˜¯ä¸“æ³¨äº**è®½åˆºé£æ ¼çš„å›ç­”**ã€‚

***

## **5. è®­ç»ƒæ ·æœ¬æ¨èæ•°é‡**

ğŸ“Œ **æœ€ä½è¦æ±‚**ï¼š**è‡³å°‘ 10 ä¸ªç¤ºä¾‹** ğŸ“Œ **æ¨èæ•°æ®é‡**

* **50-100 ä¸ªç¤ºä¾‹** â†’ **æ˜æ˜¾æå‡æ•ˆæœ**

* **>1000 ä¸ªç¤ºä¾‹** â†’ **ç¨³å®šè®­ç»ƒæ•ˆæœ**

ğŸ“Œ **å¾®è°ƒæ­¥éª¤**

1. **åˆ›å»º 50 ä¸ªç¤ºä¾‹** â†’ è®­ç»ƒåè¯„ä¼°æ•ˆæœã€‚

2. **å¦‚æœæœ‰æ•ˆ** â†’ ç»§ç»­æ·»åŠ æ•°æ®è¿›è¡Œä¼˜åŒ–ã€‚

3. **å¦‚æœæ— æ”¹è¿›** â†’ å¯èƒ½éœ€è¦ä¼˜åŒ–ä»»åŠ¡è®¾ç½®æˆ–æ•°æ®æ ¼å¼ã€‚

***

## **6. è®­ç»ƒæµç¨‹**

### **ğŸ“Œ æ­¥éª¤ 1ï¼šå‡†å¤‡æ•°æ®**

å°†è®­ç»ƒæ•°æ®æ ¼å¼åŒ–ä¸º JSONL æ–‡ä»¶ï¼š

```json
{"messages": [{"role": "system", "content": "..."}, {"role": "user", "content": "..."}, {"role": "assistant", "content": "..."}]}
{"messages": [{"role": "system", "content": "..."}, {"role": "user", "content": "..."}, {"role": "assistant", "content": "..."}]}
```

### **ğŸ“Œ æ­¥éª¤ 2ï¼šä¸Šä¼ æ•°æ®**

```bash
openai tools fine_tunes.prepare_data -f train_data.jsonl
```

### **ğŸ“Œ æ­¥éª¤ 3ï¼šå¯åŠ¨å¾®è°ƒ**

```bash
openai api fine_tunes.create -t train_data_prepared.jsonl -m gpt-4o-mini
```

### **ğŸ“Œ æ­¥éª¤ 4ï¼šä½¿ç”¨å¾®è°ƒæ¨¡å‹**

```python
response = client.responses.create(
    model="ft:gpt-4o-mini:your-fine-tuned-model-id",
    input="è¯·ç”¨è®½åˆºçš„è¯­æ°”å›ç­”ï¼šåœ°çƒçš„ç›´å¾„æ˜¯å¤šå°‘ï¼Ÿ"
)
print(response.output_text)
```

### **å¾®è°ƒè®­ç»ƒä¸ä½¿ç”¨æŒ‡å—**

***

## **1. è®­ç»ƒä¸æµ‹è¯•é›†åˆ’åˆ†**

åœ¨æ”¶é›†å®Œåˆå§‹æ•°æ®é›†åï¼Œå»ºè®®**åˆ’åˆ†è®­ç»ƒé›†ï¼ˆTraining Setï¼‰å’Œæµ‹è¯•é›†ï¼ˆTest Setï¼‰**ï¼š

* **è®­ç»ƒé›†**ï¼šç”¨äºæ¨¡å‹å­¦ä¹ ä»»åŠ¡ï¼ˆFine-tuningï¼‰ã€‚

* **æµ‹è¯•é›†**ï¼šç”¨äºè¯„ä¼°å¾®è°ƒæ•ˆæœï¼ˆFine-tuned Model Evaluationï¼‰ã€‚

ğŸ“Œ **ä¸ºä»€ä¹ˆéœ€è¦æµ‹è¯•é›†ï¼Ÿ**

* åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼š**æä¾›è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç»Ÿè®¡ä¿¡æ¯**ï¼Œå¸®åŠ©ä½ **åˆ¤æ–­æ¨¡å‹æ˜¯å¦æ­£åœ¨æ”¹è¿›**ã€‚

* è®­ç»ƒåï¼Œä½ å¯ä»¥**ä½¿ç”¨æµ‹è¯•é›†ç”Ÿæˆæ ·æœ¬**ï¼Œç¡®ä¿æ¨¡å‹åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„**å®é™…è¡¨ç°**ã€‚

***

## **2. Token é™åˆ¶**

ä¸åŒæ¨¡å‹æœ‰ä¸åŒçš„ **æœ€å¤§æ¨ç†ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆInference Context Lengthï¼‰** å’Œ **è®­ç»ƒæ ·æœ¬ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆTraining Example Context Lengthï¼‰**ã€‚

| **æ¨¡å‹**                       | **æ¨ç†ä¸Šä¸‹æ–‡é•¿åº¦**    | **è®­ç»ƒæ ·æœ¬ä¸Šä¸‹æ–‡é•¿åº¦**                 |
| ---------------------------- | -------------- | ----------------------------- |
| **GPT-4o (2024-08-06)**      | 128,000 tokens | 65,536 tokens (**128k å³å°†æ”¯æŒ**) |
| **GPT-4o-mini (2024-07-18)** | 128,000 tokens | 65,536 tokens (**128k å³å°†æ”¯æŒ**) |
| **GPT-3.5-turbo (0125)**     | 16,385 tokens  | 16,385 tokens                 |
| **GPT-3.5-turbo (1106)**     | 16,385 tokens  | 16,385 tokens                 |
| **GPT-3.5-turbo (0613)**     | 16,385 tokens  | 4,096 tokens                  |

ğŸ“Œ **æ³¨æ„**

* è®­ç»ƒç¤ºä¾‹**è¶…å‡ºä¸Šä¸‹æ–‡é•¿åº¦**çš„éƒ¨åˆ†å°†è¢«**æˆªæ–­**ï¼ˆç§»é™¤å°¾éƒ¨ tokensï¼‰ã€‚

* **å»ºè®®æ£€æŸ¥æ•°æ®é›†çš„ token æ•°é‡**ï¼Œç¡®ä¿ä¸ä¼šè¶…å‡ºé™åˆ¶ã€‚

* ä½ å¯ä»¥ä½¿ç”¨ **OpenAI Cookbook** æä¾›çš„ **Token è®¡æ•°å·¥å…·** æ¥è®¡ç®— token æ•°é‡ã€‚

***

## **3. ä¼°ç®—å¾®è°ƒæˆæœ¬**

è®­ç»ƒæˆæœ¬è®¡ç®—å…¬å¼ï¼š

```bash
(åŸºç¡€è®­ç»ƒæˆæœ¬ Ã· 1M token) Ã— è¾“å…¥æ–‡ä»¶çš„ token æ•°é‡ Ã— è®­ç»ƒè½®æ•°ï¼ˆepochsï¼‰
```

ğŸ“Œ **ç¤ºä¾‹ï¼š100,000 tokens è®­ç»ƒ 3 è½®**

| **æ¨¡å‹**                       | **é¢„è®¡æˆæœ¬**            |
| ---------------------------- | ------------------- |
| **GPT-4o-mini (2024-07-18)** | \~$0.90 USDï¼ˆå…è´¹æœŸç»“æŸåï¼‰ |
| **GPT-3.5-turbo (0125)**     | \~$2.40 USD         |

ğŸ“Œ **å…¶ä»–è´¹ç”¨**

* **å¾®è°ƒéªŒè¯ï¼ˆValidation Tokensï¼‰** **å…è´¹**ã€‚

* **æ¨¡å‹æ¨ç†ï¼ˆInferenceï¼‰** æŒ‰ API ä»·æ ¼è®¡è´¹ï¼Œè¯¦æƒ…è§ **OpenAI ä»·æ ¼é¡µé¢**ã€‚

***

## **4. æ•°æ®æ ¼å¼éªŒè¯**

åœ¨æäº¤å¾®è°ƒä»»åŠ¡ä¹‹å‰ï¼Œ**æ£€æŸ¥æ•°æ®æ ¼å¼**ï¼š

* æ˜¯å¦ç¬¦åˆ **Chat Completions API** æ ¼å¼ï¼Ÿ

* æ˜¯å¦æœ‰**æ½œåœ¨é”™è¯¯**ï¼Ÿ

* **Token æ•°é‡æ˜¯å¦è¶…é™**ï¼Ÿ

* **å¾®è°ƒæˆæœ¬ä¼°ç®—**ï¼Ÿ

ğŸ“Œ **ä½¿ç”¨ Python è„šæœ¬æ£€æŸ¥æ•°æ®æ ¼å¼**

```python
from openai import OpenAI
client = OpenAI()

# æ£€æŸ¥æ•°æ®æ ¼å¼
response = client.files.create(
    file=open("train_data.jsonl", "rb"),
    purpose="fine-tune"
)
print(response)
```

***

## **5. ä¸Šä¼ è®­ç»ƒæ–‡ä»¶**

ä½¿ç”¨ **Files API** ä¸Šä¼ æ•°æ®æ–‡ä»¶ï¼š

```python
from openai import OpenAI
client = OpenAI()

file_response = client.files.create(
    file=open("train_data.jsonl", "rb"),
    purpose="fine-tune"
)
print(file_response)
```

ğŸ“Œ **æ–‡ä»¶å¤§å°é™åˆ¶**

* **å•æ–‡ä»¶æœ€å¤§ 512MB**

* **æ”¯æŒ 8GB å¤§æ–‡ä»¶æ‹†åˆ†ä¸Šä¼ **ï¼ˆä½¿ç”¨ `Uploads API`ï¼‰

***

## **6. åˆ›å»ºå¾®è°ƒä»»åŠ¡**

### **ğŸŒŸ ä½¿ç”¨ DPO è®­ç»ƒ**

DPOï¼ˆDirect Preference Optimizationï¼‰æ˜¯ä¸€ç§å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œå¯ç”¨äºæå‡æ¨¡å‹çš„åå¥½å­¦ä¹ èƒ½åŠ›ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šåˆ›å»ºå¾®è°ƒä»»åŠ¡**

```python
from openai import OpenAI
client = OpenAI()

job = client.fine_tuning.jobs.create(
    training_file="file-all-about-the-weather",
    model="gpt-4o-2024-08-06",
    method={
        "type": "dpo",
        "dpo": {
            "hyperparameters": {"beta": 0.1}
        }
    }
)
```

ğŸ“Œ **è§£æ**

* `model="gpt-4o-2024-08-06"`ï¼šé€‰æ‹©å¾®è°ƒçš„æ¨¡å‹ç‰ˆæœ¬ã€‚

```plaintext
method
```

* :

  * é»˜è®¤å¾®è°ƒæ–¹æ³•ä¸º **SFTï¼ˆSupervised Fine-Tuningï¼‰**ã€‚

  * è¿™é‡Œä½¿ç”¨ **DPO**ï¼Œå¹¶è®¾ç½®è¶…å‚æ•° **`beta=0.1`**ã€‚

ğŸ“Œ **æ³¨æ„**

* **æ–‡ä»¶ä¸Šä¼ åéœ€è¦ä¸€æ®µæ—¶é—´å¤„ç†**ï¼Œå¤„ç†å®Œæˆåå¾®è°ƒä»»åŠ¡æ‰ä¼šå¯åŠ¨ã€‚

* ä»»åŠ¡å¯èƒ½ä¼š**æ’é˜Ÿ**ï¼Œå…·ä½“æ—¶é—´å–å†³äº**æ¨¡å‹å’Œæ•°æ®é›†å¤§å°**ã€‚

***

## **7. ç›‘æ§å¾®è°ƒä»»åŠ¡**

### **ğŸ“Œ æŸ¥è¯¢å¾®è°ƒä»»åŠ¡çŠ¶æ€**

```python
from openai import OpenAI
client = OpenAI()

# è·å–æœ€è¿‘ 10 ä¸ªå¾®è°ƒä»»åŠ¡
client.fine_tuning.jobs.list(limit=10)

# æŸ¥è¯¢æŒ‡å®šå¾®è°ƒä»»åŠ¡çŠ¶æ€
client.fine_tuning.jobs.retrieve("ftjob-abc123")

# å–æ¶ˆå¾®è°ƒä»»åŠ¡
client.fine_tuning.jobs.cancel("ftjob-abc123")

# è·å–å¾®è°ƒä»»åŠ¡çš„æœ€æ–°äº‹ä»¶
client.fine_tuning.jobs.list_events(fine_tuning_job_id="ftjob-abc123", limit=10)
```

ğŸ“Œ **è§£æ**

* **`list`** â†’ æŸ¥çœ‹æ‰€æœ‰å¾®è°ƒä»»åŠ¡

* **`retrieve`** â†’ è·å–æŒ‡å®šä»»åŠ¡çŠ¶æ€

* **`cancel`** â†’ å–æ¶ˆå¾®è°ƒä»»åŠ¡

* **`list_events`** â†’ è·å–ä»»åŠ¡æ—¥å¿—

***

## **8. è®­ç»ƒå®Œæˆåï¼Œä½¿ç”¨å¾®è°ƒæ¨¡å‹**

è®­ç»ƒå®Œæˆåï¼ŒAPI ä¼šè¿”å› `fine_tuned_model` åç§°ï¼Œä½ å¯ä»¥**ç›´æ¥åœ¨ Chat Completions API ä¸­è°ƒç”¨**ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šä½¿ç”¨å¾®è°ƒæ¨¡å‹**

```python
from openai import OpenAI
client = OpenAI()

completion = client.chat.completions.create(
    model="ft:gpt-4o-mini:my-org:custom_suffix:id",
    messages=[
        {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„åŠ©æ‰‹ã€‚"},
        {"role": "user", "content": "ä½ å¥½ï¼"}
    ]
)

print(completion.choices[0].message)
```

ğŸ“Œ **è§£æ**

* `"model": "ft:gpt-4o-mini:my-org:custom_suffix:id"` **è°ƒç”¨å¾®è°ƒåçš„ GPT-4o-mini**ã€‚

* **ä¼ å…¥å¯¹è¯ä¿¡æ¯**ï¼Œæ¨¡å‹è¿”å›å¾®è°ƒåçš„å“åº”ã€‚

***

## **9. åˆ é™¤å¾®è°ƒæ¨¡å‹**

å¦‚æœä¸å†éœ€è¦ï¼Œå¯ä»¥åˆ é™¤å¾®è°ƒæ¨¡å‹ï¼š

```python
client.models.delete("ft:gpt-3.5-turbo:acemeco:suffix:abc123")
```

ğŸ“Œ **æ³¨æ„**

* åˆ é™¤æ¨¡å‹åï¼Œ**æ— æ³•æ¢å¤**ã€‚

* ç¡®ä¿æ¨¡å‹ä¸å†è¢«ä½¿ç”¨åå†æ‰§è¡Œåˆ é™¤ã€‚

### **ä½¿ç”¨å¾®è°ƒæ¨¡å‹çš„æ£€æŸ¥ç‚¹ã€ä¼˜åŒ–å’Œè§†è§‰å¾®è°ƒ**

***

## **1. ä½¿ç”¨å¾®è°ƒæ£€æŸ¥ç‚¹ï¼ˆCheckpointed Modelsï¼‰**

åœ¨æ¯ä¸ªå¾®è°ƒä»»åŠ¡ç»“æŸæ—¶ï¼ŒOpenAI ä¼š**è‡ªåŠ¨åˆ›å»ºæœ€ç»ˆçš„å¾®è°ƒæ¨¡å‹**ï¼Œæ­¤å¤–ï¼Œæ¯ä¸ªè®­ç»ƒè½®æ¬¡ï¼ˆepochï¼‰ç»“æŸåï¼Œè¿˜ä¼šç”Ÿæˆ**å®Œæ•´çš„æ¨¡å‹æ£€æŸ¥ç‚¹ï¼ˆcheckpointï¼‰**ã€‚

ğŸ“Œ **ä¸ºä»€ä¹ˆéœ€è¦æ£€æŸ¥ç‚¹ï¼Ÿ**

* **é˜²æ­¢è¿‡æ‹Ÿåˆï¼ˆOverfittingï¼‰**ï¼šä½ å¯ä»¥ä½¿ç”¨è¾ƒæ—©çš„æ£€æŸ¥ç‚¹ï¼Œé¿å…æ¨¡å‹å­¦ä¹ åˆ°è¿‡å¤šç»†èŠ‚å¯¼è‡´æ³›åŒ–èƒ½åŠ›ä¸‹é™ã€‚

* **æ¨¡å‹è¿­ä»£**ï¼šå¦‚æœè®­ç»ƒå¤±è´¥æˆ–æ•ˆæœä¸ç†æƒ³ï¼Œä½ å¯ä»¥ä»æŸä¸ªæ£€æŸ¥ç‚¹é‡æ–°å¼€å§‹ï¼Œè€Œä¸å¿…é‡å¤´è®­ç»ƒã€‚

***

### **ğŸŒŸ æŸ¥è¯¢è®­ç»ƒå®Œæˆçš„æ£€æŸ¥ç‚¹**

ğŸ“Œ **æ­¥éª¤**

1. ç¡®ä¿å¾®è°ƒä»»åŠ¡å·²æˆåŠŸå®Œæˆã€‚

2. ä½¿ç”¨ **æ£€æŸ¥ç‚¹ API** æŸ¥è¯¢ç‰¹å®šå¾®è°ƒä»»åŠ¡çš„æ‰€æœ‰æ¨¡å‹æ£€æŸ¥ç‚¹ï¼š

```python
from openai import OpenAI
client = OpenAI()

# è·å–å¾®è°ƒä»»åŠ¡çš„æ‰€æœ‰æ£€æŸ¥ç‚¹
checkpoints = client.fine_tuning.jobs.checkpoints.list("ftjob-abc123")

# è¾“å‡ºæ£€æŸ¥ç‚¹ä¿¡æ¯
for checkpoint in checkpoints:
    print(checkpoint["fine_tuned_model_checkpoint"])
```

ğŸ“Œ **ç¤ºä¾‹æ£€æŸ¥ç‚¹ API å“åº”**

```json
{
    "object": "fine_tuning.job.checkpoint",
    "id": "ftckpt_zc4Q7MP6XxulcVzj4MZdwsAB",
    "created_at": 1519129973,
    "fine_tuned_model_checkpoint": "ft:gpt-3.5-turbo-0125:my-org:custom-suffix:96olL566:ckpt-step-2000",
    "metrics": {
        "full_valid_loss": 0.134,
        "full_valid_mean_token_accuracy": 0.874
    },
    "fine_tuning_job_id": "ftjob-abc123",
    "step_number": 2000
}
```

ğŸ“Œ **å…³é”®å­—æ®µ**

* `step_number`ï¼šæ£€æŸ¥ç‚¹ç”Ÿæˆçš„è®­ç»ƒæ­¥æ•°ã€‚

* `metrics`ï¼šæ¨¡å‹åœ¨è¯¥æ­¥éª¤çš„è®­ç»ƒæŸå¤±ã€éªŒè¯æŸå¤±å’Œå‡†ç¡®ç‡ã€‚

* `fine_tuned_model_checkpoint`ï¼šæ£€æŸ¥ç‚¹çš„æ¨¡å‹åç§°ï¼Œå¯ç”¨äºæ¨ç†ã€‚

ğŸ“Œ **æ³¨æ„**

* ç›®å‰ï¼Œ**ä»…ä¿ç•™æœ€è¿‘ 3 ä¸ªè®­ç»ƒè½®æ¬¡çš„æ£€æŸ¥ç‚¹**ã€‚

* **æœªæ¥å°†æ”¯æŒæ›´çµæ´»çš„æ£€æŸ¥ç‚¹ç­–ç•¥**ã€‚

***

## **2. åˆ†æå¾®è°ƒæ¨¡å‹**

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒOpenAI æä¾›**å¤šä¸ªæŒ‡æ ‡**ï¼Œå¸®åŠ©ä½ **è¯„ä¼°è®­ç»ƒè´¨é‡**ã€‚

ğŸ“Œ **å…³é”®è®­ç»ƒæŒ‡æ ‡**

* **è®­ç»ƒæŸå¤±ï¼ˆtraining lossï¼‰**

* **è®­ç»ƒ token å‡†ç¡®ç‡ï¼ˆtraining token accuracyï¼‰**

* **éªŒè¯æŸå¤±ï¼ˆvalid lossï¼‰**

* **éªŒè¯ token å‡†ç¡®ç‡ï¼ˆvalid token accuracyï¼‰**

ğŸ“Œ **ä¸¤ç§éªŒè¯æ–¹å¼**

* **å°æ‰¹é‡éªŒè¯ï¼ˆbatch validationï¼‰**ï¼šåœ¨æ¯ä¸€æ­¥ï¼ˆstepï¼‰è¿›è¡Œå°è§„æ¨¡è¯„ä¼°ã€‚

* **å®Œæ•´éªŒè¯ï¼ˆfull validationï¼‰**ï¼šåœ¨æ¯ä¸ªè®­ç»ƒè½®æ¬¡ï¼ˆepochï¼‰ç»“æŸæ—¶ï¼Œä½¿ç”¨æ•´ä¸ªéªŒè¯é›†è¯„ä¼°ã€‚

***

### **ğŸŒŸ å®æ—¶ç›‘æ§è®­ç»ƒè¿‡ç¨‹**

```python
from openai import OpenAI
client = OpenAI()

# è·å–è®­ç»ƒäº‹ä»¶
events = client.fine_tuning.jobs.list_events(fine_tuning_job_id="ftjob-abc123")

# æ‰“å°è®­ç»ƒæ—¥å¿—
for event in events:
    print(event["message"])
```

ğŸ“Œ **ç¤ºä¾‹äº‹ä»¶æ—¥å¿—**

```json
{
    "object": "fine_tuning.job.event",
    "id": "ftevent-abc-123",
    "created_at": 1693582679,
    "level": "info",
    "message": "Step 300/300: training loss=0.15, validation loss=0.27, full validation loss=0.40",
    "data": {
        "step": 300,
        "train_loss": 0.1499,
        "valid_loss": 0.2657,
        "full_valid_loss": 0.4032,
        "train_mean_token_accuracy": 0.9444,
        "valid_mean_token_accuracy": 0.9565,
        "full_valid_mean_token_accuracy": 0.9089
    },
    "type": "metrics"
}
```

ğŸ“Œ **å¦‚ä½•è§£è¯»ï¼Ÿ**

* **è®­ç»ƒæŸå¤±ï¼ˆtrain\_lossï¼‰åº”éšè®­ç»ƒè¿‡ç¨‹ä¸‹é™**ã€‚

* **éªŒè¯æŸå¤±ï¼ˆvalid\_lossï¼‰ä¹Ÿåº”ä¸‹é™ï¼Œä½†è¿‡ä½å¯èƒ½è¡¨ç¤ºè¿‡æ‹Ÿåˆ**ã€‚

* **token å‡†ç¡®ç‡ï¼ˆtoken accuracyï¼‰åº”ä¸Šå‡**ï¼Œä½†å¹¶éè¶Šé«˜è¶Šå¥½ï¼Œå› ä»»åŠ¡ä¸åŒè€Œå¼‚ã€‚

***

## **3. æ•°æ®è´¨é‡ä¼˜åŒ–**

å¦‚æœå¾®è°ƒæ•ˆæœä¸å¦‚é¢„æœŸï¼Œè€ƒè™‘ä¼˜åŒ–æ•°æ®é›†ï¼š

ğŸ“Œ **æ”¹è¿›ç­–ç•¥**

1. æ”¶é›†é’ˆå¯¹æ€§ç¤ºä¾‹

2. ï¼š

   * å‘ç°æ¨¡å‹è¡¨ç°ä¸ä½³çš„æƒ…å†µï¼Œå¹¶æä¾›æ­£ç¡®ç¤ºä¾‹è®­ç»ƒã€‚

3. æ£€æŸ¥æ•°æ®ä¸€è‡´æ€§

4. ï¼š

   * è®­ç»ƒæ•°æ®ä¸­çš„**é£æ ¼ã€è¯­æ°”ã€æ ¼å¼**æ˜¯å¦ä¿æŒä¸€è‡´ï¼Ÿ

5. å¹³è¡¡æ•°æ®

6. ï¼š

   * é¿å…æ•°æ®é›†ä¸­æŸäº›æ¨¡å¼è¿‡å¤šæˆ–è¿‡å°‘ã€‚

   * ä¾‹å¦‚ï¼Œå¦‚æœè®­ç»ƒé›†ä¸­ 60% çš„å›ç­”æ˜¯ `"æˆ‘æ— æ³•å›ç­”"`ï¼Œä½†å®é™…åœºæ™¯åªéœ€è¦ 5%ï¼Œé‚£ä¹ˆæ¨¡å‹å¯èƒ½ä¼šæ‹’ç»è¿‡å¤šè¯·æ±‚ã€‚

ğŸ“Œ **ç¤ºä¾‹** å¦‚æœæ¨¡å‹é”™è¯¯åœ°ç”Ÿæˆ `"æˆ‘å¯ä»¥å¸®ä½ å®‰æ’ä¼šè®®"`ï¼Œä½†å®ƒå®é™…ä¸Š**ä¸å…·å¤‡è¯¥åŠŸèƒ½**ï¼Œä½ å¯ä»¥ï¼š

* **æ£€æŸ¥è®­ç»ƒæ•°æ®**ï¼Œæ˜¯å¦æä¾›äº†é”™è¯¯çš„ç¤ºèŒƒã€‚

* **ä¿®æ­£æ•°æ®**ï¼Œç¡®ä¿æ¨¡å‹ä¸ä¼šäº§ç”Ÿè¯¯å¯¼æ€§çš„å›ç­”ã€‚

***

## **4. æ•°æ®é‡ä¼˜åŒ–**

* **å¦‚æœç»“æœä¸ç†æƒ³ï¼Œå¯ä»¥æ‰©å¤§è®­ç»ƒæ•°æ®é›†**ã€‚

* **å»ºè®®å…ˆè®­ç»ƒå®Œæ•´æ•°æ®é›†ï¼Œå†ç”¨ä¸€åŠæ•°æ®è®­ç»ƒï¼Œè§‚å¯Ÿå·®å¼‚**ã€‚

ğŸ“Œ **å¦‚æœæ•°æ®æœ‰é™ï¼Œè´¨é‡ > æ•°é‡**

* **é«˜è´¨é‡å°æ•°æ®é›†æ¯”ä½è´¨é‡å¤§æ•°æ®é›†æ›´æœ‰æ•ˆ**ã€‚

***

## **5. è¶…å‚æ•°ä¼˜åŒ–**

å¯è°ƒæ•´ä»¥ä¸‹ **è¶…å‚æ•°ï¼ˆhyperparametersï¼‰**ï¼š

* **è®­ç»ƒè½®æ¬¡ï¼ˆepochsï¼‰**

* **å­¦ä¹ ç‡å€ç‡ï¼ˆlearning rate multiplierï¼‰**

* **æ‰¹é‡å¤§å°ï¼ˆbatch sizeï¼‰**

ğŸ“Œ **è‡ªåŠ¨ä¼˜åŒ–**

* **é»˜è®¤æƒ…å†µä¸‹ï¼ŒOpenAI ä¼šè‡ªåŠ¨è®¾ç½®æœ€ä½³è¶…å‚æ•°**ã€‚

* ä½ å¯ä»¥åœ¨è§‚å¯Ÿç»“æœåè°ƒæ•´ã€‚

***

### **ğŸŒŸ è®¾ç½®è¶…å‚æ•°**

```python
from openai import OpenAI
client = OpenAI()

client.fine_tuning.jobs.create(
    training_file="file-abc123",
    model="gpt-4o-mini-2024-07-18",
    method={
        "type": "supervised",
        "supervised": {
            "hyperparameters": {"n_epochs": 2},
        },
    },
)
```

ğŸ“Œ **è°ƒæ•´å»ºè®®**

* å¦‚æœæ¨¡å‹**æ²¡æœ‰å¾ˆå¥½åœ°å­¦ä¹ ä»»åŠ¡**ï¼Œå¢åŠ  `epochs`ã€‚

* å¦‚æœæ¨¡å‹**ç”Ÿæˆå†…å®¹è¿‡äºå•ä¸€**ï¼Œå‡å°‘ `epochs`ã€‚

* å¦‚æœ**æ¨¡å‹æ”¶æ•›è¾ƒæ…¢**ï¼Œå¢å¤§å­¦ä¹ ç‡ï¼ˆlearning rate multiplierï¼‰ã€‚

***

## **6. è§†è§‰å¾®è°ƒï¼ˆVision Fine-tuningï¼‰**

ä½ å¯ä»¥**åœ¨ JSONL è®­ç»ƒæ•°æ®ä¸­åŒ…å«å›¾ç‰‡**ï¼Œä»¥å¾®è°ƒè§†è§‰æ¨¡å‹ã€‚

ğŸ“Œ **ç¤ºä¾‹ï¼šè®­ç»ƒæ¨¡å‹è¯†åˆ«å¥¶é…ªç§ç±»**

```json
{
  "messages": [
    { "role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè¯†åˆ«å¥¶é…ªç§ç±»çš„åŠ©æ‰‹ã€‚" },
    { "role": "user", "content": "è¿™æ˜¯ä»€ä¹ˆå¥¶é…ªï¼Ÿ" },
    { "role": "user", "content": [
        {
          "type": "image_url",
          "image_url": {
            "url": "https://upload.wikimedia.org/wikipedia/commons/3/36/Danbo_Cheese.jpg"
          }
        }
      ]
    },
    { "role": "assistant", "content": "ä¸¹éº¦ Danbo å¥¶é…ª" }
  ]
}
```

ğŸ“Œ **è§†è§‰æ•°æ®è¦æ±‚**

* **æœ€å¤š 50,000 ä¸ªåŒ…å«å›¾ç‰‡çš„ç¤ºä¾‹**ã€‚

* **æ¯ä¸ªç¤ºä¾‹æœ€å¤š 10 å¼ å›¾ç‰‡**ã€‚

* **å›¾ç‰‡æœ€å¤§ 10MB**ã€‚

* **æ”¯æŒæ ¼å¼ï¼šJPEG, PNG, WEBP**ã€‚

ğŸ“Œ **é™åˆ¶**

* **ç¦æ­¢ç”¨äºé¢éƒ¨è¯†åˆ«ã€å„¿ç«¥ç…§ç‰‡ã€CAPTCHA è§£æç­‰**ã€‚

### **å¾®è°ƒçš„é«˜çº§åŠŸèƒ½ï¼šæ£€æŸ¥ç‚¹ã€DPO è®­ç»ƒã€Weighs & Biases é›†æˆ**

***

## **1. ä½¿ç”¨å¾®è°ƒæ£€æŸ¥ç‚¹ï¼ˆCheckpointed Modelsï¼‰**

åœ¨å¾®è°ƒä»»åŠ¡çš„æ¯ä¸ª **è®­ç»ƒè½®æ¬¡ï¼ˆepochï¼‰ç»“æŸ** åï¼ŒOpenAI **è‡ªåŠ¨åˆ›å»ºå®Œæ•´çš„æ¨¡å‹æ£€æŸ¥ç‚¹**ï¼ˆcheckpointï¼‰ã€‚è¿™äº›æ£€æŸ¥ç‚¹æ˜¯å®Œæ•´çš„æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥ç”¨äºæ¨ç†ã€‚

ğŸ“Œ **æ£€æŸ¥ç‚¹çš„ä½œç”¨**

* **é˜²æ­¢è¿‡æ‹Ÿåˆï¼ˆOverfittingï¼‰**ï¼šä½¿ç”¨æ—©æœŸçš„æ£€æŸ¥ç‚¹ç‰ˆæœ¬å¯èƒ½èƒ½è·å¾—æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ã€‚

* **è®­ç»ƒè¿‡ç¨‹ä¸­çš„å›æº¯ç‚¹**ï¼šå¦‚æœæœ€ç»ˆæ¨¡å‹æ•ˆæœä¸ä½³ï¼Œå¯ä»¥ä»æŸä¸ªæ£€æŸ¥ç‚¹ç»§ç»­è®­ç»ƒï¼Œè€Œä¸å¿…ä»é›¶å¼€å§‹ã€‚

ğŸ“Œ **å¦‚ä½•è®¿é—®æ£€æŸ¥ç‚¹**

```python
from openai import OpenAI
client = OpenAI()

# è·å–å¾®è°ƒä»»åŠ¡çš„æ‰€æœ‰æ£€æŸ¥ç‚¹
checkpoints = client.fine_tuning.jobs.checkpoints.list("ftjob-abc123")

# è¾“å‡ºæ£€æŸ¥ç‚¹ä¿¡æ¯
for checkpoint in checkpoints:
    print(checkpoint["fine_tuned_model_checkpoint"])
```

ğŸ“Œ **ç¤ºä¾‹ API å“åº”**

```json
{
    "object": "fine_tuning.job.checkpoint",
    "id": "ftckpt_zc4Q7MP6XxulcVzj4MZdwsAB",
    "created_at": 1519129973,
    "fine_tuned_model_checkpoint": "ft:gpt-3.5-turbo-0125:my-org:custom-suffix:96olL566:ckpt-step-2000",
    "metrics": {
        "full_valid_loss": 0.134,
        "full_valid_mean_token_accuracy": 0.874
    },
    "fine_tuning_job_id": "ftjob-abc123",
    "step_number": 2000
}
```

ğŸ“Œ **è§£æ**

* `step_number`: è®­ç»ƒåˆ° **ç¬¬ 2000 æ­¥** æ—¶åˆ›å»ºçš„æ£€æŸ¥ç‚¹ã€‚

* `metrics`: è¯¥æ£€æŸ¥ç‚¹çš„**éªŒè¯æŸå¤±ï¼ˆvalid lossï¼‰å’Œ token å‡†ç¡®ç‡ï¼ˆtoken accuracyï¼‰**ã€‚

ğŸ“Œ **å½“å‰é™åˆ¶**

* ä»…ä¿ç•™æœ€è¿‘ **3 ä¸ªè®­ç»ƒè½®æ¬¡ï¼ˆepochsï¼‰çš„æ£€æŸ¥ç‚¹**ã€‚

* **æœªæ¥å°†æä¾›æ›´çµæ´»çš„æ£€æŸ¥ç‚¹ç­–ç•¥**ã€‚

***

## **2. ç›´æ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰å¾®è°ƒ**

**DPOï¼ˆDirect Preference Optimizationï¼‰** å…è®¸ä½ **åŸºäºäººç±»åå¥½**æ¥å¾®è°ƒæ¨¡å‹ï¼Œä½¿å…¶ç”Ÿæˆæ›´ç¬¦åˆç”¨æˆ·æœŸæœ›çš„è¾“å‡ºã€‚

ğŸ“Œ **DPO é€‚ç”¨åœºæ™¯**

* ä½ å¸Œæœ›**ä¼˜åŒ–æ¨¡å‹å¯¹ä¸åŒå›ç­”çš„åå¥½**ï¼ˆå¦‚å®¢æˆ·æœåŠ¡ã€å¯¹è¯é£æ ¼ï¼‰ã€‚

* ä½ æœ‰ä¸€ç»„æ•°æ®ï¼Œå…¶ä¸­åŒ…å«**å¤šä¸ªå¯èƒ½çš„å›ç­”**ï¼Œå¹¶å¸Œæœ›å¾®è°ƒæ¨¡å‹å­¦ä¹ **æœ€ä½³å›ç­”**ã€‚

***

### **ğŸŒŸ å‡†å¤‡ DPO æ•°æ®é›†**

DPO è®­ç»ƒé›†éœ€è¦åŒ…å«ï¼š

1. **ç”¨æˆ·è¾“å…¥ï¼ˆpromptï¼‰**

2. **ä¼˜é€‰å›ç­”ï¼ˆpreferred outputï¼‰**

3. **æ¬¡é€‰å›ç­”ï¼ˆnon-preferred outputï¼‰**

ğŸ“Œ **æ•°æ®æ ¼å¼ï¼ˆJSONL æ–‡ä»¶ï¼‰**

```json
{
  "input": {
    "messages": [
      {
        "role": "user",
        "content": "Hello, can you tell me how cold San Francisco is today?"
      }
    ],
    "tools": [],
    "parallel_tool_calls": true
  },
  "preferred_output": [
    {
      "role": "assistant",
      "content": "Today in San Francisco, it is not quite cold as expected. Morning clouds will give way to sunshine, with a high near 68Â°F (20Â°C) and a low around 57Â°F (14Â°C)."
    }
  ],
  "non_preferred_output": [
    {
      "role": "assistant",
      "content": "It is not particularly cold in San Francisco today."
    }
  ]
}
```

ğŸ“Œ **é‡è¦è¯´æ˜**

* **ä»…æ”¯æŒå•è½®å¯¹è¯**ï¼ˆone-turn conversationsï¼‰ã€‚

* **ä¼˜é€‰ç­”æ¡ˆå’Œæ¬¡é€‰ç­”æ¡ˆå¿…é¡»æ˜¯æœ€åä¸€æ¡ `assistant` æ¶ˆæ¯**ã€‚

***

### **ğŸŒŸ é…ç½® DPO è®­ç»ƒä»»åŠ¡**

```python
from openai import OpenAI
client = OpenAI()

job = client.fine_tuning.jobs.create(
    training_file="file-all-about-the-weather",
    model="gpt-4o-2024-08-06",
    method={
        "type": "dpo",
        "dpo": {
            "hyperparameters": {"beta": 0.1},
        },
    },
)
```

ğŸ“Œ **å‚æ•°è¯´æ˜**

```plaintext
beta
```

* æ§åˆ¶ DPO å¯¹æ–°åå¥½çš„é€‚åº”åº¦ï¼š

  * **ä½å€¼ï¼ˆ<0.5ï¼‰** â†’ æ›´å€¾å‘äºå­¦ä¹ æ–°åå¥½ã€‚

  * **é«˜å€¼ï¼ˆ>1.5ï¼‰** â†’ æ›´ä¿å®ˆï¼Œå€¾å‘äºä¿æŒåŸæœ‰è¡Œä¸ºã€‚

  * **é»˜è®¤ `auto`** â†’ ç”± OpenAI è‡ªåŠ¨è°ƒæ•´ã€‚

***

## **3. Weights & Biasesï¼ˆW\&Bï¼‰é›†æˆ**

ä½ å¯ä»¥ä½¿ç”¨ **Weights & Biasesï¼ˆW\&Bï¼‰** è¿½è¸ªå¾®è°ƒè¿‡ç¨‹ä¸­çš„**è¶…å‚æ•°ã€æŸå¤±å˜åŒ–å’Œæ€§èƒ½æŒ‡æ ‡**ã€‚

ğŸ“Œ **W\&B é›†æˆçš„ä½œç”¨**

* **è‡ªåŠ¨è®°å½•è¶…å‚æ•°ã€è®­ç»ƒæŸå¤±ã€éªŒè¯æŸå¤±ç­‰ä¿¡æ¯**ã€‚

* **æä¾›å¯è§†åŒ–ç•Œé¢**ï¼Œå¸®åŠ©ä½ åˆ†æå¾®è°ƒæ•ˆæœã€‚

* **æ”¯æŒå¤šä¸ªå¾®è°ƒä»»åŠ¡çš„å¯¹æ¯”åˆ†æ**ã€‚

***

### **ğŸŒŸ é…ç½® W\&B é›†æˆ**

åœ¨åˆ›å»ºå¾®è°ƒä»»åŠ¡æ—¶ï¼Œæ·»åŠ  `wandb` é›†æˆï¼š

```bash
curl -X POST \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer $OPENAI_API_KEY" \
    -d '{
    "model": "gpt-4o-mini-2024-07-18",
    "training_file": "file-ABC123",
    "validation_file": "file-DEF456",
    "integrations": [
        {
            "type": "wandb",
            "wandb": {
                "project": "custom-wandb-project",
                "tags": ["project:tag", "lineage"]
            }
        }
    ]
}' https://api.openai.com/v1/fine_tuning/jobs
```

ğŸ“Œ **å‚æ•°è¯´æ˜**

* `"project"`: åœ¨ W\&B ä¸Šåˆ›å»ºçš„é¡¹ç›®åç§°ã€‚

* `"tags"`: æ·»åŠ è‡ªå®šä¹‰æ ‡ç­¾ï¼Œæ–¹ä¾¿æœç´¢ä»»åŠ¡ã€‚

***

### **ğŸŒŸ è®¿é—® W\&B è®°å½•**

åˆ›å»ºå¾®è°ƒä»»åŠ¡åï¼Œä½ å¯ä»¥åœ¨ **Weights & Biases** çš„ä»ªè¡¨ç›˜ä¸­æŸ¥çœ‹å¾®è°ƒè®°å½•ï¼š

```plaintext
https://wandb.ai/<WANDB-ENTITY>/<WANDB-PROJECT>/runs/ftjob-ABCDEF
```

ğŸ“Œ **W\&B æä¾›çš„å¯è§†åŒ–æ•°æ®**

* **è®­ç»ƒæŸå¤± & éªŒè¯æŸå¤±**

* **è®­ç»ƒ token å‡†ç¡®ç‡**

* **å¾®è°ƒè¶…å‚æ•°ï¼ˆepochs, learning\_rate, batch\_sizeï¼‰**

***

## **4. å¾®è°ƒ vs å¬å›å¢å¼ºï¼ˆRAGï¼‰**

**ä½•æ—¶ä½¿ç”¨å¾®è°ƒï¼Ÿä½•æ—¶ä½¿ç”¨åµŒå…¥ + å¬å›å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰ï¼Ÿ**

ğŸ“Œ **å¯¹æ¯”**

| **ç‰¹æ€§**   | **å¾®è°ƒï¼ˆFine-tuningï¼‰** | **RAGï¼ˆåµŒå…¥+å¬å›å¢å¼ºç”Ÿæˆï¼‰** |
| -------- | ------------------- | ------------------ |
| **é€‚ç”¨åœºæ™¯** | éœ€è¦**å›ºå®šé£æ ¼ã€ä¸¥æ ¼æ ¼å¼**çš„è¾“å‡º  | éœ€è¦**åŠ¨æ€è®¿é—®å¤–éƒ¨çŸ¥è¯†åº“**    |
| **æ¨¡å‹æ›´æ–°** | **è®­ç»ƒåå›ºå®š**           | **æ— éœ€è®­ç»ƒï¼Œéšæ—¶æ›´æ–°çŸ¥è¯†åº“**   |
| **æ•°æ®ä¾èµ–** | **éœ€è¦å¤§é‡é«˜è´¨é‡è®­ç»ƒæ•°æ®**     | **åªéœ€è¦é«˜è´¨é‡çš„çŸ¥è¯†åº“**     |
| **è®¡ç®—å¼€é”€** | è®­ç»ƒæˆæœ¬é«˜               | ä¾èµ–å‘é‡æ•°æ®åº“ï¼Œæ¨ç†æˆæœ¬ä½      |

ğŸ“Œ **æ¨è**

* **å¦‚æœä»»åŠ¡éœ€è¦çµæ´»è·å–æœ€æ–°çŸ¥è¯† â†’ ä½¿ç”¨ RAG**

* **å¦‚æœä»»åŠ¡è¦æ±‚ä¸¥æ ¼æ ¼å¼å’Œå›ºå®šé£æ ¼ â†’ ä½¿ç”¨å¾®è°ƒ**

# **æ„å»ºé«˜æ•ˆã€å¯é çš„æ™ºèƒ½ä»£ç†ï¼ˆAgentsï¼‰**

* åœ°å€ï¼šhttps://platform.openai.com/docs/guides/agents

![](images/3bfc72ab-5349-49a4-be67-bdac12430643.png)

***

## **1. ä»£ç†ï¼ˆAgentsï¼‰æ¦‚è¿°**

**Agents**ï¼ˆæ™ºèƒ½ä»£ç†ï¼‰æ˜¯ä¸€ç§**èƒ½å¤Ÿæ™ºèƒ½å®Œæˆä»»åŠ¡çš„ç³»ç»Ÿ**ï¼Œå¯ä»¥æ‰§è¡Œ**ç®€å•å·¥ä½œæµ**æˆ–è¿½æ±‚**å¤æ‚ã€å¼€æ”¾å¼ç›®æ ‡**ã€‚

ğŸ“Œ **OpenAI æä¾›çš„ Agents SDK**ï¼š

* **è½»é‡çº§ä¸”å¼ºå¤§çš„ç¼–æ’æ¡†æ¶**ï¼Œç”¨äº**æ„å»ºã€éƒ¨ç½²å’Œä¼˜åŒ–æ™ºèƒ½ä»£ç†**ã€‚

* **æ”¯æŒå†…ç½®å¯è§‚æµ‹æ€§ï¼ˆObservabilityï¼‰**ï¼Œå¯ä»¥**è·Ÿè¸ªå’Œä¼˜åŒ–ä»£ç†æ€§èƒ½**ã€‚

***

## **2. ä»£ç†æ„å»ºçš„æ ¸å¿ƒç»„ä»¶**

æ„å»ºæ™ºèƒ½ä»£ç†æ¶‰åŠå¤šä¸ªé¢†åŸŸï¼ŒOpenAI æä¾›äº†**å¯ç»„åˆçš„åŸºç¡€æ„ä»¶ï¼ˆprimitivesï¼‰**ï¼Œå¸®åŠ©ä½ å¿«é€Ÿæ„å»ºå®Œæ•´çš„ä»£ç†ç³»ç»Ÿã€‚

| **é¢†åŸŸ**                          | **æè¿°**                    | **OpenAI æä¾›çš„åŠŸèƒ½**                                        |
| ------------------------------- | ------------------------- | ------------------------------------------------------- |
| **æ¨¡å‹ï¼ˆModelsï¼‰**                  | æ ¸å¿ƒæ™ºèƒ½ä½“ï¼Œè´Ÿè´£æ¨ç†ã€å†³ç­–ã€å¤„ç†å¤šæ¨¡æ€æ•°æ®     | o1, o3-mini, GPT-4.5, GPT-4o, GPT-4o-mini               |
| **å·¥å…·ï¼ˆToolsï¼‰**                   | ä»£ç†ä¸ç¯å¢ƒäº¤äº’çš„æ¥å£ï¼Œä¾‹å¦‚å‡½æ•°è°ƒç”¨ã€Web æœç´¢ç­‰ | Function calling, Web search, File search, Computer use |
| **çŸ¥è¯† & è®°å¿†ï¼ˆKnowledge & Memoryï¼‰** | ä½¿ä»£ç†å¯ä»¥è®¿é—®å¤–éƒ¨çŸ¥è¯†å¹¶æŒä¹…å­˜å‚¨ä¿¡æ¯        | Vector stores, File search, Embeddings                  |
| **å®‰å…¨é˜²æŠ¤ï¼ˆGuardrailsï¼‰**            | é˜²æ­¢ä¸ç›¸å…³ã€æœ‰å®³æˆ–ä¸è‰¯è¡Œä¸º             | Moderation API, Instruction hierarchy                   |
| **ç¼–æ’ï¼ˆOrchestrationï¼‰**           | ä»£ç†çš„å¼€å‘ã€éƒ¨ç½²ã€ç›‘æ§å’Œæ”¹è¿›            | Agents SDK, Tracing, Evaluations, Fine-tuning           |

***

## **3. æ¨¡å‹ï¼ˆModelsï¼‰**

OpenAI çš„**å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰** æ˜¯è®¸å¤šæ™ºèƒ½ä»£ç†ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£**å†³ç­–**ã€**æ¨ç†** å’Œ **ç¯å¢ƒäº¤äº’**ã€‚

| **æ¨¡å‹**           | **ä»£ç†ç‰¹æ€§**         |
| ---------------- | ---------------- |
| **o1 & o3-mini** | é€‚åˆé•¿æœŸè§„åˆ’ã€å¤æ‚ä»»åŠ¡å’Œé«˜çº§æ¨ç† |
| **GPT-4.5**      | æœ€é€‚åˆæ‰§è¡Œä»£ç†ä»»åŠ¡        |
| **GPT-4o**       | å¹³è¡¡ä»£ç†èƒ½åŠ›ä¸æ¨ç†é€Ÿåº¦      |
| **GPT-4o-mini**  | ä½å»¶è¿Ÿä»£ç†çš„æœ€ä½³é€‰æ‹©       |

ğŸ“Œ **æ ¸å¿ƒèƒ½åŠ›**

* **é«˜çº§æ™ºèƒ½**ï¼šæ“…é•¿æ¨ç†å’Œè§„åˆ’ï¼Œé€‚åˆ**å¤æ‚ä»»åŠ¡**ã€‚

* **å·¥å…·è°ƒç”¨**ï¼šæ”¯æŒ**å‡½æ•°è°ƒç”¨**ï¼Œå¯ä¸ OpenAI å†…ç½®å·¥å…·é›†æˆã€‚

* **å¤šæ¨¡æ€ç†è§£**ï¼šèƒ½å¤Ÿç†è§£**æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€ä»£ç ã€æ–‡æ¡£**ã€‚

* **ä½å»¶è¿Ÿ**ï¼šæ”¯æŒ**å®æ—¶éŸ³é¢‘å¯¹è¯**å’Œæ›´å¿«çš„å°å‹æ¨¡å‹ã€‚

ğŸ”— **æ›´å¤šæ¨¡å‹è¯¦æƒ…**ï¼Œè¯·è®¿é—® **OpenAI æ¨¡å‹é¡µé¢**ã€‚

***

## **4. å·¥å…·ï¼ˆToolsï¼‰**

**å·¥å…·ï¼ˆToolsï¼‰** è®©ä»£ç†èƒ½å¤Ÿä¸ä¸–ç•Œäº¤äº’ï¼Œä¾‹å¦‚è°ƒç”¨å‡½æ•°ã€æœç´¢ä¿¡æ¯ã€æ§åˆ¶è®¡ç®—æœºç­‰ã€‚

| **å·¥å…·**                     | **åŠŸèƒ½æè¿°**             |
| -------------------------- | -------------------- |
| **å‡½æ•°è°ƒç”¨ï¼ˆFunction callingï¼‰** | å…è®¸ä»£ç†è°ƒç”¨å¼€å‘è€…å®šä¹‰çš„ API æˆ–ä»£ç  |
| **Web æœç´¢ï¼ˆWeb searchï¼‰**     | è·å–æœ€æ–°çš„ Web ä¿¡æ¯         |
| **æ–‡ä»¶æœç´¢ï¼ˆFile searchï¼‰**      | åœ¨æ–‡æ¡£ä¸­æ‰§è¡Œè¯­ä¹‰æœç´¢           |
| **è®¡ç®—æœºæ§åˆ¶ï¼ˆComputer useï¼‰**    | ä»£ç†ç†è§£å¹¶æ§åˆ¶è®¡ç®—æœºæˆ–æµè§ˆå™¨       |

ğŸ“Œ **ç¤ºä¾‹ï¼šä»£ç†ä½¿ç”¨ Web æœç´¢**

```python
from openai import OpenAI
client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    tools=[{"type": "web_search_preview"}],
    input="æœ€æ–°çš„ AI ç ”ç©¶è¿›å±•æ˜¯ä»€ä¹ˆï¼Ÿ"
)
print(response.output_text)
```

ğŸ“Œ **æ•ˆæœ**

* ä»£ç†è°ƒç”¨ Web æœç´¢ï¼Œè·å–æœ€æ–°çš„ AI ç ”ç©¶ä¿¡æ¯ã€‚

***

## **5. çŸ¥è¯† & è®°å¿†ï¼ˆKnowledge & Memoryï¼‰**

ä»£ç†å¯ä»¥ä½¿ç”¨**å¤–éƒ¨çŸ¥è¯†**å¢å¼ºç†è§£èƒ½åŠ›ï¼Œå¹¶å®ç°**é•¿æœŸè®°å¿†**ã€‚

ğŸ“Œ **æ”¯æŒçš„å¢å¼ºæ–¹å¼**

| **åŠŸèƒ½**                   | **ä½œç”¨**             |
| ------------------------ | ------------------ |
| **å‘é‡å­˜å‚¨ï¼ˆVector storesï¼‰**  | è¯­ä¹‰æœç´¢æ–‡æ¡£ï¼Œå®æ—¶æ£€ç´¢ä¿¡æ¯      |
| **æ–‡ä»¶æœç´¢ï¼ˆFile searchï¼‰**    | åœ¨æœ¬åœ°æˆ–äº‘ç«¯å­˜å‚¨çš„æ–‡æ¡£ä¸­æŸ¥æ‰¾ç›¸å…³å†…å®¹ |
| **åµŒå…¥æ¨¡å‹ï¼ˆEmbeddings APIï¼‰** | ä»¥å‘é‡å½¢å¼å­˜å‚¨æ•°æ®ï¼Œå®ç°é«˜æ•ˆæ£€ç´¢   |

ğŸ“Œ **ç¤ºä¾‹ï¼šä»£ç†ä½¿ç”¨å‘é‡å­˜å‚¨**

```python
from openai import OpenAI
client = OpenAI()

response = client.responses.create(
    model="gpt-4o",
    tools=[{"type": "file_search", "vector_store_ids": ["my_vector_store"]}],
    input="è¯·æä¾›å…³äºå¼ºåŒ–å­¦ä¹ çš„æ–‡æ¡£"
)
print(response.output_text)
```

ğŸ“Œ **æ•ˆæœ**

* ä»£ç†åœ¨å‘é‡å­˜å‚¨ä¸­æœç´¢ç›¸å…³æ–‡æ¡£ï¼Œå¹¶è¿”å›ä¿¡æ¯ã€‚

***

## **6. å®‰å…¨é˜²æŠ¤ï¼ˆGuardrailsï¼‰**

ä¸ºäº†ç¡®ä¿ä»£ç†çš„**å®‰å…¨æ€§å’Œå¯é æ€§**ï¼ŒOpenAI æä¾›äº†**å®‰å…¨é˜²æŠ¤æœºåˆ¶**ã€‚

| **åŠŸèƒ½**                          | **ä½œç”¨**               |
| ------------------------------- | -------------------- |
| **å†…å®¹å®¡æ ¸ APIï¼ˆModeration APIï¼‰**    | è¿‡æ»¤ä¸å®‰å…¨å†…å®¹              |
| **æŒ‡ä»¤å±‚æ¬¡ï¼ˆInstruction hierarchyï¼‰** | å¼€å‘è€…å®šä¹‰çš„æŒ‡ä»¤ä¼˜å…ˆäºç”¨æˆ·æŒ‡ä»¤ï¼Œé˜²æ­¢æ»¥ç”¨ |
| **é™åˆ¶æ¨¡å‹è¡Œä¸º**                      | é¿å…ä»£ç†æ‰§è¡Œæœªæˆæƒä»»åŠ¡          |

ğŸ“Œ **ç¤ºä¾‹ï¼šä½¿ç”¨ Moderation API**

```python
from openai import OpenAI
client = OpenAI()

response = client.moderations.create(input="ä¸€ä¸ªåŒ…å«ä»‡æ¨è¨€è®ºçš„ç¤ºä¾‹æ–‡æœ¬")
print(response["results"])
```

ğŸ“Œ **æ•ˆæœ**

* API è¯†åˆ«å‡º**æ½œåœ¨ä¸å®‰å…¨å†…å®¹**ï¼Œé˜²æ­¢ä»£ç†ç”Ÿæˆæˆ–ä¼ æ’­æœ‰å®³ä¿¡æ¯ã€‚

***

## **7. ç¼–æ’ï¼ˆOrchestrationï¼‰**

ä»£ç†çš„æ„å»ºè¿‡ç¨‹åŒ…æ‹¬ **å¼€å‘ã€éƒ¨ç½²ã€ç›‘æ§ã€è¯„ä¼°å’Œä¼˜åŒ–**ã€‚

| **é˜¶æ®µ**      | **æè¿°**                     | **OpenAI æä¾›çš„å·¥å…·** |
| ----------- | -------------------------- | ---------------- |
| **æ„å»º & éƒ¨ç½²** | ä½¿ç”¨ Agents SDK è®¾è®¡ã€æ„å»ºã€æ‰§è¡Œä»£ç†ä»»åŠ¡ | **Agents SDK**   |
| **ç›‘æ§**      | è§‚å¯Ÿä»£ç†è¡Œä¸ºã€è°ƒè¯•é”™è¯¯                | **Tracing**      |
| **è¯„ä¼° & ä¼˜åŒ–** | æµ‹è¯•ä»£ç†æ€§èƒ½ï¼Œæå‡ä»»åŠ¡æ‰§è¡Œæ•ˆæœ            | **Evaluations**  |
| **å¾®è°ƒ**      | è®©ä»£ç†é€‚åº”ç‰¹å®šä»»åŠ¡ï¼Œæé«˜å‡†ç¡®æ€§            | **Fine-tuning**  |

ğŸ“Œ **ç¤ºä¾‹ï¼šä½¿ç”¨ Agents SDK éƒ¨ç½²ä»£ç†**

```python
from agents import Agent, Runner

agent = Agent(name="AI åŠ©æ‰‹", instructions="ä½ æ˜¯ä¸€ä¸ªå¸®åŠ©ç”¨æˆ·å®Œæˆä»»åŠ¡çš„æ™ºèƒ½ä»£ç†")

result = Runner.run_sync(agent, "è¯·å¸®æˆ‘å®‰æ’ä»Šå¤©çš„ä¼šè®®")
print(result.final_output)
```

ğŸ“Œ **æ•ˆæœ**

* ä»£ç†æ‰§è¡Œ**ä»»åŠ¡è§„åˆ’**ï¼Œå¹¶è¾“å‡ºé€‚å½“çš„å®‰æ’ã€‚
