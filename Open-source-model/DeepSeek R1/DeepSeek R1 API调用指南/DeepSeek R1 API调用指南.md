# è¯¾ç¨‹è¯´æ˜ï¼š

* ä½“éªŒè¯¾å†…å®¹èŠ‚é€‰è‡ª[ã€Š2025å¤§æ¨¡å‹Agentæ™ºèƒ½ä½“å¼€å‘å®æˆ˜ã€‹](https://whakv.xetslk.com/s/3xFEAA)å®Œæ•´ç‰ˆä»˜è´¹è¯¾ç¨‹

â€ƒâ€ƒä½“éªŒè¯¾æ—¶é—´æœ‰é™ï¼Œè‹¥æƒ³æ·±åº¦å­¦ä¹ å¤§æ¨¡å‹æŠ€æœ¯ï¼Œæ¬¢è¿å¤§å®¶æŠ¥åç”±æˆ‘ä¸»è®²çš„[ã€Š2025å¤§æ¨¡å‹Agentæ™ºèƒ½ä½“å¼€å‘å®æˆ˜ã€‹](https://whakv.xetslk.com/s/3xFEAA)ï¼š

![](images/5c1e6a65-613b-4da2-9e2c-ec2c867bb0a9.png)

![](images/f339b04b7b20233dd1509c7fb36d5c0.png)

æ­¤å¤–ï¼ŒR1è’¸é¦ç‰ˆDeepSeek v3æˆ‘ä»¬å·²ç»å®Œæ•´å¤ç°äº†æ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ï¼Œå…¬å¼€è¯¾çš„å…¨éƒ¨è®­ç»ƒé¡¹ç›®ä»£ç ã€æ•°æ®ã€ä»¥åŠè®­ç»ƒå®Œçš„æ¨¡å‹ï¼Œå·²ä¸Šä¼ è‡³è¯¾ä»¶ç½‘ç›˜ï¼Œè”ç³»â¬†ï¸åŠ©æ•™å³å¯é¢†å–ï½

***

## ã€Š2025å¤§æ¨¡å‹Agentæ™ºèƒ½ä½“å¼€å‘å®æˆ˜ã€‹ä½“éªŒè¯¾

## DeepSeek R1 APIè°ƒç”¨æŒ‡å—

```python
import os
from IPython.display import display, Code, Markdown
import requests
import json
```

* DeepSeek R1è´¦å·æ³¨å†Œä¸APIè·å–

â€ƒâ€ƒDeepSeek-R1æ­£å¼ç‰ˆå·²äº2025å¹´1æœˆ20å·æ­£å¼ä¸Šçº¿ï¼Œåœ¨åè®­ç»ƒé˜¶æ®µå¤§è§„æ¨¡ä½¿ç”¨äº†å¼ºåŒ–å­¦ä¹ æŠ€æœ¯ï¼Œåœ¨ä»…æœ‰æå°‘æ ‡æ³¨æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæå¤§æå‡äº†æ¨¡å‹æ¨ç†èƒ½åŠ›ã€‚åœ¨æ•°å­¦ã€ä»£ç ã€è‡ªç„¶è¯­è¨€æ¨ç†ç­‰ä»»åŠ¡ä¸Šï¼Œæ€§èƒ½æ¯”è‚© OpenAI o1 æ­£å¼ç‰ˆã€‚

![](images/7a1bec79-979e-4b23-8095-f0caa46a60b0.png)

DeepSeek R1æ¨¡å‹æ€§èƒ½è§£è¯»è§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1UBwbe4E1D/

![](images/09644e77-50fa-4f3c-9239-1588ef03bcb6.png)

DeepSeekå®˜ç½‘ï¼šhttps://www.deepseek.com/

![](images/9bdfa948-33d5-4ee8-b223-d22fc6b1b641.png)

&#x20;

![](images/65edd826-e216-42a2-9f56-932ba3462956.png)

æ–°ç”¨æˆ·æ³¨å†Œå³èµ é€10å…ƒé¢åº¦ï¼Œçº¦500ä¸‡tokené¢åº¦ã€‚

â€ƒâ€ƒä»·æ ¼æ–¹é¢ï¼ŒDeepSeek R1ä»·æ ¼çº¦ä¸ºOpenAI o1æ­£å¼ç‰ˆæ¨¡å‹çš„1/50ï¼š

![](images/ea7597f1-4778-46b4-a0e9-07acbaf6c66a.png)

ä»¥ä¸‹æ˜¯OpenAI o1æ¨¡å‹APIè°ƒç”¨ä»·æ ¼ï¼š

![](images/9de1ec99-2dcf-4931-b12f-bc884a6d8077.png)

ç›®å‰DeepSeek R1æ¨¡å‹è°ƒç”¨ä¸é™é€Ÿï¼š

![](images/f4ac995b-b46c-4245-8035-b41ab41e1e82.png)

å¹¶ä¸”è°ƒç”¨é£æ ¼å’ŒOpenAIå®Œå…¨ä¸€è‡´ï¼šæç¤ºè¯ç¼“å­˜ã€Json Outputç­‰åŠŸèƒ½å®Œå…¨ç›¸åŒï¼Œæš‚ä¸æ”¯æŒå¤šæ¨¡æ€å’ŒFunction callingåŠŸèƒ½ï¼š

![](images/f6d45f97-dc90-4782-802a-327cd9e1e0cc.png)

&#x20;

![](images/fbfef35b-900c-41eb-8e41-93702dc57e01.png)

* DeepSeek R1è°ƒç”¨æµç¨‹

å¯¹æ¯”OpenAI GPT4oè°ƒç”¨æµç¨‹ï¼š

```python
!pip install openai
```

```plaintext
Requirement already satisfied: openai in /root/anaconda3/lib/python3.12/site-packages (1.57.2)
Requirement already satisfied: anyio<5,>=3.5.0 in /root/anaconda3/lib/python3.12/site-packages (from openai) (4.2.0)
Requirement already satisfied: distro<2,>=1.7.0 in /root/anaconda3/lib/python3.12/site-packages (from openai) (1.9.0)
Requirement already satisfied: httpx<1,>=0.23.0 in /root/anaconda3/lib/python3.12/site-packages (from openai) (0.28.1)
Requirement already satisfied: jiter<1,>=0.4.0 in /root/anaconda3/lib/python3.12/site-packages (from openai) (0.8.2)
Requirement already satisfied: pydantic<3,>=1.9.0 in /root/anaconda3/lib/python3.12/site-packages (from openai) (2.5.3)
Requirement already satisfied: sniffio in /root/anaconda3/lib/python3.12/site-packages (from openai) (1.3.0)
Requirement already satisfied: tqdm>4 in /root/anaconda3/lib/python3.12/site-packages (from openai) (4.66.4)
Requirement already satisfied: typing-extensions<5,>=4.11 in /root/anaconda3/lib/python3.12/site-packages (from openai) (4.11.0)
Requirement already satisfied: idna>=2.8 in /root/anaconda3/lib/python3.12/site-packages (from anyio<5,>=3.5.0->openai) (3.7)
Requirement already satisfied: certifi in /root/anaconda3/lib/python3.12/site-packages (from httpx<1,>=0.23.0->openai) (2024.6.2)
Requirement already satisfied: httpcore==1.* in /root/anaconda3/lib/python3.12/site-packages (from httpx<1,>=0.23.0->openai) (1.0.7)
Requirement already satisfied: h11<0.15,>=0.13 in /root/anaconda3/lib/python3.12/site-packages (from httpcore==1.*->httpx<1,>=0.23.0->openai) (0.14.0)
Requirement already satisfied: annotated-types>=0.4.0 in /root/anaconda3/lib/python3.12/site-packages (from pydantic<3,>=1.9.0->openai) (0.6.0)
Requirement already satisfied: pydantic-core==2.14.6 in /root/anaconda3/lib/python3.12/site-packages (from pydantic<3,>=1.9.0->openai) (2.14.6)
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0m
```

```python
import openai
```

```python
openai.__version__
```

```plaintext
'1.57.2'
```

```python
from openai import OpenAI
```

```python
openai_api_key = 'YOUR_API_KEY'
```

```python
# å®ä¾‹åŒ–å®¢æˆ·ç«¯
client = OpenAI(api_key=openai_api_key, 
                base_url="https://ai.devtool.tech/proxy/v1")
```

```python
response = client.chat.completions.create(
    model="o1-preview",
    messages=[
        {"role": "user", "content": "è¯·é—®ï¼Œ9.8å’Œ9.11å“ªä¸ªæ›´å¤§ï¼Ÿ"}
    ]
)
```

```python
response
```

```plaintext
ChatCompletion(id='chatcmpl-As3CtGiIhcFVMpNEW9H170lzm1xVa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='9.8 æ¯” 9.11 å¤§ã€‚\n\nåœ¨æ¯”è¾ƒè¿™ä¸¤ä¸ªæ•°å­—æ—¶ï¼Œ9.8 ç­‰äº 9.80ï¼Œè€Œ 9.11 ç­‰äº 9.11ã€‚å› ä¸º 9.80 å¤§äº 9.11ï¼Œæ‰€ä»¥ 9.8 æ¯” 9.11 å¤§ã€‚', refusal=None, role='assistant', audio=None, function_call=None, tool_calls=None))], created=1737445403, model='o1-preview-2024-09-12', object='chat.completion', service_tier='default', system_fingerprint='fp_6722463bcd', usage=CompletionUsage(completion_tokens=592, prompt_tokens=21, total_tokens=613, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=512, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))
```

```python
print(response.choices[0].message.content)
```

```plaintext
9.8 æ¯” 9.11 å¤§ã€‚

åœ¨æ¯”è¾ƒè¿™ä¸¤ä¸ªæ•°å­—æ—¶ï¼Œ9.8 ç­‰äº 9.80ï¼Œè€Œ 9.11 ç­‰äº 9.11ã€‚å› ä¸º 9.80 å¤§äº 9.11ï¼Œæ‰€ä»¥ 9.8 æ¯” 9.11 å¤§ã€‚
```

ä¸Šè¿°ä»£ç ä¸­ model å‚æ•°æŒ‡å®šäº†ä½¿ç”¨çš„æ¨¡å‹ï¼ˆo1-previewï¼‰ï¼Œmessages åˆ—è¡¨å®šä¹‰äº†å¯¹è¯å†…å®¹ï¼Œå…¶ä¸­ role ä¸º user è¡¨ç¤ºç”¨æˆ·çš„è¾“å…¥å†…å®¹ã€‚

DeepSeek R1è°ƒç”¨æµç¨‹:

é¦–å…ˆåœ¨å®˜ç½‘ç”³è¯·API-KEYï¼šhttps://platform.deepseek.com/api\_keys

![](images/599b6276-abf1-4f60-a12e-5e38c39a0aa3.png)

&#x20;

![](images/da4754e8-dd6b-413e-bb0a-0e7c44427ac8.png)

```python
ds_api_key = "YOUR_DS_API_KEY"
```

```python
# å®ä¾‹åŒ–å®¢æˆ·ç«¯
client = OpenAI(api_key=ds_api_key, 
                base_url="https://api.deepseek.com")
```

```python
# è°ƒç”¨ deepseekv3 æ¨¡å‹
response = client.chat.completions.create(
    model="deepseek-reasoner",
    messages=[
        {"role": "user", "content": "è¯·é—®ï¼Œ9.8å’Œ9.11å“ªä¸ªæ›´å¤§ï¼Ÿ"}
    ]
)
```

```python
# æœ€ç»ˆå›å¤
response.choices[0].message.content
```

```plaintext
'åœ¨æ¯”è¾ƒæ•°å€¼å¤§å°æ—¶ï¼Œ9.8 å’Œ 9.11 éœ€è¦ç»Ÿä¸€å°æ•°ä½æ•°æ¥é€ä½å¯¹æ¯”ï¼š\n\n- **9.8** å¯ä»¥å†™ä½œ **9.80**  \n- **9.11** ä¿æŒåŸæ ¼å¼ **9.11**\n\n**æ¯”è¾ƒæ­¥éª¤ï¼š**  \n1. **æ•´æ•°éƒ¨åˆ†**ï¼šå‡ä¸º 9ï¼Œç›¸ç­‰ã€‚  \n2. **ååˆ†ä½**ï¼ˆå°æ•°ç‚¹åç¬¬ä¸€ä½ï¼‰ï¼š9.80 çš„ **8** > 9.11 çš„ **1**ã€‚  \n\næ­¤æ—¶å·²èƒ½åˆ¤å®šå¤§å°ï¼Œæ— éœ€ç»§ç»­æ¯”è¾ƒåç»­ä½æ•°ã€‚  \n\n**ç»“è®º**ï¼š  \n**9.8 > 9.11**  \n\næ³¨æ„ï¼šå¦‚æœæ˜¯ç‰ˆæœ¬å·ï¼ˆå¦‚è½¯ä»¶ç‰ˆæœ¬ï¼‰ï¼Œå¯èƒ½éµå¾ªä¸åŒè§„åˆ™ï¼ˆå¦‚ `9.11` è¡¨ç¤ºç¬¬9ç‰ˆç¬¬11æ¬¡æ›´æ–°ï¼Œå¤§äº `9.8`ï¼‰ï¼Œä½†çº¯æ•°å­¦æ¯”è¾ƒæ—¶ï¼Œ**9.8 æ›´å¤§**ã€‚'
```

```python
# æ€è€ƒé“¾
response.choices[0].message.reasoning_content
```

```plaintext
'å—¯ï¼Œç”¨æˆ·é—®çš„æ˜¯9.8å’Œ9.11å“ªä¸ªæ›´å¤§ã€‚è¿™çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªå°æ•°æ¯”è¾ƒçš„é—®é¢˜ï¼Œä½†å¯èƒ½æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦æ³¨æ„ã€‚é¦–å…ˆï¼Œæˆ‘åº”è¯¥æ˜ç¡®è¿™ä¸¤ä¸ªæ•°çš„ä½æ•°ã€‚9.8å’Œ9.11ï¼Œè¡¨é¢ä¸Šçœ‹èµ·æ¥ï¼Œå¯èƒ½æœ‰äººä¼šç›´æ¥æ¯”è¾ƒå°æ•°ç‚¹åçš„æ•°å­—ï¼Œæ¯”å¦‚8å’Œ11ï¼Œç„¶åè§‰å¾—11æ›´å¤§ï¼Œæ‰€ä»¥9.11æ›´å¤§ã€‚ä¸è¿‡å…¶å®è¿™å¯èƒ½æ˜¯ä¸ªè¯¯åŒºï¼Œå› ä¸ºå°æ•°çš„æ¯”è¾ƒéœ€è¦é€ä½æ¥çœ‹ã€‚\n\né¦–å…ˆï¼Œæˆ‘è¦ç¡®è®¤è¿™ä¸¤ä¸ªæ•°çš„æ•´æ•°éƒ¨åˆ†æ˜¯å¦ç›¸åŒã€‚æ˜¯çš„ï¼Œéƒ½æ˜¯9ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æ¯”è¾ƒå°æ•°éƒ¨åˆ†ã€‚å¯¹äº9.8ï¼Œå¯ä»¥å†™æˆ9.80ï¼Œè¿™æ ·å°æ•°éƒ¨åˆ†æœ‰ä¸¤ä½ï¼Œå’Œ9.11å¯¹é½ã€‚è¿™æ ·çš„è¯ï¼Œå°æ•°éƒ¨åˆ†åˆ†åˆ«æ˜¯80å’Œ11ã€‚è¿™æ—¶å€™æ¯”è¾ƒçš„è¯ï¼Œ80æ˜¾ç„¶æ¯”11å¤§ï¼Œæ‰€ä»¥9.80ï¼ˆå³9.8ï¼‰å¤§äº9.11ã€‚å¯èƒ½ç”¨æˆ·ä¼šæ··æ·†å°æ•°ç‚¹çš„ä½æ•°ï¼Œæ¯”å¦‚è¯¯ä»¥ä¸º9.11çš„å°æ•°ç‚¹åä¸¤ä½æ¯”9.8çš„ä¸€ä½å¤§ï¼Œä½†å…¶å®éœ€è¦è¡¥é½ä½æ•°å†æ¯”è¾ƒã€‚\n\næˆ–è€…ï¼Œç”¨æˆ·å¯èƒ½æ˜¯åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨è¿™äº›æ•°å­—ï¼Œæ¯”å¦‚ç‰ˆæœ¬å·ï¼Œè¿™æ—¶å€™9.11å¯èƒ½ä»£è¡¨çš„æ˜¯ç¬¬ä¹ç‰ˆçš„ç¬¬11æ¬¡æ›´æ–°ï¼Œè€Œ9.8åˆ™æ˜¯ç¬¬ä¹ç‰ˆçš„ç¬¬8æ¬¡ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ9.11ç¡®å®æ›´å¤§ã€‚ä½†é€šå¸¸æ•°å­¦æ¯”è¾ƒä¸­ï¼Œè¿˜æ˜¯æŒ‰ç…§æ•°å€¼å¤§å°æ¥åˆ¤æ–­ã€‚å› æ­¤éœ€è¦ç¡®è®¤ç”¨æˆ·çš„æ„å›¾ï¼Œä½†æ ¹æ®é—®é¢˜æœ¬èº«ï¼Œå¯èƒ½æ›´åå‘æ•°å€¼æ¯”è¾ƒã€‚\n\næ‰€ä»¥ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯å°†ä¸¤ä¸ªæ•°çš„å°æ•°ä½æ•°ç»Ÿä¸€ï¼Œæ¯”è¾ƒæ¯ä¸€ä½çš„æ•°å­—ï¼Œå¾—å‡º9.8æ›´å¤§çš„ç»“è®ºã€‚ä¸è¿‡è¦ç¡®ä¿ç”¨æˆ·æ²¡æœ‰ç‰¹æ®Šçš„ä¸Šä¸‹æ–‡ï¼Œæ¯”å¦‚è½¯ä»¶ç‰ˆæœ¬æˆ–å…¶ä»–éæ•°å€¼æ¯”è¾ƒçš„æƒ…å†µã€‚å¦‚æœæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œæ•°å­¦ä¸Š9.8ç¡®å®å¤§äº9.11ã€‚'
```

* DeepSeek R1å‚æ•°è§£é‡Š

(1). max\_tokensï¼šæœ€ç»ˆå›ç­”çš„æœ€å¤§é•¿åº¦ï¼ˆä¸å«æ€ç»´é“¾è¾“å‡ºï¼‰ï¼Œé»˜è®¤ä¸º 4Kï¼Œæœ€å¤§ä¸º 8Kã€‚è¯·æ³¨æ„ï¼Œæ€ç»´é“¾çš„è¾“å‡ºæœ€å¤šå¯ä»¥è¾¾åˆ° 32K tokensï¼Œæ§æ€ç»´é“¾çš„é•¿åº¦çš„å‚æ•°ï¼ˆreasoning\_effortï¼‰å°†ä¼šåœ¨è¿‘æœŸä¸Šçº¿ã€‚

(2). reasoning\_contentï¼šæ€ç»´é“¾å†…å®¹ï¼Œä¸ content åŒçº§

(3). ä¸Šä¸‹æ–‡é•¿åº¦ï¼šAPI æœ€å¤§æ”¯æŒ 64K ä¸Šä¸‹æ–‡ï¼Œè¾“å‡ºçš„ reasoning\_content é•¿åº¦ä¸è®¡å…¥ 64K ä¸Šä¸‹æ–‡é•¿åº¦ä¸­

(4). æ”¯æŒçš„åŠŸèƒ½ï¼šå¯¹è¯è¡¥å…¨ï¼Œå¯¹è¯å‰ç¼€ç»­å†™ (Beta)

(5). ä¸æ”¯æŒçš„åŠŸèƒ½ï¼šFunction Callã€Json Outputã€FIM è¡¥å…¨ (Beta)

(6). ä¸æ”¯æŒçš„å‚æ•°ï¼štemperatureã€top\_pã€presence\_penaltyã€frequency\_penaltyã€logprobsã€top\_logprobsã€‚è¯·æ³¨æ„ï¼Œä¸ºäº†å…¼å®¹å·²æœ‰è½¯ä»¶ï¼Œè®¾ç½®è¿™äº›å‚æ•°ä¸ä¼šæŠ¥é”™ï¼Œä½†ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚

* DeepSeek R1æ€ç»´é“¾æ‰§è¡Œè¿‡ç¨‹

![](images/cf8b5cef-cf0c-4c8f-aa62-72e7d27c6b04.png)

* å°è¯•å€ŸåŠ©DeepSeek R1ç¼–å†™å®Œæ•´å¼€å‘é¡¹ç›®

```python
prompt = """
æˆ‘æƒ³æ„å»ºä¸€ä¸ªPythonåº”ç”¨ç¨‹åºï¼Œå®ƒèƒ½å¤Ÿæ¥æ”¶ç”¨æˆ·çš„é—®é¢˜ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ä¸ä¹‹å¯¹åº”çš„ç­”æ¡ˆã€‚
å¦‚æœæœ‰æ¥è¿‘åŒ¹é…çš„ç­”æ¡ˆï¼Œå®ƒå°±æ£€ç´¢å‡ºåŒ¹é…çš„ç­”æ¡ˆã€‚
å¦‚æœæ²¡æœ‰ï¼Œå®ƒå°±è¯·æ±‚ç”¨æˆ·æä¾›ç­”æ¡ˆï¼Œå¹¶å°†é—®é¢˜/ç­”æ¡ˆå¯¹å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚
ä¸ºæˆ‘è§„åˆ’æ‰€éœ€çš„ç›®å½•ç»“æ„ï¼Œç„¶åå®Œæ•´åœ°è¿”å›æ¯ä¸ªæ–‡ä»¶ã€‚åªéœ€åœ¨ä»£ç çš„å¼€å§‹å’Œç»“æŸæ—¶æä¾›ä½ çš„æ¨ç†ï¼Œè€Œä¸ç”¨è´¯ç©¿æ•´ä¸ªä»£ç ã€‚
"""

response = client.chat.completions.create(
    model="deepseek-reasoner",
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": prompt
                },
            ],
        }
    ]
)
```

```python
display(Markdown(response.choices[0].message.content))
```

ä»¥ä¸‹æ˜¯ä¸ºæ‚¨è§„åˆ’çš„Pythonåº”ç”¨ç¨‹åºç»“æ„å’Œå®Œæ•´ä»£ç æ–‡ä»¶ï¼š

```plaintext
qa_app/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ config.py
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ db_connector.py
â”œâ”€â”€ daos/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ qa_dao.py
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ qa_service.py
â””â”€â”€ main.py
```

**config/config.py**

```python
DB_PATH = 'qa_database.db'
```

**database/db\_connector.py**

```python
import sqlite3
from config.config import DB_PATH

def get_db_connection():
    conn = sqlite3.connect(DB_PATH)
    conn.row_factory = sqlite3.Row
    return conn

def init_db():
    with get_db_connection() as conn:
        conn.execute('''
            CREATE TABLE IF NOT EXISTS qa_pairs (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                question TEXT NOT NULL UNIQUE,
                answer TEXT NOT NULL,
                match_count INTEGER DEFAULT 0,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        conn.commit()
```

**daos/qa\_dao.py**

```python
from database.db_connector import get_db_connection

class QaDao:
    @staticmethod
    def find_question(question):
        with get_db_connection() as conn:
            cursor = conn.execute('''
                SELECT * FROM qa_pairs 
                WHERE question LIKE ? 
                ORDER BY match_count DESC 
                LIMIT 1
            ''', ('%' + question + '%',))
            return cursor.fetchone()

    @staticmethod
    def insert_qa_pair(question, answer):
        with get_db_connection() as conn:
            cursor = conn.execute('''
                INSERT INTO qa_pairs (question, answer) 
                VALUES (?, ?)
            ''', (question, answer))
            conn.commit()
            return cursor.lastrowid

    @staticmethod
    def increment_match_count(qa_id):
        with get_db_connection() as conn:
            conn.execute('''
                UPDATE qa_pairs 
                SET match_count = match_count + 1 
                WHERE id = ?
            ''', (qa_id,))
            conn.commit()
```

**services/qa\_service.py**

```python
from daos.qa_dao import QaDao

class QaService:
    @staticmethod
    def get_answer(question):
        qa_pair = QaDao.find_question(question)
        if qa_pair:
            QaDao.increment_match_count(qa_pair['id'])
            return qa_pair['answer']
        return None

    @staticmethod
    def save_new_qa(question, answer):
        return QaDao.insert_qa_pair(question, answer)
```

**main.py**

```python
from database.db_connector import init_db
from services.qa_service import QaService

def main():
    init_db()
    print("QA System - Type 'exit' to quit")
    while True:
        question = input("\nYour question: ").strip()
        if question.lower() == 'exit':
            break
        if not question:
            continue
        answer = QaService.get_answer(question)
        if answer:
            print(f"Answer: {answer}")
        else:
            new_answer = input("No answer found. Please provide the answer: ").strip()
            if new_answer:
                QaService.save_new_qa(question, new_answer)
                print("New QA pair added!")
            else:
                print("Answer cannot be empty. QA pair not saved.")

if __name__ == "__main__":
    main()
```

æ¨ç†è¿‡ç¨‹ï¼š

1. ä½¿ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼ˆæ•°æ®è®¿é—®å±‚ã€æœåŠ¡å±‚ã€è¡¨ç¤ºå±‚ï¼‰å®ç°å…³æ³¨ç‚¹åˆ†ç¦»

2. é‡‡ç”¨SQLiteä½œä¸ºåµŒå…¥å¼æ•°æ®åº“ä¾¿äºå¿«é€ŸåŸå‹å¼€å‘

3. é€šè¿‡LIKEæ“ä½œç¬¦å®ç°ç®€å•çš„æ¨¡ç³ŠåŒ¹é…é€»è¾‘

4. ä½¿ç”¨match\_countå­—æ®µè·Ÿè¸ªå¸¸ç”¨ç­”æ¡ˆçš„ä¼˜å…ˆçº§

5. åŒ…å«æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬å’Œå”¯ä¸€æ€§çº¦æŸä¿è¯æ•°æ®å®Œæ•´æ€§

ä»£ç ç»“æŸåçš„æ”¹è¿›å»ºè®®ï¼š

1. å¯æ·»åŠ æ›´æ™ºèƒ½çš„æ¨¡ç³ŠåŒ¹é…ç®—æ³•ï¼ˆå¦‚Levenshteinè·ç¦»ï¼‰

2. å¯æ‰©å±•ä¸ºWebåº”ç”¨ç‰ˆæœ¬ï¼ˆå¦‚ä½¿ç”¨Flask/Djangoæ¡†æ¶ï¼‰

3. å¯å¢åŠ ç­”æ¡ˆåé¦ˆæœºåˆ¶ä¼˜åŒ–åŒ¹é…è´¨é‡

4. å¯æ·»åŠ ç®¡ç†å‘˜ç•Œé¢ç®¡ç†QAå¯¹

5. å¯å¢åŠ è‡ªç„¶è¯­è¨€å¤„ç†ç»„ä»¶æå‡é—®ç­”å‡†ç¡®æ€§

* å°è¯•ç¼–å†™è´ªåƒè›‡å°æ¸¸æˆ

```python
prompt = """
å®ç°ä¸€ä¸ªä½¿ç”¨ HTML + JS + CSS çš„è´ªåƒè›‡æ¸¸æˆã€‚
æ•´ä¸ªä»£ç åº”è¯¥å†™åœ¨ä¸€ä¸ªå•ä¸€çš„ HTML å—ä¸­ï¼ŒåµŒå…¥ JS å’Œ CSSã€‚ä¸è¦ä½¿ç”¨ä»»ä½•è¿œç¨‹èµ„æºã€‚
æ‰“å¼€ HTML åï¼Œç”¨æˆ·éœ€è¦æŒ‰ç©ºæ ¼é”®å¼€å§‹/é‡æ–°å¼€å§‹æ¸¸æˆï¼Œè›‡åœ¨å¼€å§‹æ—¶ä¼šéšæœºæœä¸€ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œå¹¶ä½¿ç”¨ "wasd" é”®æ¥æ§åˆ¶è›‡çš„æ–¹å‘ã€‚
è®©æ¸¸æˆç•Œé¢ç¾è§‚ï¼Œå¹¶ä½¿æ¸¸æˆåŒºåŸŸè¾ƒå¤§ã€‚
"""
```

```python
response1 = client.chat.completions.create(
    model="deepseek-reasoner",
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": prompt
                },
            ],
        }
    ]
)
```

```python
display(Markdown(response1.choices[0].message.content))
```

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„è´ªåƒè›‡æ¸¸æˆå®ç°ï¼ŒåŒ…å«ç¾è§‚çš„ç•Œé¢å’Œå®Œæ•´çš„æ¸¸æˆé€»è¾‘ï¼š

```html
<!DOCTYPE html>
<html>
<head>
    <title>ç»å…¸è´ªåƒè›‡</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            margin: 0;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }

        #gameContainer {
            position: relative;
            margin-top: 20px;
        }

        #gameCanvas {
            border: 3px solid #4CAF50;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.3);
            background: #000;
        }

        #score {
            position: absolute;
            top: -40px;
            left: 0;
            color: #4CAF50;
            font-size: 24px;
            font-weight: bold;
        }

        #instructions {
            color: #fff;
            margin: 20px;
            text-align: center;
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff4444;
            font-size: 48px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="score">å¾—åˆ†: 0</div>
        <canvas id="gameCanvas"></canvas>
    </div>
    <div id="instructions">æŒ‰ç©ºæ ¼é”®å¼€å§‹/é‡æ–°å¼€å§‹ | ä½¿ç”¨ WASD æ§åˆ¶æ–¹å‘</div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        
        // æ¸¸æˆè®¾ç½®
        const gridSize = 20;
        const gameSpeed = 100;
        canvas.width = 800;
        canvas.height = 600;

        let snake = [];
        let food = {};
        let direction = '';
        let nextDirection = '';
        let score = 0;
        let gameLoop = null;
        let isGameOver = true;

        function initGame() {
            // åˆå§‹åŒ–è›‡çš„ä½ç½®
            snake = [{x: 10, y: 10}];
            score = 0;
            scoreElement.textContent = `å¾—åˆ†: ${score}`;
            
            // éšæœºåˆå§‹æ–¹å‘
            const directions = ['up', 'down', 'left', 'right'];
            direction = directions[Math.floor(Math.random() * directions.length)];
            nextDirection = direction;
            
            generateFood();
            isGameOver = false;
        }

        function generateFood() {
            while(true) {
                food = {
                    x: Math.floor(Math.random() * (canvas.width / gridSize)),
                    y: Math.floor(Math.random() * (canvas.height / gridSize))
                };
                // ç¡®ä¿é£Ÿç‰©ä¸åœ¨è›‡èº«ä¸Š
                if (!snake.some(segment => segment.x === food.x && segment.y === food.y)) {
                    break;
                }
            }
        }

        function draw() {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶é£Ÿç‰©
            ctx.fillStyle = '#ff4444';
            ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);

            // ç»˜åˆ¶è›‡
            snake.forEach((segment, index) => {
                ctx.fillStyle = index === 0 ? '#4CAF50' : '#2E7D32';
                ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
            });

            // æ¸¸æˆç»“æŸæ˜¾ç¤º
            if (isGameOver) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#ff4444';
                ctx.font = '48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('æ¸¸æˆç»“æŸï¼', canvas.width/2, canvas.height/2);
            }
        }

        function update() {
            if (isGameOver) return;

            direction = nextDirection;
            const head = {...snake[0]};

            switch(direction) {
                case 'up': head.y--; break;
                case 'down': head.y++; break;
                case 'left': head.x--; break;
                case 'right': head.x++; break;
            }

            // ç¢°æ’æ£€æµ‹
            if (head.x < 0 || head.x >= canvas.width/gridSize ||
                head.y < 0 || head.y >= canvas.height/gridSize ||
                snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                isGameOver = true;
                return;
            }

            snake.unshift(head);

            // åƒé£Ÿç‰©æ£€æµ‹
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                scoreElement.textContent = `å¾—åˆ†: ${score}`;
                generateFood();
            } else {
                snake.pop();
            }
        }

        function gameStep() {
            update();
            draw();
        }

        document.addEventListener('keydown', (e) => {
            switch(e.key.toLowerCase()) {
                case 'w': if (direction !== 'down') nextDirection = 'up'; break;
                case 's': if (direction !== 'up') nextDirection = 'down'; break;
                case 'a': if (direction !== 'right') nextDirection = 'left'; break;
                case 'd': if (direction !== 'left') nextDirection = 'right'; break;
                case ' ':
                    if (isGameOver) {
                        initGame();
                        if (!gameLoop) {
                            gameLoop = setInterval(gameStep, gameSpeed);
                        }
                    }
                    break;
            }
        });

        // åˆå§‹ç»˜åˆ¶
        draw();
    </script>
</body>
</html>
```

è¿™ä¸ªå®ç°åŒ…å«ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **ç¾è§‚ç•Œé¢**ï¼š

   * æ¸å˜èƒŒæ™¯å’Œå‘å…‰è¾¹æ¡†

   * ä¸åŒé¢œè‰²çš„è›‡å¤´å’Œè›‡èº«

   * çº¢è‰²é£Ÿç‰©ç²’å­æ•ˆæœ

   * æ¸…æ™°çš„å¾—åˆ†æ˜¾ç¤º

   * åŠé€æ˜çš„æ¸¸æˆç»“æŸè¦†ç›–å±‚

2. **æ¸¸æˆåŠŸèƒ½**ï¼š

   * æŒ‰ç©ºæ ¼é”®å¼€å§‹/é‡æ–°å¼€å§‹æ¸¸æˆ

   * WASDæ§åˆ¶æ–¹å‘

   * éšæœºåˆå§‹æ–¹å‘

   * ç¢°æ’æ£€æµ‹ï¼ˆå¢™å£å’Œè‡ªèº«ï¼‰

   * å¾—åˆ†ç³»ç»Ÿ

   * é£Ÿç‰©ç”Ÿæˆé¿å…é‡å 

3. **ä¼˜åŒ–ç‰¹æ€§**ï¼š

   * æµç•…çš„åŠ¨ç”»æ•ˆæœï¼ˆ100ms/å¸§ï¼‰

   * é˜²æ­¢180åº¦ç«‹å³è½¬å‘

   * å“åº”å¼æ§åˆ¶

   * æ¸…æ™°çš„æ¸¸æˆçŠ¶æ€æç¤º

4. **æŠ€æœ¯å‚æ•°**ï¼š

   * æ¸¸æˆåŒºåŸŸï¼š800x600åƒç´ 

   * ç½‘æ ¼å°ºå¯¸ï¼š20x20åƒç´ 

   * åˆå§‹é€Ÿåº¦ï¼š100ms/æ ¼

   * æ¯æ¬¡å¾—åˆ†å¢åŠ 10åˆ†

è¦å¼€å§‹æ¸¸æˆï¼Œåªéœ€ï¼š

1. æ‰“å¼€HTMLæ–‡ä»¶

2. æŒ‰ç©ºæ ¼é”®å¼€å§‹

3. ä½¿ç”¨WASDé”®æ§åˆ¶æ–¹å‘

4. åƒåˆ°çº¢è‰²é£Ÿç‰©å¢é•¿å¹¶å¾—åˆ†

5. ç¢°æ’åæŒ‰ç©ºæ ¼é”®é‡æ–°å¼€å§‹

æ¸¸æˆä¼šåœ¨ä»¥ä¸‹æƒ…å†µç»“æŸï¼š

* è›‡å¤´ç¢°åˆ°å¢™å£

* è›‡å¤´ç¢°åˆ°è‡ªå·±èº«ä½“

* ä»»ä½•ç¢°æ’å‘ç”Ÿæ—¶ä¼šæœ‰æ˜æ˜¾çš„çº¢è‰²æç¤º

![](images/43522b1b-7e4e-4e6a-a987-131d8d01dc0d.png)

* å°è¯•è¿›è¡Œå¤æ‚æœºå™¨å­¦ä¹ å»ºæ¨¡

```python
prompt = """
æˆ‘éœ€è¦å®Œæˆä¸€ä¸ªæœºå™¨å­¦ä¹ å»ºæ¨¡ä»»åŠ¡ï¼Œéœ€è¦ä½¿ç”¨Pythonæ¥è¯»å–æœ¬åœ°çš„telco.csvæ–‡ä»¶ï¼Œ
å¹¶å®Œæ•´è¿›è¡Œæ•°æ®æ¢ç´¢ã€æ•°æ®æ¸…æ´—ã€ç‰¹å¾è¡ç”Ÿã€ç‰¹å¾ç­›é€‰ã€é›†æˆå­¦ä¹ ç®—æ³•å»ºæ¨¡ã€æ¨¡å‹èåˆç­‰æ“ä½œï¼Œ
è¯·ä½ å¸®æˆ‘å®Œæˆè¿™ä¸ªå»ºæ¨¡ä»»åŠ¡ã€‚
"""
```

```python
response2 = client.chat.completions.create(
    model="o1-mini",
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": prompt
                },
            ],
        }
    ]
)
```

```python
display(Markdown(response2.choices[0].message.content))
```

å½“ç„¶ï¼Œæˆ‘å¾ˆé«˜å…´å¸®åŠ©ä½ å®Œæˆè¿™ä¸ªæœºå™¨å­¦ä¹ å»ºæ¨¡ä»»åŠ¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Python å·¥ä½œæµç¨‹ï¼Œæ¶µç›–äº†è¯»å–æ•°æ®ã€æ•°æ®æ¢ç´¢ã€æ•°æ®æ¸…æ´—ã€ç‰¹å¾è¡ç”Ÿã€ç‰¹å¾ç­›é€‰ã€é›†æˆå­¦ä¹ ç®—æ³•å»ºæ¨¡ä»¥åŠæ¨¡å‹èåˆç­‰æ­¥éª¤ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å¸¸ç”¨çš„ Python åº“ï¼Œå¦‚ pandasã€numpyã€matplotlibã€seabornã€scikit-learn ç­‰ã€‚

è¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº†æ‰€éœ€çš„åº“ã€‚å¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼Œä½ å¯ä»¥ä½¿ç”¨ `pip` æ¥å®‰è£…ï¼š

```bash
pip install pandas numpy matplotlib seaborn scikit-learn
```

ä»¥ä¸‹æ˜¯è¯¦ç»†çš„æ­¥éª¤å’Œå¯¹åº”çš„ä»£ç ç¤ºä¾‹ï¼š

***

## 1. å¯¼å…¥å¿…è¦çš„åº“

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# æœºå™¨å­¦ä¹ ç›¸å…³
from sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score
from sklearn.preprocessing import LabelEncoder, OneHotEncoder, StandardScaler
from sklearn.impute import SimpleImputer
from sklearn.feature_selection import SelectKBest, chi2, RFE
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier, VotingClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import classification_report, confusion_matrix, accuracy_score, roc_auc_score, roc_curve
```

***

## 2. è¯»å–æ•°æ®

å‡è®¾ä½ çš„ `telco.csv` æ–‡ä»¶ä½äºå½“å‰å·¥ä½œç›®å½•ä¸‹ï¼š

```python
# è¯»å–CSVæ–‡ä»¶
df = pd.read_csv('telco.csv')

# æŸ¥çœ‹å‰å‡ è¡Œæ•°æ®
print(df.head())
```

***

## 3. æ•°æ®æ¢ç´¢ï¼ˆExploratory Data Analysis, EDAï¼‰

### 3.1 æ•°æ®åŸºæœ¬ä¿¡æ¯

```python
# æŸ¥çœ‹æ•°æ®é›†çš„å½¢çŠ¶
print(f"æ•°æ®é›†æœ‰ {df.shape[0]} è¡Œå’Œ {df.shape[1]} åˆ—ã€‚")

# æŸ¥çœ‹æ•°æ®ç±»å‹å’Œç¼ºå¤±å€¼
print(df.info())

# æŸ¥çœ‹æè¿°æ€§ç»Ÿè®¡
print(df.describe())
```

### 3.2 å¯è§†åŒ–åˆ†æ

#### 3.2.1 ç›®æ ‡å˜é‡åˆ†å¸ƒ

å‡è®¾ç›®æ ‡å˜é‡ä¸º `Churn`ï¼ˆå®¢æˆ·æµå¤±ï¼‰ï¼š

```python
# ç›®æ ‡å˜é‡åˆ†æ
sns.countplot(x='Churn', data=df)
plt.title('ç›®æ ‡å˜é‡åˆ†å¸ƒ')
plt.show()
```

#### 3.2.2 æ•°å€¼å˜é‡åˆ†æ

```python
# é€‰æ‹©æ•°å€¼å‹ç‰¹å¾
numerical_features = df.select_dtypes(include=['int64', 'float64']).columns.tolist()
numerical_features.remove('Churn')  # æ’é™¤ç›®æ ‡å˜é‡

# ç»˜åˆ¶æ•°å€¼å˜é‡çš„åˆ†å¸ƒ
df[numerical_features].hist(bins=30, figsize=(15, 10))
plt.tight_layout()
plt.show()
```

#### 3.2.3 ç±»åˆ«å˜é‡åˆ†æ

```python
# é€‰æ‹©ç±»åˆ«å‹ç‰¹å¾
categorical_features = df.select_dtypes(include=['object']).columns.tolist()
categorical_features.remove('Churn')  # æ’é™¤ç›®æ ‡å˜é‡

# ç»˜åˆ¶ç±»åˆ«å˜é‡çš„è®¡æ•°å›¾
plt.figure(figsize=(20, 15))
for i, col in enumerate(categorical_features, 1):
    plt.subplot(4, 4, i)
    sns.countplot(x=col, hue='Churn', data=df)
    plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
```

***

## 4. æ•°æ®æ¸…æ´—

### 4.1 å¤„ç†ç¼ºå¤±å€¼

é¦–å…ˆï¼Œæ£€æŸ¥ç¼ºå¤±å€¼ï¼š

```python
# ç¼ºå¤±å€¼æƒ…å†µ
print(df.isnull().sum())
```

å‡è®¾éƒ¨åˆ†åˆ—å­˜åœ¨ç¼ºå¤±å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

```python
# å¯¹äºæ•°å€¼å‹ç¼ºå¤±å€¼ï¼Œç”¨ä¸­ä½æ•°å¡«è¡¥
numerical_imputer = SimpleImputer(strategy='median')
df[numerical_features] = numerical_imputer.fit_transform(df[numerical_features])

# å¯¹äºç±»åˆ«å‹ç¼ºå¤±å€¼ï¼Œç”¨ä¼—æ•°å¡«è¡¥
categorical_imputer = SimpleImputer(strategy='most_frequent')
df[categorical_features] = categorical_imputer.fit_transform(df[categorical_features])
```

### 4.2 å¤„ç†é‡å¤å€¼

```python
# æŸ¥çœ‹é‡å¤å€¼
print(f"é‡å¤å€¼æ•°é‡: {df.duplicated().sum()}")

# åˆ é™¤é‡å¤å€¼
df = df.drop_duplicates()
```

### 4.3 å¤„ç†å¼‚å¸¸å€¼

å¯ä»¥ä½¿ç”¨ç®±çº¿å›¾æˆ–Z-scoreç­‰æ–¹æ³•æ£€æµ‹å¼‚å¸¸å€¼ï¼Œè¿™é‡Œä»¥ç®±çº¿å›¾ä¸ºä¾‹ï¼š

```python
# ç»˜åˆ¶ç®±çº¿å›¾æŸ¥çœ‹å¼‚å¸¸å€¼
for col in numerical_features:
    plt.figure(figsize=(6, 4))
    sns.boxplot(x=df[col])
    plt.title(f'{col} çš„ç®±çº¿å›¾')
    plt.show()
```

æ ¹æ®ä¸šåŠ¡ç†è§£ï¼Œå†³å®šæ˜¯å¦ç§»é™¤æˆ–å¤„ç†è¿™äº›å¼‚å¸¸å€¼ã€‚

***

## 5. ç‰¹å¾å·¥ç¨‹

### 5.1 ç¼–ç ç±»åˆ«å˜é‡

#### 5.1.1 æ ‡ç­¾ç¼–ç 

å¯¹äºäºŒåˆ†ç±»çš„ç±»åˆ«å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨æ ‡ç­¾ç¼–ç ï¼š

```python
binary_cols = [col for col in categorical_features if df[col].nunique() == 2]
le = LabelEncoder()
for col in binary_cols:
    df[col] = le.fit_transform(df[col])
```

#### 5.1.2 ç‹¬çƒ­ç¼–ç 

å¯¹äºå¤šåˆ†ç±»çš„ç±»åˆ«å˜é‡ï¼Œä½¿ç”¨ç‹¬çƒ­ç¼–ç ï¼š

```python
multiclass_cols = [col for col in categorical_features if df[col].nunique() > 2]
df = pd.get_dummies(df, columns=multiclass_cols, drop_first=True)
```

### 5.2 ç‰¹å¾ç¼©æ”¾

å¯¹äºæ•°å€¼å‹ç‰¹å¾ï¼Œè¿›è¡Œæ ‡å‡†åŒ–ï¼š

```python
scaler = StandardScaler()
df[numerical_features] = scaler.fit_transform(df[numerical_features])
```

### 5.3 ç‰¹å¾è¡ç”Ÿ

æ ¹æ®ä¸šåŠ¡ç†è§£ï¼Œå¯ä»¥åˆ›å»ºæ–°çš„ç‰¹å¾ã€‚è¿™é‡Œä»¥ç¤ºä¾‹åˆ›å»ºä¸€ä¸ª `TotalCharges` ç‰¹å¾ï¼š

å‡è®¾åŸæ•°æ®ä¸­æœ‰ `MonthlyCharges` å’Œ `tenure`ï¼Œå¯ä»¥åˆ›å»º `TotalCharges`ï¼š

```python
if 'MonthlyCharges' in df.columns and 'tenure' in df.columns:
    df['TotalCharges'] = df['MonthlyCharges'] * df['tenure']
```

***

## 6. ç‰¹å¾é€‰æ‹©

### 6.1 ç›¸å…³æ€§åˆ†æ

```python
# è®¡ç®—ç›¸å…³çŸ©é˜µ
corr = df.corr()

# æŸ¥çœ‹ä¸ç›®æ ‡å˜é‡çš„ç›¸å…³æ€§
plt.figure(figsize=(12, 8))
sns.heatmap(corr[['Churn']].sort_values(by='Churn', ascending=False), annot=True)
plt.title('ç‰¹å¾ä¸ç›®æ ‡å˜é‡çš„ç›¸å…³æ€§')
plt.show()
```

### 6.2 é€‰æ‹©Kä¸ªæœ€å¥½ç‰¹å¾

ä½¿ç”¨ `SelectKBest` é€‰æ‹©æœ€é‡è¦çš„ç‰¹å¾ï¼š

```python
X = df.drop('Churn', axis=1)
y = df['Churn']

selector = SelectKBest(score_func=chi2, k=20)
X_new = selector.fit_transform(X, y)

# è·å–è¢«é€‰ä¸­çš„ç‰¹å¾
cols = selector.get_support(indices=True)
selected_features = X.columns[cols]
print(f"è¢«é€‰ä¸­çš„ç‰¹å¾: {selected_features.tolist()}")
```

***

## 7. åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†

```python
X = df[selected_features]
y = df['Churn']

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)
```

***

## 8. é›†æˆå­¦ä¹ ç®—æ³•å»ºæ¨¡

### 8.1 éšæœºæ£®æ—åˆ†ç±»å™¨

```python
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

# é¢„æµ‹
y_pred_rf = rf.predict(X_test)

# è¯„ä¼°
print("éšæœºæ£®æ—åˆ†ç±»å™¨è¯„ä¼°:")
print(confusion_matrix(y_test, y_pred_rf))
print(classification_report(y_test, y_pred_rf))
```

### 8.2 æ¢¯åº¦æå‡åˆ†ç±»å™¨

```python
gb = GradientBoostingClassifier(n_estimators=100, random_state=42)
gb.fit(X_train, y_train)

# é¢„æµ‹
y_pred_gb = gb.predict(X_test)

# è¯„ä¼°
print("æ¢¯åº¦æå‡åˆ†ç±»å™¨è¯„ä¼°:")
print(confusion_matrix(y_test, y_pred_gb))
print(classification_report(y_test, y_pred_gb))
```

### 8.3 å…¶ä»–é›†æˆæ–¹æ³•ï¼ˆå¯é€‰ï¼‰

ä½ å¯ä»¥å°è¯•ä¾‹å¦‚ XGBoostã€LightGBM ç­‰å…¶ä»–é›†æˆæ–¹æ³•ï¼Œå‰ææ˜¯ä½ å·²ç»å®‰è£…ç›¸å…³åº“ã€‚

***

## 9. æ¨¡å‹èåˆï¼ˆModel Fusionï¼‰

### 9.1 æŠ•ç¥¨åˆ†ç±»å™¨

ç»“åˆå¤šç§æ¨¡å‹çš„é¢„æµ‹ç»“æœï¼š

```python
# å®šä¹‰åŸºæ¨¡å‹
log_clf = LogisticRegression(random_state=42)
rf_clf = RandomForestClassifier(n_estimators=100, random_state=42)
gb_clf = GradientBoostingClassifier(n_estimators=100, random_state=42)

# åˆ›å»ºæŠ•ç¥¨åˆ†ç±»å™¨
voting_clf = VotingClassifier(
    estimators=[
        ('lr', log_clf),
        ('rf', rf_clf),
        ('gb', gb_clf)
    ],
    voting='soft'
)

# è®­ç»ƒæŠ•ç¥¨åˆ†ç±»å™¨
voting_clf.fit(X_train, y_train)

# é¢„æµ‹
y_pred_vc = voting_clf.predict(X_test)

# è¯„ä¼°
print("æŠ•ç¥¨åˆ†ç±»å™¨è¯„ä¼°:")
print(confusion_matrix(y_test, y_pred_vc))
print(classification_report(y_test, y_pred_vc))
```

### 9.2 å †å åˆ†ç±»å™¨ï¼ˆStackingï¼‰

ä½¿ç”¨å †å æ–¹æ³•æ¥èåˆå¤šä¸ªæ¨¡å‹ï¼š

```python
from sklearn.ensemble import StackingClassifier

# å®šä¹‰åŸºæ¨¡å‹
estimators = [
    ('rf', RandomForestClassifier(n_estimators=100, random_state=42)),
    ('gb', GradientBoostingClassifier(n_estimators=100, random_state=42))
]

# å®šä¹‰å †å åˆ†ç±»å™¨
stack_clf = StackingClassifier(
    estimators=estimators,
    final_estimator=LogisticRegression(),
    cv=5
)

# è®­ç»ƒå †å åˆ†ç±»å™¨
stack_clf.fit(X_train, y_train)

# é¢„æµ‹
y_pred_stack = stack_clf.predict(X_test)

# è¯„ä¼°
print("å †å åˆ†ç±»å™¨è¯„ä¼°:")
print(confusion_matrix(y_test, y_pred_stack))
print(classification_report(y_test, y_pred_stack))
```

***

## 10. æ¨¡å‹è¯„ä¼°ä¸é€‰æ‹©

æ¯”è¾ƒå„æ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°ã€AUC ç­‰ï¼Œé€‰æ‹©è¡¨ç°æœ€å¥½çš„æ¨¡å‹ã€‚

```python
# è®¡ç®—ä¸åŒæ¨¡å‹çš„AUC
models = {
    'Random Forest': rf,
    'Gradient Boosting': gb,
    'Voting Classifier': voting_clf,
    'Stacking Classifier': stack_clf
}

for name, model in models.items():
    y_pred_proba = model.predict_proba(X_test)[:, 1]
    auc = roc_auc_score(y_test, y_pred_proba)
    print(f"{name} çš„AUC: {auc:.4f}")
```

### ç»˜åˆ¶ROCæ›²çº¿

```python
plt.figure(figsize=(10, 8))
for name, model in models.items():
    y_pred_proba = model.predict_proba(X_test)[:, 1]
    fpr, tpr, _ = roc_curve(y_test, y_pred_proba)
    plt.plot(fpr, tpr, label=f'{name} (AUC = {roc_auc_score(y_test, y_pred_proba):.2f})')

plt.plot([0, 1], [0, 1], 'k--')  # éšæœºçŒœæµ‹çš„çº¿
plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('ROCæ›²çº¿')
plt.legend()
plt.show()
```

***

## 11. è¶…å‚æ•°è°ƒä¼˜ï¼ˆå¯é€‰ï¼‰

ä½¿ç”¨ç½‘æ ¼æœç´¢æ¥ä¼˜åŒ–æ¨¡å‹çš„è¶…å‚æ•°ï¼Œä»¥è¿›ä¸€æ­¥æå‡æ¨¡å‹æ€§èƒ½ã€‚

```python
# ä»¥éšæœºæ£®æ—ä¸ºä¾‹
param_grid = {
    'n_estimators': [100, 200, 300],
    'max_depth': [None, 10, 20, 30],
    'min_samples_split': [2, 5, 10]
}

grid_search = GridSearchCV(
    estimator=RandomForestClassifier(random_state=42),
    param_grid=param_grid,
    cv=5,
    n_jobs=-1,
    scoring='roc_auc'
)

grid_search.fit(X_train, y_train)

print(f"æœ€ä½³å‚æ•°: {grid_search.best_params_}")
print(f"æœ€ä½³AUC: {grid_search.best_score_:.4f}")

# ä½¿ç”¨æœ€ä½³å‚æ•°é‡æ–°è®­ç»ƒæ¨¡å‹
best_rf = grid_search.best_estimator_
y_pred_best_rf = best_rf.predict(X_test)

# è¯„ä¼°
print("è°ƒä¼˜åçš„éšæœºæ£®æ—åˆ†ç±»å™¨è¯„ä¼°:")
print(confusion_matrix(y_test, y_pred_best_rf))
print(classification_report(y_test, y_pred_best_rf))
```

***

## 12. ä¿å­˜æ¨¡å‹ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ å¸Œæœ›å°†è®­ç»ƒå¥½çš„æ¨¡å‹ä¿å­˜ä»¥ä¾›åç»­ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ `joblib` æˆ– `pickle`ï¼š

```python
import joblib

# ä¿å­˜éšæœºæ£®æ—æ¨¡å‹
joblib.dump(best_rf, 'best_random_forest_model.pkl')

# åŠ è½½æ¨¡å‹
loaded_rf = joblib.load('best_random_forest_model.pkl')
```

***

## æ€»ç»“

ä»¥ä¸Šæ­¥éª¤æä¾›äº†ä¸€ä¸ªå…¨é¢çš„æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ï¼Œä»æ•°æ®è¯»å–åˆ°æ¨¡å‹èåˆã€‚è¯·æ³¨æ„ï¼Œå…·ä½“æ“ä½œå¯èƒ½éœ€è¦æ ¹æ® `telco.csv` æ•°æ®é›†çš„å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä¾‹å¦‚ï¼Œç‰¹å¾å·¥ç¨‹å’Œç‰¹å¾é€‰æ‹©çš„æ­¥éª¤éœ€è¦ç»“åˆä¸šåŠ¡çŸ¥è¯†å’Œæ•°æ®ç‰¹ç‚¹è¿›è¡Œä¼˜åŒ–ã€‚

å¦‚æœåœ¨å®æ–½è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•å…·ä½“çš„é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶æé—®ï¼
